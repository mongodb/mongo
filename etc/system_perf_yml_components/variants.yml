definitions:
  cron_query_perf_schedule: &cron_query_perf_schedule "0 0 * * 4" # 00:00 on Thursday
  linux-1-node-repl-cron: &linux-1-node-repl-cron "0 0 * * 4" # 00:00 on Thursday
  cron_sunday_thursday: &cron_sunday_thursday "0 0 * * 0,4"
  linux-3-shard-cron: &linux-3-shard-cron "0 0 * * 4" # 00:00 on Thursday
  linux-3-node-cron: &linux-3-node-cron "0 0 * * 1,2,3,4,5,6" # Everyday except Sunday at 00:00
  high-value-workload-cron: &high-value-workload-cron "0 */4 * * 1-5" # High-value workloads run every weekday, every 4 hours

variables:
  - &amazon2_x86_compile_variant_dependency
    depends_on:
      - name: package_new_compile
        variant: amazon2-x86-compile

  - &amazon_linux2_arm64_compile_variant_dependency
    depends_on:
      - name: package_new_compile
        variant: amazon2-arm64-compile

  - &amazon_linux2_x86_streams_compile_variant_dependency
    depends_on:
      - name: package_new_compile
        variant: amazon2-x86-streams-compile

  - &amazon_linux2_arm64_mongocrypt_compile_variant_dependency
    depends_on:
      - name: package_new_compile
        variant: amazon2-arm64-compile
      - name: crypt_create_lib
        variant: amazon2-arm64-mongocrypt-shlib-compile

  - &schedule_variant_auto_tasks_task
    name: schedule_variant_auto_tasks
    activate: false
    depends_on:
      - name: schedule_global_auto_tasks
        variant: task_generation

  - &schedule_patch_auto_tasks_task
    name: schedule_patch_auto_tasks
    activate: false
    depends_on:
      - name: schedule_global_auto_tasks
        variant: task_generation

  - modules: &perf_modules
      - dsi
      - genny
      - workloads
      - linkbench
      - linkbench2
      - tsbs
      - mongo-perf
      - YCSB
      - PrivateWorkloads
      - py-tpcc
      - flamegraph

  - perf_project_dir: &perf_project_dir dsi

  - &classic_engine_tasks
    - *schedule_patch_auto_tasks_task
    - *schedule_variant_auto_tasks_task
    - name: ycsb.2023-09
    - name: ycsb_single_thread
    - name: ycsb_60GB.2023-09
    - name: ycsb_60GB.long.2023-09
    - name: crud_workloads_majority
    - name: bestbuy_agg
    - name: bestbuy_agg_merge_different_db
    - name: bestbuy_agg_merge_same_db
    - name: bestbuy_agg_merge_wordcount
    - name: bestbuy_query
    - name: cursor_manager
    - name: map_reduce_workloads
    - name: tpcc
    - name: tpcc_majority
    - name: tpch_1_normalized
    - name: tpch_1_denormalized
    - name: tpch_10_normalized
    - name: tpch_10_denormalized
    - name: canaries_only

  - &classic_engine_1nodereplset_tasks
    - *schedule_patch_auto_tasks_task
    - *schedule_variant_auto_tasks_task
    - name: linkbench
    - name: linkbench2
    - name: snapshot_reads
    - name: canaries_only

    # Same as standalone tasks, but with tasks required all feature flags added
  - &mirobenchmarks-all-feature-flags-tasks
    - name: big_collection
    - name: genny_scale_InsertRemove
    - name: genny_execution_UserAcquisition
    - name: aggregation_read_commands
    - name: aggregation_read_commands_large_dataset
    - name: agg-query-comparison_read_commands
    - name: agg-query-comparison_read_commands_high_value
      cron: "0 0 * * 0,2,3,4,5" # *linux-microbenchmarks-standalone-arm contains high-value cron for this task. resetting correct cron
    - name: query_read_commands
    - name: query_read_commands_large_dataset
    - name: views-aggregation
    - name: views-query
    - name: where_read_commands
    - name: update_read_commands
    - name: insert_read_commands
    - name: wildcard-index-read_read_commands
    - name: wildcard-index-write_read_commands
    - name: geo_read_commands
    - name: misc_read_commands
    - name: misc_custom_filter_default_read_commands
    - name: misc_custom_filter_slow_or_sample_read_commands
    - name: misc_custom_filter_complex_read_commands
    - name: misc_custom_filter_whole_doc_read_commands
    - name: misc_slowms_everything_read_commands
    - name: singleThreaded_read_commands
    - name: pipeline-updates
    - name: javascript
    - name: compound_wildcard_index_write_commands
    - name: compound_wildcard_index_read_commands
    - name: tie-breaking-heuristics

  - &repl-arm-expansions
    mongodb_setup_release: 2022-11
    mongodb_setup: mongo-perf-replica.2023-02
    infrastructure_provisioning_release: 2023-09
    infrastructure_provisioning: workload_client_mongod_combined.2023-01
    workload_setup: 2022-11
    use_scons_cache: true
    platform: linux
    canaries: none
    storageEngine: inMemory
    project_dir: *perf_project_dir
    compile_variant: amazon2-arm64-compile

  - &repl-intel-expansions
    <<: *repl-arm-expansions
    infrastructure_provisioning: workload_client_mongod_combined_intel.2023-11
    compile_variant: amazon2-x86-compile

  - &standalone-intel-expansions # Update mongodb_setup to mongo-perf-standalone.2023-02 when reusing this anchor
    mongodb_setup_release: 2022-11
    mongodb_setup: mongo-perf-standalone-all-feature-flags.2023-02
    infrastructure_provisioning_release: 2023-09
    infrastructure_provisioning: workload_client_mongod_combined_intel.2023-11
    workload_setup: 2022-11
    use_scons_cache: true
    platform: linux
    canaries: none
    storageEngine: inMemory
    project_dir: *perf_project_dir
    compile_variant: amazon2-x86-compile

  - &3node-query-stats-rate-limit-expansions
    mongodb_setup_release: 2022-11
    mongodb_setup: replica-query-stats-rate-limit
    infrastructure_provisioning_release: 2023-09
    infrastructure_provisioning: replica
    workload_setup: 2022-11
    platform: linux
    project_dir: *perf_project_dir
    authentication: enabled
    storageEngine: wiredTiger
    compile_variant: amazon2-arm64-compile
    config_params_json: '{"v": 0, "internalQueryStatsRateLimit": 1}'

buildvariants:
  - <<: *amazon2_x86_compile_variant_dependency
    name: perf-standalone-classic-query-engine.intel.aws.2023-11
    display_name: Classic Query Engine Standalone Intel AWS 2023-11
    cron: *cron_query_perf_schedule
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: standalone-classic-query-engine
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single-intel.2023-11
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-x86-compile
    run_on:
      - "rhel94-perf-single"
    tasks: *classic_engine_tasks

  - <<: *amazon2_x86_compile_variant_dependency
    name: perf-standalone-sbe.intel.aws.2023-11
    display_name: SBE Standalone Intel AWS 2023-11
    cron: *cron_query_perf_schedule
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: standalone-sbe
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single-intel.2023-11
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-x86-compile
    run_on:
      - "rhel94-perf-single"
    tasks: *classic_engine_tasks

  - <<: *amazon2_x86_compile_variant_dependency
    name: perf-1-node-replSet-classic-query-engine.intel.aws.2023-11
    display_name: Classic Query Engine Intel 1-Node ReplSet Intel AWS 2023-11
    cron: *linux-1-node-repl-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica-classic-query-engine
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single-intel.2023-11
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-x86-compile
    run_on:
      - "rhel94-perf-single"
    tasks: *classic_engine_1nodereplset_tasks

  - <<: *amazon2_x86_compile_variant_dependency
    name: perf-1-node-replSet-sbe.intel.aws.2023-11
    display_name: SBE 1-Node ReplSet Intel AWS 2023-11
    cron: *linux-1-node-repl-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica-sbe
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single-intel.2023-11
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-x86-compile
    run_on:
      - "rhel94-perf-single"
    tasks: *classic_engine_1nodereplset_tasks

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-1-node-replSet-lite-all-feature-flags.arm.aws.2023-11
    display_name: graviton lite, all FF 1-Node ReplSet ARM AWS 2023-11
    cron: *linux-1-node-repl-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      workload_setup: 2022-11
      mongodb_setup: single-replica-all-feature-flags
      infrastructure_provisioning: graviton-single-lite.2022-11
      infrastructure_provisioning_release: 2023-09
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: bestbuy_4_analytics
      - name: bestbuy_4_analytics_columnstore
      - name: bestbuy_4_inserts
      - name: column_store_index_charts_events_1G
      - name: column_store_index_charts_events_10G
      - name: column_store_tpch_10_denormalized
      - name: column_store_tpch_10_denormalized_unindexed
      - name: ssb_column_store_comparison

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-atlas-M30-real.arm.aws.2023-11
    display_name: M30-Atlas ReplSet ARM AWS 2023-11
    cron: *cron_sunday_thursday
    modules: *perf_modules
    expansions:
      mongodb_setup: atlas
      canaries: none
      atlas_setup: M30-repl
      use_custom_build: true
      infrastructure_provisioning: workload_client_arm.2023-04
      infrastructure_provisioning_release: 2023-09
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-atlas-large"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb.2023-09
      - name: ycsb_single_thread
      - name: tpcc
      - name: linkbench2

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-atlas-M60-shard-real-multi-client.arm.aws.2023-11
    display_name: M60-Shard Atlas Multiple Workload Clients ARM AWS 2023-11
    cron: *cron_sunday_thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: atlas-shard
      canaries: none
      atlas_setup: M60-shard
      use_custom_build: true
      infrastructure_provisioning: workload_client_multiple.arm.2023-09
      infrastructure_provisioning_release: 2023-09
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-atlas-large"
    tasks:
      - name: locust_bulk_insert

  - <<: *amazon_linux2_x86_streams_compile_variant_dependency
    name: perf-streams-single.intel.aws.2023-10
    display_name: Streams-Single Intel AWS 2023-10
    cron: "0 0 * * 2,4,6" # Tuesday, Thursday and Saturday at 00:00
    modules: *perf_modules
    expansions:
      compile_variant: amazon2-x86-streams-compile
      requires_mongostream: true
      mongodb_setup_release: 2022-11
      mongodb_setup: streams-single.2023-10
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: streams-single.intel.2023-11
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
    run_on:
      - "rhel94-perf-single"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: stream_workloads

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-standalone-classic-query-engine.arm.aws.2023-11
    display_name: Classic Query Engine Standalone ARM AWS 2023-11
    cron: *cron_query_perf_schedule
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: standalone-classic-query-engine
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks: *classic_engine_tasks

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-standalone-sbe.arm.aws.2023-11
    display_name: SBE Standalone ARM AWS 2023-11
    cron: *cron_query_perf_schedule
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: standalone-sbe
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks: *classic_engine_tasks

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-1-node-replSet-classic-query-engine.arm.aws.2023-11
    display_name: Classic Query Engine 1-Node ReplSet ARM AWS 2023-11
    cron: *linux-1-node-repl-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica-classic-query-engine
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks: *classic_engine_1nodereplset_tasks

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-1-node-replSet-sbe.arm.aws.2023-11
    display_name: SBE 1-Node ReplSet ARM AWS 2023-11
    cron: *linux-1-node-repl-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica-sbe
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks: *classic_engine_1nodereplset_tasks

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-1-node-replSet-test-commands.arm.aws.2023-11
    display_name: 1-Node ReplSet With Test Commands ARM AWS 2023-11
    cron: *linux-1-node-repl-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
      # Needed to allow enabling failpoints.
      config_params_json: '{"v":0, "enableTestCommands": true}'
    run_on:
      - "rhel94-perf-single"
    tasks:
      - name: startup

  - <<: *amazon_linux2_arm64_mongocrypt_compile_variant_dependency
    name: perf-1-node-replSet-fle.arm.aws.2023-11
    display_name: FLE 1-Node ReplSet ARM AWS 2023-11
    cron: *cron_sunday_thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica-fle
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      fle: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
      shlib_compile_variant: amazon2-arm64-mongocrypt-shlib-compile
      mongocrypt_shlib_required: true
    run_on:
      - "rhel94-perf-single"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb.2023-09
      - name: linkbench

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-1-node-15gbwtcache.arm.aws.2023-11
    display_name: 15 GB WiredTiger Cache 1-Node ReplSet ARM AWS 2023-11
    cron: "0 0 * * 2,4" # 00:00 on Tuesday,Thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica-15gbwtcache
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb.2023-09
      - name: smoke_test
      - name: ycsb_60GB.2023-09
      - name: ycsb_60GB.long.2023-09

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-1dayhistory-15gbwtcache.arm.aws.2023-11
    display_name: 1 Day History 15 GB WiredTiger Cache 3-Node ReplSet ARM AWS 2023-11
    cron: *cron_sunday_thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: replica-1dayhistory-15gbwtcache
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: replica
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: crud_workloads_majority
      - name: crud_workloads_w1
      - name: smoke_test
      - name: ycsb_60GB.2023-09
      - name: ycsb_60GB.long.2023-09

  - <<: *amazon2_x86_compile_variant_dependency
    name: perf-3-shard.intel.aws.2023-11
    display_name: 3-Shard Cluster Intel AWS 2023-11
    cron: *cron_sunday_thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: shard
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: shard-intel
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-x86-compile
    run_on:
      - "rhel94-perf-shard"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb.2023-09
      - name: mongos_workloads
      - name: move_chunk_workloads
      - name: move_chunk_waiting_workloads

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-shard-all-feature-flags.arm.aws.2023-11
    display_name: all feature flags 3-Shard Cluster ARM AWS 2023-11
    cron: "0 0 * * 4" # 00:00 on Thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: shard-all-feature-flags
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: shard
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-shard-lite"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: change_streams_preimage_throughput
      - name: change_streams_preimage_latency
      - name: tsbs_query_sharded
      - name: tsbs_query_finance_sharded
      - name: tsbs_query_sharded_balancer
      - name: tsbs_query_finance_sharded_balancer

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-shard-single.arm.aws.2023-11
    display_name: Shard Single ARM AWS 2023-11
    cron: "0 0 * * 2,4" # 00:00 on Tuesday,Thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: shard-single
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: shard-single
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-shard-lite"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-replSet-last-continuous-fcv.arm.aws.2023-11
    display_name: Last Continuous FCV 3-Node ReplSet ARM AWS 2023-11
    cron: "0 0 * * 4" # 00:00 on Thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: replica-last-continuous-fcv
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: replica
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb.2023-09
      - name: ycsb_60GB.2023-09
      - name: ycsb_60GB.long.2023-09
      - name: ycsb_secondary_reads.2023-09
      - name: ycsb_w1.2023-09
      - name: crud_workloads_majority
      - name: crud_workloads_w1
      - name: misc_workloads
      - name: map_reduce_workloads
      - name: refine_shard_key_transaction_stress
      - name: smoke_test
      - name: secondary_performance # Uses a special 2 node mongodb setup
      - name: non_sharded_workloads
      - name: bestbuy_agg
      - name: bestbuy_agg_merge_different_db
      - name: bestbuy_agg_merge_same_db
      - name: bestbuy_agg_merge_wordcount
      - name: bestbuy_query
      - name: change_streams_latency
      - name: change_streams_listen_throughput
      - name: snapshot_reads
      - name: secondary_reads
      - name: tpcc
      - name: tpcc_majority
      - name: tpch_1_normalized
      - name: tpch_1_denormalized
      - name: tpch_10_normalized
      - name: tpch_10_denormalized
      - name: linkbench
      - name: linkbench2
      - name: tsbs_load
      - name: tsbs_query
      - name: tsbs_query_finance
      - name: tsbs_query_manual_bucketing
      - name: tsbs_query_fixed_bucketing
      - name: tsbs-query-genny
      - name: tsbs-query-optimizations

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-replSet-last-lts-fcv.arm.aws.2023-11
    display_name: Last LTS FCV 3-Node ReplSet ARM AWS 2023-11
    cron: "0 0 * * 4" # 00:00 on Thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: replica-last-lts-fcv
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: replica
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb.2023-09
      - name: ycsb_60GB.2023-09
      - name: ycsb_60GB.long.2023-09
      - name: ycsb_secondary_reads.2023-09
      - name: ycsb_w1.2023-09
      - name: crud_workloads_majority
      - name: crud_workloads_w1
      - name: misc_workloads
      - name: map_reduce_workloads
      - name: refine_shard_key_transaction_stress
      - name: smoke_test
      - name: secondary_performance # Uses a special 2 node mongodb setup
      - name: non_sharded_workloads
      - name: bestbuy_agg
      - name: bestbuy_agg_merge_different_db
      - name: bestbuy_agg_merge_same_db
      - name: bestbuy_agg_merge_wordcount
      - name: bestbuy_query
      - name: change_streams_latency
      - name: change_streams_listen_throughput
      - name: snapshot_reads
      - name: secondary_reads
      - name: tpcc
      - name: tpcc_majority
      - name: tpch_1_normalized
      - name: tpch_1_denormalized
      - name: tpch_10_normalized
      - name: tpch_10_denormalized
      - name: linkbench
      - name: linkbench2
      - name: tsbs_load
      - name: tsbs_query
      - name: tsbs_query_finance
      - name: tsbs_query_manual_bucketing
      - name: tsbs_query_fixed_bucketing
      - name: tsbs-query-genny
      - name: tsbs-query-optimizations

  - <<: *amazon2_x86_compile_variant_dependency
    name: perf-3-node-replSet.intel.aws.2024-05
    display_name: 3-Node ReplSet Intel AWS 2024-05
    cron: *linux-3-node-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: replica.2024-05
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: replica-intel.2024-05
      workload_setup: 2024-05
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-x86-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: linkbench2.2024-05
      - name: smoke_test
      - name: top_ten_queries
      - name: tsbs_load.2024-05
      - name: tsbs_query
      - name: tsbs_query_finance
      # This variant is targeted at AWS instances with 30GB of RAM. As such, a database size of ~30GB is larger
      # than the WiredTigerCache and Linux FS Cache (assuming incompressible data).
      # 100 Read tests
      - name: ycsb.100read.2024-05
      - name: ycsb_30GB.100read.2024-05
      - name: ycsb_30GB.100read.rate_limited.2024-05
      # 95Read5Update tests
      - name: ycsb.95read5update.2024-05
      - name: ycsb_30GB.95read5update.2024-05
      - name: ycsb_30GB.95read5update.rate_limited.2024-05
      # 50Read50Update tests
      - name: ycsb.50read50update.2024-05
        activate: false
      - name: ycsb_30GB.50read50update.2024-05
        activate: false
      - name: ycsb_30GB.50read50update.rate_limited.2024-05
        activate: false
      # 100Update tests
      - name: ycsb.100update.2024-05
        activate: false
      - name: ycsb_30GB.100update.2024-05
        activate: false
      - name: ycsb_30GB.100update.rate_limited.2024-05
        activate: false
      - name: tpcc_majority_small

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-replSet-all-feature-flags.arm.aws.2023-11
    display_name: all feature flags 3-Node ReplSet ARM AWS 2023-11
    cron: "0 0 * * 4" # 00:00 on Thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: replica-all-feature-flags
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: replica
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb.2023-09
      - name: ycsb_single_thread
      - name: ycsb_w1.2023-09
      - name: ycsb_60GB.2023-09
      - name: ycsb.load
      - name: ycsb_60GB.long.2023-09
      - name: ycsb_secondary_reads.2023-09
      - name: crud_workloads_majority
      - name: crud_workloads_w1
      - name: misc_workloads
      - name: map_reduce_workloads
      - name: refine_shard_key_transaction_stress
      - name: smoke_test
      - name: secondary_performance # Uses a special 2 node mongodb setup
      - name: non_sharded_workloads
      - name: bestbuy_agg
      - name: bestbuy_agg_merge_different_db
      - name: bestbuy_agg_merge_same_db
      - name: bestbuy_agg_merge_wordcount
      - name: bestbuy_query
      - name: change_streams_preimage_throughput
      - name: change_streams_latency
      - name: change_streams_preimage_latency
      - name: change_streams_listen_throughput
      - name: snapshot_reads
      - name: secondary_reads
      - name: tpcc
      - name: tpcc_majority
      - name: tpch_1_normalized
      - name: tpch_1_denormalized
      - name: tpch_10_normalized
      - name: tpch_10_denormalized
      - name: linkbench
      - name: linkbench2
      - name: tsbs_load
      - name: tsbs_query
      - name: tsbs_query_finance
      - name: tsbs_query_manual_bucketing
      - name: tsbs_query_fixed_bucketing
      - name: tsbs-query-genny
      - name: tsbs-query-optimizations
      - name: tsbs-expression-query
      - name: big_update_10k
      - name: mixed_workloads_genny_rate_limited_high_value
      - name: load_test_high_value
      - name: large_indexed_ins_high_value
      - name: expressive_queries_high_value
      - name: time_series_sort_high_value
      # dbCheck behavior is blocked behind the feature flag,
      # so this task does not run on the non feature flag version
      # of this variant
      - name: dbcheck

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-replSet-notls.arm.aws.2023-11
    display_name: No TLS 3-Node ReplSet ARM AWS 2023-11
    cron: "0 0 * * 4" # 00:00 on Thursday
    modules: *perf_modules
    expansions:
      mongodb_setup: replica-tls-disabled
      mongodb_setup_release: 2022-11
      infrastructure_provisioning: replica
      infrastructure_provisioning_release: 2023-09
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: crud_workloads_majority
      - name: ycsb.2023-09

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-replSet-maintenance-events.arm.aws.2023-11
    display_name: Maintenance Events 3-Node ReplSet ARM AWS 2023-11
    cron: *cron_sunday_thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: replica-maintenance-events
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: replica
      platform: linux
      workload_setup: 2022-11
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb_stepdowns.2023-09
      - name: ycsb_rolling_restarts.2023-09
      - name: ycsb_non_retryable_writes_stepdowns.2023-09
      - name: ycsb_non_retryable_writes_rolling_restarts.2023-09
      - name: ycsb-update_force_stepdowns.2023-09
      - name: linkbench_stepdowns
      - name: linkbench_rolling_restarts
      - name: linkbench_non_retryable_writes_stepdowns
      - name: linkbench_non_retryable_writes_rolling_restarts
      - name: mixed_workloads_genny_stepdowns
      - name: mixed_workloads_genny_rolling_restarts

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-replSet-initialsync-logkeeper.arm.aws.2023-11
    display_name: Initial Sync LogKeeper ReplSet ARM AWS 2023-11
    cron: "0 0 * * 4" # 00:00 on Thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: initialsync-logkeeper
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: initialsync-logkeeper
      workload_setup: 2022-11
      # EBS logkeeper snapshot with FCV set to 8.0
      snapshotId: snap-0679c2f4a929231e7
      platform: linux
      authentication: disabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
      project_dir: *perf_project_dir
    run_on:
      - "rhel94-perf-initialsync-logkeeper"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: initialsync-logkeeper
      - name: initialsync-logkeeper-fcbis

  # Uncomment this to run logkeeper FCV updates automatically. This is only intended to be run in
  # patch builds.
  # - <<: *amazon_linux2_arm64_compile_variant_dependency
  #   name: linux-replSet-initialsync-logkeeper-snapshot-update
  #   display_name: Linux ReplSet Initial Sync LogKeeper Snapshot Update
  #   cron: "0 0 * * 4"  # 00:00 on Thursday
  #   modules: *perf_modules
  #   expansions:
  #     mongodb_setup_release: 2022-11
  #     mongodb_setup: initialsync-logkeeper-snapshot-update
  #     infrastructure_provisioning_release: 2023-09
  #     infrastructure_provisioning: initialsync-logkeeper-snapshot-update
  #     # Update this to latest snapshot after each LTS release.
  #     snapshotId: snap-0679c2f4a929231e7
  #     platform: linux
  #     authentication: disabled
  #     storageEngine: wiredTiger
  #     project_dir: *perf_project_dir
  #     compile_variant: "amazon2-arm64-compile"
  #   run_on:
  #     - "rhel94-perf-initialsync-logkeeper"
  #   tasks:
  #     - name: initialsync-logkeeper-snapshot-update

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-replSet-auth-delay.arm.aws.2023-11
    display_name: Auth Delay 3-Node ReplSet ARM AWS 2023-11
    cron: "0 0 * * 4" # 00:00 on Thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: replica-auth-cluster-delay
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: replica
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task

  - &linux-mongo-perf-repl-arm
    <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-mongo-perf-repl.arm.aws.2023-11
    display_name: Mongo-Perf 1-Node ReplSet inMemory ARM AWS 2023-11
    cron: "0 0 * * 0,2,3,4,5" # Run it every day except Saturday and Monday.
    modules: *perf_modules
    expansions: *repl-arm-expansions
    run_on:
      - "rhel94-perf-microbenchmarks"
    tasks:
      - name: genny_scale_InsertRemove
      - name: update_read_commands
      - name: insert_read_commands
      - name: misc_read_commands
      - name: singleThreaded_read_commands
      - name: wildcard-index-write_read_commands
      - name: pipeline-updates
      - name: wildcard-index-write_read_commands
      - name: pipeline-updates

  - <<: *linux-mongo-perf-repl-arm
    name: perf-mongo-perf-repl-all-feature-flags.arm.aws.2023-01
    display_name: Mongo-Perf 1-Node ReplSet inMemory all feature flags ARM AWS 2023-11
    cron: "0 0 * * 0,2,3,4,5" # Run it every day except Saturday and Monday.
    expansions:
      <<: *repl-arm-expansions
      mongodb_setup: mongo-perf-replica-all-feature-flags.2023-02
    # yaml does not nicely merge arrays, so DO NOT ADD INDIVIDUAL TASKS HERE.
    # Add tasks to the anchor that this variant references
    # If diverging from that list, add the entire list of desired tasks here

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-mongo-perf-standalone-all-feature-flags.arm.aws.2023-11
    display_name: Mongo-Perf Standalone inMemory all feature flags ARM AWS 2023-11
    modules: *perf_modules
    cron: "0 0 * * 0,2,3,4,5" # Run it every day except Saturday and Monday.
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: mongo-perf-standalone-all-feature-flags.2023-02
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: workload_client_mongod_combined.2023-01
      workload_setup: 2022-11
      use_scons_cache: true
      platform: linux
      canaries: none
      storageEngine: inMemory
      project_dir: *perf_project_dir
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-microbenchmarks"
    # Same as standalone tasks, but with tasks required all feature flags added
    tasks: *mirobenchmarks-all-feature-flags-tasks

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-mongo-perf-standalone-classic-query-engine.arm.aws.2023-11
    display_name: Mongo-Perf Standalone inMemory (Classic Query Engine)  ARM AWS 2023-11
    cron: *cron_query_perf_schedule
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: mongo-perf-standalone-classic-query-engine.2023-02
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: workload_client_mongod_combined.2023-01
      workload_setup: 2022-11
      use_scons_cache: true
      platform: linux
      canaries: none
      storageEngine: inMemory
      project_dir: *perf_project_dir
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-microbenchmarks"
    tasks:
      - name: big_collection
      - name: genny_scale_InsertRemove
      - name: genny_execution_UserAcquisition
      - name: aggregation_read_commands
      - name: aggregation_read_commands_large_dataset
      - name: agg-query-comparison_read_commands
      - name: agg-query-comparison_read_commands_high_value
        cron: *cron_query_perf_schedule # *linux-microbenchmarks-standalone-arm contains high-value cron for this task. resetting to correct cron
      - name: query_read_commands
      - name: query_read_commands_large_dataset
      - name: views-aggregation
      - name: views-query
      - name: where_read_commands
      - name: update_read_commands
      - name: insert_read_commands
      - name: wildcard-index-read_read_commands
      - name: wildcard-index-write_read_commands
      - name: geo_read_commands
      - name: misc_read_commands
      - name: misc_custom_filter_default_read_commands
      - name: misc_custom_filter_slow_or_sample_read_commands
      - name: misc_custom_filter_complex_read_commands
      - name: misc_custom_filter_whole_doc_read_commands
      - name: misc_slowms_everything_read_commands
      - name: singleThreaded_read_commands
      - name: pipeline-updates
      - name: javascript
      - name: compound_wildcard_index_write_commands
      - name: compound_wildcard_index_read_commands
      - name: tie-breaking-heuristics
    # yaml does not nicely merge arrays, so DO NOT ADD INDIVIDUAL TASKS HERE.
    # Add tasks to the anchor that this variant references
    # If diverging from that list, add the entire list of desired tasks here

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-mongo-perf-standalone-sbe.arm.aws.2023-11
    display_name: Mongo-Perf Standalone inMemory SBE ARM AWS 2023-11
    cron: *cron_query_perf_schedule
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: mongo-perf-standalone-sbe.2023-02
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: workload_client_mongod_combined.2023-01
      workload_setup: 2022-11
      use_scons_cache: true
      platform: linux
      canaries: none
      storageEngine: inMemory
      project_dir: *perf_project_dir
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-microbenchmarks"
    tasks:
      - name: big_collection
      - name: genny_scale_InsertRemove
      - name: genny_execution_UserAcquisition
      - name: aggregation_read_commands
      - name: aggregation_read_commands_large_dataset
      - name: agg-query-comparison_read_commands
      - name: agg-query-comparison_read_commands_high_value
        cron: *cron_query_perf_schedule # *linux-microbenchmarks-standalone-arm contains high-value cron for this task. resetting to correct cron
      - name: query_read_commands
      - name: query_read_commands_large_dataset
      - name: views-aggregation
      - name: views-query
      - name: where_read_commands
      - name: update_read_commands
      - name: insert_read_commands
      - name: wildcard-index-read_read_commands
      - name: wildcard-index-write_read_commands
      - name: geo_read_commands
      - name: misc_read_commands
      - name: misc_custom_filter_default_read_commands
      - name: misc_custom_filter_slow_or_sample_read_commands
      - name: misc_custom_filter_complex_read_commands
      - name: misc_custom_filter_whole_doc_read_commands
      - name: misc_slowms_everything_read_commands
      - name: singleThreaded_read_commands
      - name: pipeline-updates
      - name: javascript
      - name: compound_wildcard_index_write_commands
      - name: compound_wildcard_index_read_commands
      - name: tie-breaking-heuristics
    # yaml does not nicely merge arrays, so DO NOT ADD INDIVIDUAL TASKS HERE.
    # Add tasks to the anchor that this variant references
    # If diverging from that list, add the entire list of desired tasks here

  - &linux-mongo-perf-repl-intel
    <<: *amazon2_x86_compile_variant_dependency
    name: perf-mongo-perf-repl.intel.aws.2023-11
    display_name: Mongo-Perf 1-Node ReplSet inMemory Intel AWS 2023-11
    cron: "0 0 * * 0,2,3,4,5" # Run it every day except Saturday and Monday.
    modules: *perf_modules
    expansions: *repl-intel-expansions
    run_on:
      - "rhel94-perf-microbenchmarks"
    tasks:
      - name: genny_scale_InsertRemove
      - name: update_read_commands
      - name: insert_read_commands
      - name: misc_read_commands
      - name: singleThreaded_read_commands
      - name: wildcard-index-write_read_commands
      - name: pipeline-updates

  - <<: *linux-mongo-perf-repl-intel
    name: perf-mongo-perf-repl-all-feature-flags.intel.aws.2023-01
    display_name: Mongo-Perf 1-Node ReplSet inMemory all feature flags Intel AWS 2023-11
    cron: "0 0 * * 0,2,3,4,5" # Run it every day except Saturday and Monday.
    modules: *perf_modules
    expansions:
      <<: *repl-intel-expansions
      mongodb_setup: mongo-perf-replica-all-feature-flags.2023-02
    # yaml does not nicely merge arrays, so DO NOT ADD INDIVIDUAL TASKS HERE.
    # Add tasks to the anchor that this variant references
    # If diverging from that list, add the entire list of desired tasks here

  - <<: *amazon2_x86_compile_variant_dependency
    name: perf-mongo-perf-standalone-all-feature-flags.intel.aws.2023-01
    display_name: Mongo-Perf Standalone inMemory all feature flags Intel AWS 2023-11
    cron: "0 0 * * 0,2,3,4,5" # Run it every day except Saturday and Monday.
    modules: *perf_modules
    expansions: *standalone-intel-expansions
    run_on:
      - "rhel94-perf-microbenchmarks"
    tasks: *mirobenchmarks-all-feature-flags-tasks
    # yaml does not nicely merge arrays, so DO NOT ADD INDIVIDUAL TASKS HERE.
    # Add tasks to the anchor that this variant references
    # If diverging from that list, add the entire list of desired tasks here

  - <<: *amazon2_x86_compile_variant_dependency
    name: perf-mongo-perf-standalone-classic-query-engine.intel.aws.2023-01
    display_name: Mongo-Perf Standalone inMemory (Classic Query Engine)  Intel AWS 2023-11
    cron: *cron_query_perf_schedule
    modules: *perf_modules
    expansions:
      <<: *standalone-intel-expansions
      mongodb_setup: mongo-perf-standalone-classic-query-engine.2023-02
    run_on:
      - "rhel94-perf-microbenchmarks"
    tasks:
      - name: big_collection
      - name: genny_scale_InsertRemove
      - name: genny_execution_UserAcquisition
      - name: aggregation_read_commands
      - name: aggregation_read_commands_large_dataset
      - name: agg-query-comparison_read_commands
      - name: agg-query-comparison_read_commands_high_value
        cron: *cron_query_perf_schedule # *linux-microbenchmarks-standalone-arm contains high-value cron for this task. Resetting to correct cron
      - name: query_read_commands
      - name: query_read_commands_large_dataset
      - name: views-aggregation
      - name: views-query
      - name: where_read_commands
      - name: update_read_commands
      - name: insert_read_commands
      - name: wildcard-index-read_read_commands
      - name: wildcard-index-write_read_commands
      - name: geo_read_commands
      - name: misc_read_commands
      - name: misc_custom_filter_default_read_commands
      - name: misc_custom_filter_slow_or_sample_read_commands
      - name: misc_custom_filter_complex_read_commands
      - name: misc_custom_filter_whole_doc_read_commands
      - name: misc_slowms_everything_read_commands
      - name: singleThreaded_read_commands
      - name: pipeline-updates
      - name: javascript
      - name: compound_wildcard_index_write_commands
      - name: compound_wildcard_index_read_commands
      - name: tie-breaking-heuristics
    # yaml does not nicely merge arrays, so DO NOT ADD INDIVIDUAL TASKS HERE.
    # Add tasks to the anchor that this variant references
    # If diverging from that list, add the entire list of desired tasks here

  - <<: *amazon2_x86_compile_variant_dependency
    name: perf-mongo-perf-standalone-sbe.intel.aws.2023-01
    display_name: Mongo-Perf Standalone inMemory SBE Intel AWS 2023-11
    cron: *cron_query_perf_schedule
    modules: *perf_modules
    expansions:
      <<: *standalone-intel-expansions
      mongodb_setup: mongo-perf-standalone-sbe.2023-02
    run_on:
      - "rhel94-perf-microbenchmarks"
    tasks:
      - name: big_collection
      - name: genny_scale_InsertRemove
      - name: genny_execution_UserAcquisition
      - name: aggregation_read_commands
      - name: aggregation_read_commands_large_dataset
      - name: agg-query-comparison_read_commands
      - name: agg-query-comparison_read_commands_high_value
        cron: *cron_query_perf_schedule # *linux-microbenchmarks-standalone-arm contains high-value cron for this task. Resetting to correct cron
      - name: query_read_commands
      - name: query_read_commands_large_dataset
      - name: views-aggregation
      - name: views-query
      - name: where_read_commands
      - name: update_read_commands
      - name: insert_read_commands
      - name: wildcard-index-read_read_commands
      - name: wildcard-index-write_read_commands
      - name: geo_read_commands
      - name: misc_read_commands
      - name: misc_custom_filter_default_read_commands
      - name: misc_custom_filter_slow_or_sample_read_commands
      - name: misc_custom_filter_complex_read_commands
      - name: misc_custom_filter_whole_doc_read_commands
      - name: misc_slowms_everything_read_commands
      - name: singleThreaded_read_commands
      - name: pipeline-updates
      - name: javascript
      - name: compound_wildcard_index_write_commands
      - name: compound_wildcard_index_read_commands
      - name: tie-breaking-heuristics
    # yaml does not nicely merge arrays, so DO NOT ADD INDIVIDUAL TASKS HERE.
    # Add tasks to the anchor that this variant references
    # If diverging from that list, add the entire list of desired tasks here

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-1-node-replSet-longRunning.arm.aws.2023-11
    display_name: Long-Running 1-Node ReplSet ARM AWS 2023-11
    cron: "0 0 * * 6" # 00:00 on every Saturday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: M60-like-single-large-volume.2023-02
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks:
      - name: tsbs_query_high_cardinality
      - name: tsbs_query_medium_cardinality

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-1-node-replSet-all-feature-flags-longRunning.arm.aws.2023-11
    display_name: Long-Running all feature flags 1-Node ReplSet ARM AWS 2023-11
    cron: "0 0 * * 6" # 00:00 on every Saturday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica-all-feature-flags
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: M60-like-single-large-volume.2023-02
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks:
      - name: tsbs_query_high_cardinality
      - name: tsbs_query_medium_cardinality

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-1-node-replSet-m60-like-large-volume.arm.aws.2023-11
    display_name: M60-like Large Volume 1-Node ReplSet ARM AWS 2023-11
    cron: "0 0 * * *" # 00:00 everyday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: M60-like-single-large-volume.2023-02
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks:
      - name: tsbs_high_cardinality_short

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-1-node-replSet-all-feature-flags-m60-like-large-volume.arm.aws.2023-11
    display_name: M60-like Large Volume all feature flags 1-Node ReplSet ARM AWS 2023-11
    cron: "0 0 * * *" # 00:00 everyday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: single-replica-all-feature-flags
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: M60-like-single-large-volume.2023-02
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks:
      - name: tsbs_high_cardinality_short

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-arm-3-shard-resharding.arm.aws.2023-11
    display_name: Resharding 3-Shard ARM AWS 2023-11
    cron: "0 0 * * 4" # 00:00 on Thursday
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: resharding-3shard.2023-08
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: resharding-3shard.2023-08
      workload_setup: 2022-11
      snapshotId: snap-04f729f7224909902 # FCV 8.0
      platform: linux
      authentication: disabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
      project_dir: *perf_project_dir
    run_on:
      - "rhel94-perf-shard"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: genny_resharding_withIndexes

  # Uncomment this to run resharding snapshot FCV updates automatically.
  # This is only intended to be run in patch builds.
  # - <<: *amazon_linux2_arm64_compile_variant_dependency
  #   name: resharding-3shard-snapshot-update
  #   display_name: Resharding 3-Shard Snapshot Update
  #   cron: "0 0 * * 4"  # 00:00 on Thursday
  #   modules: *perf_modules
  #   expansions:
  #     mongodb_setup_release: 2022-11
  #     mongodb_setup: resharding-3shard-snapshot-update.2023-10
  #     infrastructure_provisioning_release: 2022-11
  #     infrastructure_provisioning: resharding-3shard-snapshot-update.2023-10
  #     # Update this to latest snapshot after each LTS release.
  #     snapshotId: snap-0e7434150d05e0e47 # FCV 7.3
  #     platform: linux
  #     authentication: disabled
  #     storageEngine: wiredTiger
  #     project_dir: *perf_project_dir
  #     compile_variant: amazon2-arm64-compile
  #   run_on:
  #     - "rhel94-perf-shard"
  #   tasks:
  #     - *schedule_patch_auto_tasks_task
  #     - *schedule_variant_auto_tasks_task
  #     - name: resharding-3shard-snapshot-update

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-replSet-query-settings.arm.aws.2023-11
    display_name: QuerySettings 3-Node ReplSet ARM AWS 2023-11
    cron: *linux-3-node-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: replica-query-settings
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: replica
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - name: schedule_variant_auto_tasks
      - name: ycsb.2023-09
      - name: ycsb_60GB.2023-09
      - name: ycsb_60GB.long.2023-09
      - name: tpcc_majority
      - name: linkbench2
      - name: mixed_workloads_genny_rate_limited_high_value
      - name: bestbuy_agg
      - name: large_indexed_ins_high_value
      - name: expressive_queries_high_value
      - name: time_series_sort_high_value
      - name: tsbs_query
      - name: array_traversal_high_value
      - name: tsbs_query

  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-shard-query-settings.arm.aws.2023-11
    display_name: QuerySettings 3-Shard Cluster ARM AWS 2023-11
    cron: *linux-3-shard-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: shard-query-settings
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: shard
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-shard"
    tasks:
      - *schedule_patch_auto_tasks_task
      - name: schedule_variant_auto_tasks
      - name: ycsb.2023-09
      - name: tpcc_majority
      - name: mixed_workloads_genny_rate_limited_high_value
      - name: bestbuy_agg
      - name: large_indexed_ins_high_value
      - name: expressive_queries_high_value
      - name: time_series_sort_high_value
      - name: tsbs_query
      - name: array_traversal_high_value
      - name: tsbs_query
      - name: mongos_workloads

  - &3node-query-stats-rate-limit
    <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-replSet-limited-1-query-stats.arm.aws.2023-11
    display_name: QueryStats, Rate Limited with 1 3-Node ReplSet ARM AWS 2023-11
    modules: *perf_modules
    expansions: *3node-query-stats-rate-limit-expansions
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - name: schedule_variant_auto_tasks
      - name: ycsb.2023-09
      - name: ycsb_60GB.2023-09
      - name: ycsb_60GB.long.2023-09
      - name: tpcc_majority
      - name: linkbench2
      - name: mixed_workloads_genny_rate_limited_high_value
      - name: bestbuy_agg
      - name: large_indexed_ins_high_value
      - name: expressive_queries_high_value
      - name: time_series_sort_high_value
      - name: tsbs_query

  - <<: *3node-query-stats-rate-limit
    name: perf-3-node-replSet-limited-10-query-stats.arm.aws.2023-11
    display_name: QueryStats, Rate Limited with 10 3-Node ReplSet ARM AWS 2023-11
    expansions:
      <<: *3node-query-stats-rate-limit-expansions
      config_params_json: '{"v": 0, "internalQueryStatsRateLimit": 10}'

  - <<: *3node-query-stats-rate-limit
    name: perf-3-node-replSet-limited-1000-query-stats.arm.aws.2023-11
    display_name: QueryStats, Rate Limited with 1000 3-Node ReplSet ARM AWS 2023-11
    expansions:
      <<: *3node-query-stats-rate-limit-expansions
      config_params_json: '{"v": 0, "internalQueryStatsRateLimit": 1000}'

  - <<: *3node-query-stats-rate-limit
    name: perf-3-node-replSet-limited-10000-query-stats.arm.aws.2023-11
    display_name: QueryStats, Rate Limited with 10000 3-Node ReplSet ARM AWS 2023-11
    expansions:
      <<: *3node-query-stats-rate-limit-expansions
      config_params_json: '{"v": 0, "internalQueryStatsRateLimit": 10000}'

  # Variant which runs a single shard cluster with a config
  # shard and mongos process processes co-located on the
  # same machine as the mongod.
  # This variant is a performance comparison point between
  # a traditional single node replica set as defined in the
  # 'Linux 1-Node ReplSet 2022-11' variant and fully embedded
  # single shard clusters.
  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-1-node-replSet-default-sharding.arm.aws.2023-11
    display_name: Default Sharding 1-Node ReplSet ARM AWS 2023-11
    cron: *linux-1-node-repl-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: shard-one-node-default-sharding
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: single
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-single"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb.2023-09
      - name: ycsb_single_thread
      - name: ycsb_60GB.2023-09
      - name: ycsb_60GB.long.2023-09
      - name: crud_workloads_majority
      - name: misc_workloads
      - name: map_reduce_workloads
      - name: smoke_test
      - name: canaries_only
      - name: non_sharded_workloads
      - name: bestbuy_agg
      - name: bestbuy_agg_merge_different_db
      - name: bestbuy_agg_merge_same_db
      - name: bestbuy_agg_merge_wordcount
      - name: bestbuy_query
      - name: change_streams_latency
      - name: change_streams_listen_throughput
      - name: snapshot_reads
      - name: linkbench
      - name: linkbench2
      - name: tsbs_load
      - name: tsbs_query
      - name: tsbs_query_finance
      - name: tsbs_query_manual_bucketing
      - name: tsbs_query_fixed_bucketing
      - name: tsbs-query-genny
      - name: tsbs-query-optimizations
      - name: tpcc
      - name: tpcc_majority
      - name: tpch_1_normalized
      - name: tpch_1_denormalized
      - name: tpch_10_normalized
      - name: tpch_10_denormalized
      - name: genny_execution_ValidationFull

  # Variant which runs a single shard cluster with a config
  # shard and mongos processes processes co-located on the
  # same machine as the mongods.
  # This variant is a performance comparison point between
  # a traditional replica set as defined in the
  # 'Linux 3-Node ReplSet 2022-11' variant and fully embedded
  # single shard clusters.
  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-replSet-default-sharding.arm.aws.2023-11
    display_name: Default Sharding 3-Node ReplSet ARM AWS 2023-11
    cron: *linux-3-node-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: shard-default-sharding
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: replica
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb.2023-09
        cron: *high-value-workload-cron
      - name: ycsb_single_thread
      - name: ycsb_w1.2023-09
      - name: ycsb_60GB.2023-09
      - name: ycsb.load
      - name: ycsb_60GB.long.2023-09
        cron: *high-value-workload-cron
      - name: ycsb_secondary_reads.2023-09
      - name: crud_workloads_majority
      - name: crud_workloads_w1
      - name: misc_workloads
      - name: map_reduce_workloads
      - name: smoke_test
      - name: secondary_performance # Uses a special 2 node mongodb setup
      - name: non_sharded_workloads
      - name: bestbuy_agg
        cron: *high-value-workload-cron
      - name: bestbuy_agg_merge_different_db
      - name: bestbuy_agg_merge_same_db
      - name: bestbuy_agg_merge_wordcount
      - name: bestbuy_query
      - name: change_streams_preimage_throughput
      - name: change_streams_latency
      - name: change_streams_preimage_latency
      - name: change_streams_listen_throughput
      - name: snapshot_reads
      - name: secondary_reads
      - name: tpcc
      - name: tpcc_majority
        cron: *high-value-workload-cron
      - name: tpch_1_normalized
      - name: tpch_1_denormalized
      - name: tpch_10_normalized
      - name: tpch_10_denormalized
      - name: linkbench
      - name: linkbench2
        cron: *high-value-workload-cron
      - name: tsbs_load
        cron: *high-value-workload-cron
      - name: tsbs_query
        cron: *high-value-workload-cron
      - name: tsbs_query_finance
      - name: tsbs_query_manual_bucketing
      - name: tsbs_query_fixed_bucketing
      - name: tsbs-query-genny
      - name: tsbs-query-optimizations
      - name: tsbs-expression-query
      - name: big_update_10k
      - name: mixed_workloads_genny_rate_limited_high_value
        cron: *high-value-workload-cron
      - name: load_test_high_value
        cron: *high-value-workload-cron
      - name: large_indexed_ins_high_value
        cron: *high-value-workload-cron
      - name: expressive_queries_high_value
        cron: *high-value-workload-cron
      - name: time_series_sort_high_value
        cron: *high-value-workload-cron
      - name: array_traversal_high_value
      - name: mongos_workloads

  # Variant which runs a single shard cluster with a config
  # shard and mongos processes on dedicated machines.
  # This variant is a performance comparison point between
  # a traditional replica set as defined in the
  # 'Linux 3-Node ReplSet 2022-11' variant and single shard
  # clusters with dedicated routers.
  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-replSet-dedicated-default-sharding.arm.aws.2023-11
    display_name: Dedicated Default Sharding 3-Node ReplSet ARM AWS 2023-11
    cron: *linux-3-node-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: dedicated-shard-default-sharding
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: dedicated-shard-default-sharding
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-replset"
    tasks:
      - *schedule_patch_auto_tasks_task
      - *schedule_variant_auto_tasks_task
      - name: ycsb.2023-09
        cron: *high-value-workload-cron
      - name: ycsb_single_thread
      - name: ycsb_w1.2023-09
      - name: ycsb_60GB.2023-09
      - name: ycsb.load
      - name: ycsb_60GB.long.2023-09
        cron: *high-value-workload-cron
      - name: ycsb_secondary_reads.2023-09
      - name: crud_workloads_majority
      - name: crud_workloads_w1
      - name: misc_workloads
      - name: map_reduce_workloads
      - name: smoke_test
      # TODO SERVER-88115: Enable.
      # - name: secondary_performance # Uses a special 2 node mongodb setup
      - name: non_sharded_workloads
      - name: bestbuy_agg
        cron: *high-value-workload-cron
      - name: bestbuy_agg_merge_different_db
      - name: bestbuy_agg_merge_same_db
      - name: bestbuy_agg_merge_wordcount
      - name: bestbuy_query
      - name: change_streams_preimage_throughput
      - name: change_streams_latency
      - name: change_streams_preimage_latency
      - name: change_streams_listen_throughput
      - name: snapshot_reads
      # TODO SERVER-88115: Enable.
      # - name: secondary_reads
      - name: tpcc
      - name: tpcc_majority
        cron: *high-value-workload-cron
      - name: tpch_1_normalized
      - name: tpch_1_denormalized
      - name: tpch_10_normalized
      - name: tpch_10_denormalized
      - name: linkbench
      - name: linkbench2
        cron: *high-value-workload-cron
      - name: tsbs_load
        cron: *high-value-workload-cron
      - name: tsbs_query
        cron: *high-value-workload-cron
      - name: tsbs_query_finance
      - name: tsbs_query_manual_bucketing
      - name: tsbs_query_fixed_bucketing
      - name: tsbs-query-genny
      - name: tsbs-query-optimizations
      - name: tsbs-expression-query
      - name: big_update_10k
      - name: mixed_workloads_genny_rate_limited_high_value
        cron: *high-value-workload-cron
      - name: load_test_high_value
        cron: *high-value-workload-cron
      - name: large_indexed_ins_high_value
        cron: *high-value-workload-cron
      - name: expressive_queries_high_value
        cron: *high-value-workload-cron
      - name: time_series_sort_high_value
        cron: *high-value-workload-cron
      - name: array_traversal_high_value
      - name: mongos_workloads

  - name: renew-ssl-cert
    display_name: Renew SSL Cert
    cron: "0 0 * * 4" # 00:00 on Thursday
    modules: *perf_modules
    run_on:
      # Certbot with route53 plugin is installed on Ubuntu 20.04
      # This distro is limited to 1 host to avoid concurrent runs.
      - "ubuntu2004-small-dsi-cert-renewal"
    tasks:
      - name: renew_ssl_cert

  # Variant which runs a single shard cluster with a dedicated
  # config shard and mongos processes co-located on the
  # same machine as the mongods.
  - <<: *amazon_linux2_arm64_compile_variant_dependency
    name: perf-3-node-replSet-shard-dedicated-csrs-embedded-mongos.arm.aws.2023-11
    display_name: Shard Dedicated CSRS Co-located Mongos 3-Node ReplSet ARM AWS 2023-11
    cron: *linux-3-node-cron
    modules: *perf_modules
    expansions:
      mongodb_setup_release: 2022-11
      mongodb_setup: shard-dedicated-csrs-embedded-mongos
      infrastructure_provisioning_release: 2023-09
      infrastructure_provisioning: shard-dedicated-csrs-embedded-mongos
      workload_setup: 2022-11
      platform: linux
      project_dir: *perf_project_dir
      authentication: enabled
      storageEngine: wiredTiger
      compile_variant: amazon2-arm64-compile
    run_on:
      - "rhel94-perf-shard"
    tasks:
      - name: load_test_high_value
        cron: *high-value-workload-cron
