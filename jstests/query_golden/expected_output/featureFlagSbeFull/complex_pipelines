setting random seed: 20240725
Docs:

{_id: 1, e: 95, a: 32, h: 71, d: 10, x: {a: 4, b: 40, c: 0}, g: 26, c: 60, w: {a: 18, b: 25, c: 26}, f: 85, b: 64, i: 65},
{_id: 2, e: 13, w: {a: 94, b: 32, c: 58}, d: 94, i: 42, c: 32, h: 50, b: 21, g: 2, a: 85, f: 98, x: {a: 8, b: 71, c: 40}},
{_id: 3, a: 27, h: 72, d: 93, x: {a: 19, b: 99, c: 77}, g: 8, c: 77, w: {a: 11, b: 3, c: 9}, f: 49, b: 47, i: 67, e: 40},
{_id: 4, a: 29, h: 83, d: 34, x: {a: 81, b: 68, c: 20}, g: 16, c: 87, w: {a: 86, b: 75, c: 3}, f: 50, b: 76, i: 38, e: 82},
{_id: 5, d: 7, b: 4, x: {a: 75, b: 5, c: 70}, i: 93, g: 15, e: 87, c: 49, a: 89, w: {a: 44, b: 19, c: 96}, h: 75, f: 69},
{_id: 6, f: 41, e: 55, d: 54, c: 94, b: 71, a: 85, x: {a: 59, b: 36, c: 59}, w: {a: 10, b: 66, c: 62}, i: 84, h: 71, g: 16},
{_id: 7, w: {a: 48, b: 63, c: 47}, h: 86, f: 18, d: 65, b: 40, x: {a: 47, b: 88, c: 40}, i: 44, g: 66, e: 78, c: 11, a: 85},
{_id: 8, g: 62, c: 24, w: {a: 15, b: 23, c: 89}, f: 4, b: 81, i: 43, e: 63, a: 75, h: 74, d: 92, x: {a: 9, b: 4, c: 79}}


Foreign docs:

{_id: 1, b: 57, c: 58, a: 41},
{_id: 2, b: 12, c: 54, a: 92},
{_id: 3, c: 99, a: 47, b: 57},
{_id: 4, b: 16, c: 7, a: 60},
{_id: 5, a: 16, b: 71, c: 91},
{_id: 6, c: 78, a: 37, b: 67},
{_id: 7, a: 0, c: 4, b: 1},
{_id: 8, a: 14, b: 86, c: 90}


Query 1 (with useIndex=false): [ { "$setWindowFields" : { "partitionBy" : "$f", "sortBy" : { "k" : -1, "d" : -1, "_id" : 1 }, "output" : { "l" : { "$sum" : "$l", "window" : { "documents" : [ "unbounded", "unbounded" ] } }, "e" : { "$sum" : "$e", "window" : { "documents" : [ "current", "unbounded" ] } } } } }, { "$addFields" : { "i" : "$l", "k" : "$a" } }, { "$addFields" : { "f" : "$m", "w" : "$y" } }, { "$setWindowFields" : { "partitionBy" : "$j", "sortBy" : { "g" : 1, "h" : 1, "_id" : 1 }, "output" : { "h" : { "$sum" : "$h", "window" : { "documents" : [ "unbounded", "unbounded" ] } } } } }, { "$addFields" : { "e" : 8, "l" : 86, "j" : "$t", "w" : "$w" } }, { "$match" : { "b" : { "$lt" : 76 } } }, { "$setWindowFields" : { "sortBy" : { "a" : 1, "e" : 1, "_id" : 1 }, "output" : { "e" : { "$sum" : "$e", "window" : { "documents" : [ -2, 2 ] } }, "y" : { "$min" : "$y", "window" : { "documents" : [ "current", "unbounded" ] } } } } }, { "$addFields" : { "l" : "$q", "j" : 72, "y" : "$w" } }, { "$match" : { "a" : { "$gte" : 7 } } }, { "$project" : { "h" : 0, "c" : 0 } } ]

{_id: 1, e: 32, a: 32, d: 10, x: {a: 4, b: 40, c: 0}, g: 26, b: 64, i: 0, k: 32, j: 72},
{_id: 2, e: 40, d: 94, i: 0, b: 21, g: 2, a: 85, x: {a: 8, b: 71, c: 40}, k: 85, j: 72},
{_id: 3, a: 27, d: 93, x: {a: 19, b: 99, c: 77}, g: 8, b: 47, i: 0, e: 24, k: 27, j: 72},
{_id: 5, d: 7, b: 4, x: {a: 75, b: 5, c: 70}, i: 0, g: 15, e: 24, a: 89, k: 89, j: 72},
{_id: 6, e: 40, d: 54, b: 71, a: 85, x: {a: 59, b: 36, c: 59}, i: 0, g: 16, k: 85, j: 72},
{_id: 7, d: 65, b: 40, x: {a: 47, b: 88, c: 40}, i: 0, g: 66, e: 32, a: 85, k: 85, j: 72}

Query 2 (with useIndex=false): [ { "$addFields" : { "f" : 44, "h" : "$q" } }, { "$match" : { "g" : { "$gte" : 6 } } }, { "$addFields" : { "j" : 41, "f" : 60, "k" : 64 } }, { "$addFields" : { "e" : "$c", "c" : "$d" } }, { "$addFields" : { "j" : 23, "l" : "$h", "c" : "$j" } }, { "$project" : { "g" : 0, "h" : 0 } }, { "$addFields" : { "k" : "$e", "a" : 56, "y" : "$w" } } ]

{_id: 1, e: 60, a: 56, d: 10, x: {a: 4, b: 40, c: 0}, c: 41, w: {a: 18, b: 25, c: 26}, f: 60, b: 64, i: 65, j: 23, k: 60, y: {a: 18, b: 25, c: 26}},
{_id: 3, a: 56, d: 93, x: {a: 19, b: 99, c: 77}, c: 41, w: {a: 11, b: 3, c: 9}, f: 60, b: 47, i: 67, e: 77, j: 23, k: 77, y: {a: 11, b: 3, c: 9}},
{_id: 4, a: 56, d: 34, x: {a: 81, b: 68, c: 20}, c: 41, w: {a: 86, b: 75, c: 3}, f: 60, b: 76, i: 38, e: 87, j: 23, k: 87, y: {a: 86, b: 75, c: 3}},
{_id: 5, d: 7, b: 4, x: {a: 75, b: 5, c: 70}, i: 93, e: 49, c: 41, a: 56, w: {a: 44, b: 19, c: 96}, f: 60, j: 23, k: 49, y: {a: 44, b: 19, c: 96}},
{_id: 6, f: 60, e: 94, d: 54, c: 41, b: 71, a: 56, x: {a: 59, b: 36, c: 59}, w: {a: 10, b: 66, c: 62}, i: 84, j: 23, k: 94, y: {a: 10, b: 66, c: 62}},
{_id: 7, w: {a: 48, b: 63, c: 47}, f: 60, d: 65, b: 40, x: {a: 47, b: 88, c: 40}, i: 44, e: 11, c: 41, a: 56, j: 23, k: 11, y: {a: 48, b: 63, c: 47}},
{_id: 8, c: 41, w: {a: 15, b: 23, c: 89}, f: 60, b: 81, i: 43, e: 24, a: 56, d: 92, x: {a: 9, b: 4, c: 79}, j: 23, k: 24, y: {a: 15, b: 23, c: 89}}

Query 3 (with useIndex=false): [ { "$addFields" : { "h" : 31, "y" : "$y" } }, { "$project" : { "e" : 0 } }, { "$match" : { "a" : { "$gte" : 15 } } }, { "$match" : { "i" : { "$gte" : 1 } } }, { "$match" : { "k" : { "$gt" : 9 } } }, { "$match" : { "a" : { "$lt" : 87 } } }, { "$project" : { "i" : 0, "x" : 0 } }, { "$addFields" : { "d" : "$p", "e" : 68, "h" : 97 } } ]


Query 4 (with useIndex=false): [ { "$addFields" : { "b" : "$a", "j" : 34, "k" : "$o", "x" : "$w" } }, { "$project" : { "k" : 0, "x" : 0 } }, { "$project" : { "i" : 1, "l" : "$c", "d" : 1, "h" : 1, "f" : 1, "e" : { "$literal" : 89 }, "c" : 1, "g" : 1, "j" : 1, "w" : 1, "x" : 1 } }, { "$project" : { "f" : "$k", "i" : "$c", "j" : 1, "e" : 1, "g" : 1, "b" : "$b", "d" : 1, "h" : 1, "l" : 1, "c" : 1, "a" : 1, "y" : 1 } }, { "$project" : { "j" : 0, "i" : 0, "w" : 0 } } ]

{_id: 1, h: 71, d: 10, g: 26, c: 60, l: 60, e: 89},
{_id: 2, d: 94, c: 32, h: 50, g: 2, l: 32, e: 89},
{_id: 3, h: 72, d: 93, g: 8, c: 77, l: 77, e: 89},
{_id: 4, h: 83, d: 34, g: 16, c: 87, l: 87, e: 89},
{_id: 5, d: 7, g: 15, c: 49, h: 75, l: 49, e: 89},
{_id: 6, d: 54, c: 94, h: 71, g: 16, l: 94, e: 89},
{_id: 7, h: 86, d: 65, g: 66, c: 11, l: 11, e: 89},
{_id: 8, g: 62, c: 24, h: 74, d: 92, l: 24, e: 89}

Query 5 (with useIndex=false): [ { "$project" : { "i" : 0 } }, { "$addFields" : { "f" : 72, "l" : "$r", "c" : 99 } }, { "$match" : { "k" : { "$gte" : 15 } } }, { "$addFields" : { "b" : 3, "j" : "$l", "k" : "$i", "x" : "$w" } }, { "$project" : { "b" : 1, "f" : 1, "c" : 1, "i" : 1, "a" : 1, "j" : 1, "k" : { "$literal" : 85 }, "d" : 1, "y" : 1 } }, { "$match" : { "a" : { "$gt" : 18 } } }, { "$project" : { "k" : "$h", "h" : 1, "j" : "$l", "i" : "$f", "d" : "$b", "f" : "$f", "g" : 1, "b" : 1, "e" : 1, "w" : 1 } }, { "$project" : { "h" : 1, "k" : 1, "l" : 1, "a" : 1, "i" : 1, "b" : 1, "g" : 1, "e" : 1, "w" : 1 } }, { "$match" : { "b" : { "$gte" : 12 } } }, { "$addFields" : { "j" : 74, "y" : "$y" } } ]


Query 6 (with useIndex=false): [ { "$project" : { "i" : 1, "b" : "$b", "h" : "$l", "g" : 1, "a" : "$f", "k" : 1, "j" : "$k", "e" : 1, "d" : 1, "f" : 1, "y" : 1, "x" : 1 } }, { "$setWindowFields" : { "partitionBy" : "$j", "sortBy" : { "a" : -1, "j" : -1, "_id" : 1 }, "output" : { "j" : { "$sum" : "$j", "window" : { "documents" : [ "unbounded", "current" ] } }, "d" : { "$sum" : "$d", "window" : { "documents" : [ "unbounded", "unbounded" ] } }, "w" : { "$min" : "$w", "window" : { "documents" : [ "current", "unbounded" ] } } } } }, { "$addFields" : { "i" : 85, "j" : 39, "k" : 29 } }, { "$match" : { "i" : { "$lte" : 75 } } }, { "$project" : { "l" : 1, "e" : 1, "j" : 1, "b" : 1, "f" : 1, "k" : 1, "h" : 1, "d" : "$f", "x" : 1 } }, { "$match" : { "d" : { "$lte" : 89 } } }, { "$project" : { "b" : 0, "j" : 0, "x" : 0 } }, { "$setWindowFields" : { "partitionBy" : "$f", "sortBy" : { "b" : -1, "k" : -1, "_id" : 1 }, "output" : { "k" : { "$sum" : "$k", "window" : { "documents" : [ "current", "unbounded" ] } }, "x" : { "$min" : "$x", "window" : { "documents" : [ -2, 0 ] } } } } }, { "$match" : { "i" : { "$gte" : 23 } } }, { "$addFields" : { "h" : "$b", "b" : 9 } }, { "$addFields" : { "f" : 97 } }, { "$match" : { "j" : { "$lte" : 88 } } } ]


Query 7 (with useIndex=false): [ { "$group" : { "_id" : "$f", "l" : { "$sum" : "$l" }, "k" : { "$sum" : "$k" }, "g" : { "$sum" : "$g" }, "c" : { "$sum" : "$c" }, "d" : { "$sum" : "$d" }, "j" : { "$sum" : "$j" }, "e" : { "$sum" : "$e" }, "i" : { "$sum" : "$i" }, "f" : { "$sum" : "$f" }, "b" : { "$sum" : "$b" }, "h" : { "$sum" : "$h" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$project" : { "d" : 0 } }, { "$group" : { "_id" : "$f", "a" : { "$sum" : "$a" }, "f" : { "$sum" : "$f" }, "l" : { "$sum" : "$l" }, "e" : { "$sum" : "$e" }, "g" : { "$sum" : "$g" }, "b" : { "$sum" : "$b" }, "d" : { "$sum" : "$d" }, "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "k" : { "$sum" : "$k" }, "j" : { "$sum" : "$j" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } }, { "$group" : { "_id" : "$k", "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "c" : { "$sum" : "$c" }, "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "i" : { "$sum" : "$i" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "i" : "$o", "h" : "$o", "j" : "$k", "x" : "$w" } }, { "$match" : { "e" : { "$gt" : 16 } } }, { "$project" : { "h" : 0, "a" : 0, "y" : 0 } }, { "$group" : { "_id" : "$d", "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "h" : { "$sum" : "$h" }, "l" : { "$sum" : "$l" }, "k" : { "$sum" : "$k" }, "c" : { "$sum" : "$c" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$project" : { "c" : 0, "g" : 0, "w" : 0 } } ]


Query 8 (with useIndex=false): [ { "$project" : { "f" : 0, "l" : 0 } }, { "$addFields" : { "b" : "$n", "f" : "$d", "h" : 56, "w" : "$x" } }, { "$addFields" : { "d" : 87, "i" : 68, "h" : "$l", "y" : "$w" } }, { "$addFields" : { "d" : 24, "l" : "$f", "y" : "$x" } } ]

{_id: 1, e: 95, a: 32, d: 24, x: {a: 4, b: 40, c: 0}, g: 26, c: 60, w: {a: 4, b: 40, c: 0}, i: 68, f: 10, y: {a: 4, b: 40, c: 0}, l: 10},
{_id: 2, e: 13, w: {a: 8, b: 71, c: 40}, d: 24, i: 68, c: 32, g: 2, a: 85, x: {a: 8, b: 71, c: 40}, f: 94, y: {a: 8, b: 71, c: 40}, l: 94},
{_id: 3, a: 27, d: 24, x: {a: 19, b: 99, c: 77}, g: 8, c: 77, w: {a: 19, b: 99, c: 77}, i: 68, e: 40, f: 93, y: {a: 19, b: 99, c: 77}, l: 93},
{_id: 4, a: 29, d: 24, x: {a: 81, b: 68, c: 20}, g: 16, c: 87, w: {a: 81, b: 68, c: 20}, i: 68, e: 82, f: 34, y: {a: 81, b: 68, c: 20}, l: 34},
{_id: 5, d: 24, x: {a: 75, b: 5, c: 70}, i: 68, g: 15, e: 87, c: 49, a: 89, w: {a: 75, b: 5, c: 70}, f: 7, y: {a: 75, b: 5, c: 70}, l: 7},
{_id: 6, e: 55, d: 24, c: 94, a: 85, x: {a: 59, b: 36, c: 59}, w: {a: 59, b: 36, c: 59}, i: 68, g: 16, f: 54, y: {a: 59, b: 36, c: 59}, l: 54},
{_id: 7, w: {a: 47, b: 88, c: 40}, d: 24, x: {a: 47, b: 88, c: 40}, i: 68, g: 66, e: 78, c: 11, a: 85, f: 65, y: {a: 47, b: 88, c: 40}, l: 65},
{_id: 8, g: 62, c: 24, w: {a: 9, b: 4, c: 79}, i: 68, e: 63, a: 75, d: 24, x: {a: 9, b: 4, c: 79}, f: 92, y: {a: 9, b: 4, c: 79}, l: 92}

Query 9 (with useIndex=false): [ { "$group" : { "_id" : "$a", "l" : { "$sum" : "$l" }, "d" : { "$sum" : "$d" }, "i" : { "$sum" : "$i" }, "c" : { "$sum" : "$c" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "k" : { "$sum" : "$k" }, "a" : { "$sum" : "$a" }, "h" : { "$sum" : "$h" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$match" : { "f" : { "$lte" : 99 } } }, { "$addFields" : { "e" : 31, "i" : 17, "f" : 92 } }, { "$addFields" : { "g" : 34 } }, { "$addFields" : { "d" : 57, "k" : 43, "i" : 36, "y" : "$w" } }, { "$addFields" : { "b" : 20, "d" : 54, "x" : "$x" } } ]


Query 10 (with useIndex=false): [ { "$match" : { "d" : { "$gt" : 9 } } }, { "$addFields" : { "a" : 88, "w" : "$w" } }, { "$addFields" : { "k" : 49, "b" : 14, "y" : "$x" } }, { "$addFields" : { "l" : "$o", "w" : "$w" } }, { "$match" : { "e" : { "$lt" : 86 } } }, { "$project" : { "e" : 1, "k" : 1, "h" : 1, "j" : 1, "b" : 1, "c" : "$h", "a" : 1, "g" : 1, "x" : 1 } }, { "$group" : { "_id" : "$b", "g" : { "$sum" : "$g" }, "c" : { "$sum" : "$c" }, "d" : { "$sum" : "$d" }, "a" : { "$sum" : "$a" }, "k" : { "$sum" : "$k" }, "j" : { "$sum" : "$j" }, "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "e" : { "$sum" : "$e" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$match" : { "k" : { "$lt" : 81 } } }, { "$project" : { "a" : 0, "y" : 0 } }, { "$match" : { "j" : { "$gt" : 11 } } }, { "$group" : { "_id" : "$g", "a" : { "$sum" : "$a" }, "c" : { "$sum" : "$c" }, "e" : { "$sum" : "$e" }, "l" : { "$sum" : "$l" }, "i" : { "$sum" : "$i" }, "k" : { "$sum" : "$k" }, "h" : { "$sum" : "$h" }, "d" : { "$sum" : "$d" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$project" : { "d" : 1, "g" : 1, "b" : 1, "a" : 1, "c" : 1, "i" : 1, "f" : 1, "k" : 1, "l" : 1, "h" : "$g", "y" : 1 } } ]


Query 11 (with useIndex=false): [ { "$addFields" : { "b" : 51, "j" : 57, "c" : 68 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$group" : { "_id" : "$a", "g" : { "$sum" : "$g" }, "h" : { "$sum" : "$h" }, "e" : { "$sum" : "$e" }, "f" : { "$sum" : "$f" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "j" : { "$sum" : "$j" }, "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "k" : { "$sum" : "$k" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$project" : { "l" : 0, "a" : 0, "y" : 0 } }, { "$match" : { "l" : { "$gt" : 13 } } } ]


Query 12 (with useIndex=false): [ { "$group" : { "_id" : "$d", "b" : { "$sum" : "$b" }, "i" : { "$sum" : "$i" }, "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "l" : { "$sum" : "$l" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "e" : { "$sum" : "$e" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$addFields" : { "l" : 31, "e" : 39 } }, { "$addFields" : { "c" : 31, "b" : 17, "y" : "$x" } }, { "$group" : { "_id" : "$f", "j" : { "$sum" : "$j" }, "h" : { "$sum" : "$h" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "f" : { "$sum" : "$f" }, "e" : { "$sum" : "$e" }, "k" : { "$sum" : "$k" }, "c" : { "$sum" : "$c" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" } } } ]

{_id: 18, j: 0, h: 86, i: 44, l: 31, f: 18, e: 39, k: 0, c: 31, x: {a: 47, b: 88, c: 40}, w: {a: 48, b: 63, c: 47}, y: {a: 47, b: 88, c: 40}},
{_id: 4, j: 0, h: 74, i: 43, l: 31, f: 4, e: 39, k: 0, c: 31, x: {a: 9, b: 4, c: 79}, w: {a: 15, b: 23, c: 89}, y: {a: 9, b: 4, c: 79}},
{_id: 41, j: 0, h: 71, i: 84, l: 31, f: 41, e: 39, k: 0, c: 31, x: {a: 59, b: 36, c: 59}, w: {a: 10, b: 66, c: 62}, y: {a: 59, b: 36, c: 59}},
{_id: 49, j: 0, h: 72, i: 67, l: 31, f: 49, e: 39, k: 0, c: 31, x: {a: 19, b: 99, c: 77}, w: {a: 11, b: 3, c: 9}, y: {a: 19, b: 99, c: 77}},
{_id: 50, j: 0, h: 83, i: 38, l: 31, f: 50, e: 39, k: 0, c: 31, x: {a: 81, b: 68, c: 20}, w: {a: 86, b: 75, c: 3}, y: {a: 81, b: 68, c: 20}},
{_id: 69, j: 0, h: 75, i: 93, l: 31, f: 69, e: 39, k: 0, c: 31, x: {a: 75, b: 5, c: 70}, w: {a: 44, b: 19, c: 96}, y: {a: 75, b: 5, c: 70}},
{_id: 85, j: 0, h: 71, i: 65, l: 31, f: 85, e: 39, k: 0, c: 31, x: {a: 4, b: 40, c: 0}, w: {a: 18, b: 25, c: 26}, y: {a: 4, b: 40, c: 0}},
{_id: 98, j: 0, h: 50, i: 42, l: 31, f: 98, e: 39, k: 0, c: 31, x: {a: 8, b: 71, c: 40}, w: {a: 94, b: 32, c: 58}, y: {a: 8, b: 71, c: 40}}

Query 13 (with useIndex=false): [ { "$addFields" : { "e" : 3, "k" : 18 } }, { "$setWindowFields" : { "partitionBy" : "$j", "sortBy" : { "g" : -1, "_id" : 1 }, "output" : { "j" : { "$sum" : "$j", "window" : { "documents" : [ "unbounded", "current" ] } }, "d" : { "$sum" : "$d", "window" : { "documents" : [ 0, 2 ] } }, "y" : { "$min" : "$y", "window" : { "documents" : [ -2, 2 ] } } } } }, { "$project" : { "g" : 0, "b" : 0 } }, { "$project" : { "f" : 0, "a" : 0, "y" : 0 } } ]

{_id: 1, e: 3, h: 71, d: 98, x: {a: 4, b: 40, c: 0}, c: 60, w: {a: 18, b: 25, c: 26}, i: 65, k: 18, j: 0},
{_id: 2, e: 3, w: {a: 94, b: 32, c: 58}, d: 94, i: 42, c: 32, h: 50, x: {a: 8, b: 71, c: 40}, k: 18, j: 0},
{_id: 3, h: 72, d: 187, x: {a: 19, b: 99, c: 77}, c: 77, w: {a: 11, b: 3, c: 9}, i: 67, e: 3, k: 18, j: 0},
{_id: 4, h: 83, d: 95, x: {a: 81, b: 68, c: 20}, c: 87, w: {a: 86, b: 75, c: 3}, i: 38, e: 3, k: 18, j: 0},
{_id: 5, d: 194, x: {a: 75, b: 5, c: 70}, i: 93, e: 3, c: 49, w: {a: 44, b: 19, c: 96}, h: 75, k: 18, j: 0},
{_id: 6, e: 3, d: 154, c: 94, x: {a: 59, b: 36, c: 59}, w: {a: 10, b: 66, c: 62}, i: 84, h: 71, k: 18, j: 0},
{_id: 7, w: {a: 48, b: 63, c: 47}, h: 86, d: 167, x: {a: 47, b: 88, c: 40}, i: 44, e: 3, c: 11, k: 18, j: 0},
{_id: 8, c: 24, w: {a: 15, b: 23, c: 89}, i: 43, e: 3, h: 74, d: 136, x: {a: 9, b: 4, c: 79}, k: 18, j: 0}

Query 14 (with useIndex=false): [ { "$project" : { "d" : 0, "y" : 0 } }, { "$addFields" : { "d" : 27, "a" : 15, "j" : "$j", "w" : "$y" } }, { "$sort" : { "c" : 1, "f" : 1, "_id" : 1 } }, { "$sort" : { "g" : -1, "e" : -1, "_id" : 1 } } ]

{_id: 1, e: 95, a: 15, h: 71, x: {a: 4, b: 40, c: 0}, g: 26, c: 60, f: 85, b: 64, i: 65, d: 27},
{_id: 2, e: 13, i: 42, c: 32, h: 50, b: 21, g: 2, a: 15, f: 98, x: {a: 8, b: 71, c: 40}, d: 27},
{_id: 3, a: 15, h: 72, x: {a: 19, b: 99, c: 77}, g: 8, c: 77, f: 49, b: 47, i: 67, e: 40, d: 27},
{_id: 4, a: 15, h: 83, x: {a: 81, b: 68, c: 20}, g: 16, c: 87, f: 50, b: 76, i: 38, e: 82, d: 27},
{_id: 5, b: 4, x: {a: 75, b: 5, c: 70}, i: 93, g: 15, e: 87, c: 49, a: 15, h: 75, f: 69, d: 27},
{_id: 6, f: 41, e: 55, c: 94, b: 71, a: 15, x: {a: 59, b: 36, c: 59}, i: 84, h: 71, g: 16, d: 27},
{_id: 7, h: 86, f: 18, b: 40, x: {a: 47, b: 88, c: 40}, i: 44, g: 66, e: 78, c: 11, a: 15, d: 27},
{_id: 8, g: 62, c: 24, f: 4, b: 81, i: 43, e: 63, a: 15, h: 74, x: {a: 9, b: 4, c: 79}, d: 27}

Query 15 (with useIndex=false): [ { "$match" : { "g" : { "$lt" : 78 } } }, { "$match" : { "e" : { "$lt" : 85 } } }, { "$match" : { "f" : { "$gte" : 15 } } }, { "$addFields" : { "a" : 10, "k" : 92, "c" : 29, "w" : "$x" } }, { "$addFields" : { "k" : 89, "l" : 84, "g" : 21 } }, { "$sort" : { "e" : 1, "c" : -1, "_id" : 1 } }, { "$sort" : { "j" : -1, "a" : 1, "_id" : 1 } }, { "$match" : { "a" : { "$gte" : 12 } } }, { "$addFields" : { "l" : "$t", "w" : "$w" } }, { "$project" : { "j" : 0, "i" : 0, "w" : 0 } } ]


Query 16 (with useIndex=false): [ { "$project" : { "k" : 1, "l" : 1, "b" : 1, "j" : "$e", "d" : 1, "a" : 1, "c" : { "$literal" : 47 }, "i" : 1, "h" : { "$literal" : 76 }, "g" : 1, "x" : 1, "y" : 1 } }, { "$addFields" : { "l" : "$g", "x" : "$w" } }, { "$addFields" : { "c" : 11, "j" : "$q", "k" : 3, "y" : "$x" } }, { "$addFields" : { "g" : 64, "l" : 91, "w" : "$y" } }, { "$project" : { "a" : 1, "c" : 1, "d" : 1, "g" : 1, "b" : 1, "e" : 1, "j" : 1, "i" : 1, "y" : 1, "x" : 1 } }, { "$match" : { "b" : { "$lte" : 82 } } }, { "$sort" : { "h" : -1, "_id" : 1 } }, { "$match" : { "d" : { "$gt" : 14 } } }, { "$addFields" : { "k" : "$m", "b" : 18, "y" : "$y" } }, { "$project" : { "c" : 1, "e" : 1, "i" : "$i", "k" : 1, "f" : 1, "a" : 1, "d" : "$a", "b" : "$b", "j" : 1, "l" : { "$literal" : 70 }, "h" : 1, "w" : 1, "y" : 1 } } ]

{_id: 2, a: 85, c: 11, i: 42, d: 85, b: 18, l: 70},
{_id: 3, a: 27, c: 11, i: 67, d: 27, b: 18, l: 70},
{_id: 4, a: 29, c: 11, i: 38, d: 29, b: 18, l: 70},
{_id: 6, a: 85, c: 11, i: 84, d: 85, b: 18, l: 70},
{_id: 7, a: 85, c: 11, i: 44, d: 85, b: 18, l: 70},
{_id: 8, a: 75, c: 11, i: 43, d: 75, b: 18, l: 70}

Query 17 (with useIndex=false): [ { "$project" : { "d" : 0, "e" : 0, "x" : 0 } }, { "$match" : { "k" : { "$lt" : 81 } } }, { "$project" : { "k" : "$i", "l" : 1, "d" : "$d", "a" : 1, "g" : 1, "c" : { "$literal" : 26 }, "h" : { "$literal" : 5 }, "i" : 1, "f" : 1, "j" : "$h", "w" : 1 } }, { "$project" : { "g" : 0, "j" : 0, "x" : 0 } }, { "$addFields" : { "h" : 32, "b" : "$p" } }, { "$sort" : { "d" : -1, "i" : 1, "_id" : 1 } }, { "$project" : { "e" : 0, "y" : 0 } }, { "$match" : { "k" : { "$gte" : 23 } } } ]


Query 18 (with useIndex=false): [ { "$addFields" : { "d" : "$s", "j" : 46 } }, { "$project" : { "l" : 0, "c" : 0 } }, { "$project" : { "l" : 0 } }, { "$match" : { "l" : { "$lt" : 93 } } }, { "$project" : { "k" : 1, "j" : 1, "c" : 1, "l" : 1, "b" : 1, "e" : 1, "g" : "$k", "d" : 1, "w" : 1 } }, { "$project" : { "c" : 0 } }, { "$project" : { "g" : 0, "d" : 0 } } ]


Query 19 (with useIndex=false): [ { "$match" : { "i" : { "$lte" : 96 } } }, { "$project" : { "i" : 0, "d" : 0, "y" : 0 } }, { "$sort" : { "c" : 1, "_id" : 1 } }, { "$addFields" : { "l" : 45, "f" : 43, "y" : "$y" } }, { "$group" : { "_id" : "$g", "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "c" : { "$sum" : "$c" }, "e" : { "$sum" : "$e" }, "d" : { "$sum" : "$d" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$project" : { "d" : 0, "w" : 0 } }, { "$match" : { "f" : { "$gte" : 8 } } }, { "$addFields" : { "g" : 41 } }, { "$project" : { "l" : 0, "x" : 0 } }, { "$addFields" : { "b" : "$f", "i" : 33, "g" : 30 } } ]


Query 20 (with useIndex=false): [ { "$addFields" : { "h" : "$p", "j" : 35, "g" : 83 } }, { "$sort" : { "k" : -1, "_id" : 1 } }, { "$match" : { "j" : { "$lte" : 84 } } }, { "$match" : { "b" : { "$lte" : 91 } } }, { "$project" : { "i" : 0, "f" : 0 } }, { "$sort" : { "e" : 1, "l" : 1, "_id" : 1 } }, { "$group" : { "_id" : "$b", "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "e" : { "$sum" : "$e" }, "h" : { "$sum" : "$h" }, "b" : { "$sum" : "$b" }, "d" : { "$sum" : "$d" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" } } } ]

{_id: 21, j: 35, k: 0, i: 0, l: 0, e: 13, h: 0, b: 21, d: 94, x: {a: 8, b: 71, c: 40}, w: {a: 94, b: 32, c: 58}, y: null},
{_id: 4, j: 35, k: 0, i: 0, l: 0, e: 87, h: 0, b: 4, d: 7, x: {a: 75, b: 5, c: 70}, w: {a: 44, b: 19, c: 96}, y: null},
{_id: 40, j: 35, k: 0, i: 0, l: 0, e: 78, h: 0, b: 40, d: 65, x: {a: 47, b: 88, c: 40}, w: {a: 48, b: 63, c: 47}, y: null},
{_id: 47, j: 35, k: 0, i: 0, l: 0, e: 40, h: 0, b: 47, d: 93, x: {a: 19, b: 99, c: 77}, w: {a: 11, b: 3, c: 9}, y: null},
{_id: 64, j: 35, k: 0, i: 0, l: 0, e: 95, h: 0, b: 64, d: 10, x: {a: 4, b: 40, c: 0}, w: {a: 18, b: 25, c: 26}, y: null},
{_id: 71, j: 35, k: 0, i: 0, l: 0, e: 55, h: 0, b: 71, d: 54, x: {a: 59, b: 36, c: 59}, w: {a: 10, b: 66, c: 62}, y: null},
{_id: 76, j: 35, k: 0, i: 0, l: 0, e: 82, h: 0, b: 76, d: 34, x: {a: 81, b: 68, c: 20}, w: {a: 86, b: 75, c: 3}, y: null},
{_id: 81, j: 35, k: 0, i: 0, l: 0, e: 63, h: 0, b: 81, d: 92, x: {a: 9, b: 4, c: 79}, w: {a: 15, b: 23, c: 89}, y: null}

Query 21 (with useIndex=false): [ { "$group" : { "_id" : "$d", "e" : { "$sum" : "$e" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "f" : { "$sum" : "$f" }, "d" : { "$sum" : "$d" }, "c" : { "$sum" : "$c" }, "b" : { "$sum" : "$b" }, "k" : { "$sum" : "$k" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$sort" : { "a" : 1, "h" : 1, "_id" : 1 } }, { "$group" : { "_id" : "$i", "e" : { "$sum" : "$e" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "c" : { "$sum" : "$c" }, "f" : { "$sum" : "$f" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$group" : { "_id" : "$k", "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "g" : { "$sum" : "$g" }, "k" : { "$sum" : "$k" }, "e" : { "$sum" : "$e" }, "f" : { "$sum" : "$f" }, "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "b" : { "$sum" : "$b" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } } ]

{_id: null, l: 0, a: 507, g: 0, k: 0, e: 513, f: 414, h: 0, j: 0, b: 404, y: null, x: {a: 4, b: 40, c: 0}, w: {a: 10, b: 66, c: 62}}

Query 22 (with useIndex=false): [ { "$group" : { "_id" : "$b", "i" : { "$sum" : "$i" }, "h" : { "$sum" : "$h" }, "b" : { "$sum" : "$b" }, "d" : { "$sum" : "$d" }, "c" : { "$sum" : "$c" }, "e" : { "$sum" : "$e" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$addFields" : { "j" : "$n", "a" : "$g", "x" : "$w" } }, { "$project" : { "g" : 1, "c" : 1, "f" : 1, "b" : 1, "a" : 1, "d" : 1, "j" : "$a", "l" : "$a", "w" : 1, "y" : 1 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$addFields" : { "e" : 76, "d" : 53 } } ]

{_id: 4, b: 4, d: 53, c: 49, g: 15, y: {_id: 4, b: 16, c: 7, a: 60}, w: {a: 44, b: 19, c: 96}, a: 15, j: 15, l: 15, e: 76}

Query 23 (with useIndex=false): [ { "$addFields" : { "e" : "$f" } }, { "$match" : { "c" : { "$lte" : 79 } } }, { "$setWindowFields" : { "partitionBy" : "$e", "sortBy" : { "f" : 1, "_id" : 1 }, "output" : { "b" : { "$sum" : "$b", "window" : { "documents" : [ "current", "unbounded" ] } }, "w" : { "$min" : "$w", "window" : { "documents" : [ -2, 0 ] } } } } }, { "$sort" : { "j" : -1, "b" : -1, "_id" : 1 } }, { "$setWindowFields" : { "partitionBy" : "$h", "sortBy" : { "i" : -1, "k" : -1, "_id" : 1 }, "output" : { "d" : { "$sum" : "$d", "window" : { "documents" : [ "unbounded", "current" ] } } } } }, { "$sort" : { "j" : -1, "_id" : 1 } }, { "$project" : { "e" : "$f", "d" : "$h", "i" : "$l", "b" : 1, "g" : { "$literal" : 23 }, "c" : 1, "l" : 1, "j" : { "$literal" : 48 }, "x" : 1, "w" : 1 } }, { "$match" : { "b" : { "$lt" : 84 } } }, { "$project" : { "g" : 0 } }, { "$group" : { "_id" : "$a", "c" : { "$sum" : "$c" }, "g" : { "$sum" : "$g" }, "e" : { "$sum" : "$e" }, "h" : { "$sum" : "$h" }, "d" : { "$sum" : "$d" }, "k" : { "$sum" : "$k" }, "i" : { "$sum" : "$i" }, "f" : { "$sum" : "$f" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } } ]

{_id: null, c: 253, g: 0, e: 323, h: 0, d: 428, k: 0, i: 0, f: 0, l: 0, a: 0, b: 257, x: {a: 4, b: 40, c: 0}, y: null, w: {a: 11, b: 3, c: 9}}

Query 24 (with useIndex=false): [ { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$match" : { "d" : { "$lte" : 82 } } }, { "$addFields" : { "c" : "$k" } }, { "$addFields" : { "b" : "$q", "y" : "$y" } }, { "$project" : { "f" : 0, "x" : 0 } }, { "$addFields" : { "c" : 35, "f" : 44 } }, { "$group" : { "_id" : "$b", "a" : { "$sum" : "$a" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "c" : { "$sum" : "$c" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "f" : { "$sum" : "$f" }, "h" : { "$sum" : "$h" }, "e" : { "$sum" : "$e" }, "j" : { "$sum" : "$j" }, "d" : { "$sum" : "$d" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" } } } ]

{_id: null, a: 320, i: 324, l: 0, c: 175, b: 0, g: 139, f: 220, h: 386, e: 397, j: 0, d: 170, w: {_id: 1, b: 57, c: 58, a: 41}, x: null, y: null}

Query 25 (with useIndex=false): [ { "$addFields" : { "b" : "$j", "f" : 7 } }, { "$sort" : { "f" : -1, "_id" : 1 } }, { "$setWindowFields" : { "partitionBy" : "$d", "sortBy" : { "e" : -1, "i" : -1, "_id" : 1 }, "output" : { "e" : { "$sum" : "$e", "window" : { "documents" : [ "unbounded", "unbounded" ] } } } } }, { "$setWindowFields" : { "partitionBy" : "$c", "sortBy" : { "g" : 1, "_id" : 1 }, "output" : { "g" : { "$sum" : "$g", "window" : { "documents" : [ "unbounded", "current" ] } }, "x" : { "$min" : "$x", "window" : { "documents" : [ "unbounded", "unbounded" ] } } } } }, { "$sort" : { "d" : 1, "j" : -1, "_id" : 1 } }, { "$project" : { "e" : 0, "w" : 0 } }, { "$sort" : { "e" : 1, "_id" : 1 } }, { "$limit" : 7 }, { "$match" : { "k" : { "$gt" : 0 } } }, { "$addFields" : { "d" : 28, "k" : 82, "e" : 5 } }, { "$sort" : { "b" : -1, "_id" : 1 } }, { "$limit" : 9 } ]


Query 26 (with useIndex=false): [ { "$match" : { "i" : { "$lte" : 96 } } }, { "$addFields" : { "i" : "$f", "y" : "$y" } }, { "$project" : { "c" : 0, "d" : 0, "y" : 0 } }, { "$addFields" : { "e" : 34, "i" : "$h", "k" : 21 } }, { "$project" : { "f" : 0 } }, { "$addFields" : { "f" : 48 } }, { "$addFields" : { "l" : 72, "b" : "$c", "x" : "$y" } }, { "$project" : { "j" : 0, "x" : 0 } }, { "$addFields" : { "g" : 59, "x" : "$x" } } ]

{_id: 1, e: 34, a: 32, h: 71, g: 59, w: {a: 18, b: 25, c: 26}, i: 71, k: 21, f: 48, l: 72},
{_id: 2, e: 34, w: {a: 94, b: 32, c: 58}, i: 50, h: 50, g: 59, a: 85, k: 21, f: 48, l: 72},
{_id: 3, a: 27, h: 72, g: 59, w: {a: 11, b: 3, c: 9}, i: 72, e: 34, k: 21, f: 48, l: 72},
{_id: 4, a: 29, h: 83, g: 59, w: {a: 86, b: 75, c: 3}, i: 83, e: 34, k: 21, f: 48, l: 72},
{_id: 5, i: 75, g: 59, e: 34, a: 89, w: {a: 44, b: 19, c: 96}, h: 75, k: 21, f: 48, l: 72},
{_id: 6, e: 34, a: 85, w: {a: 10, b: 66, c: 62}, i: 71, h: 71, g: 59, k: 21, f: 48, l: 72},
{_id: 7, w: {a: 48, b: 63, c: 47}, h: 86, i: 86, g: 59, e: 34, a: 85, k: 21, f: 48, l: 72},
{_id: 8, g: 59, w: {a: 15, b: 23, c: 89}, i: 74, e: 34, a: 75, h: 74, k: 21, f: 48, l: 72}

Query 27 (with useIndex=false): [ { "$addFields" : { "j" : 79, "i" : "$a", "e" : 93 } }, { "$addFields" : { "h" : 64, "f" : 24, "l" : 31, "x" : "$y" } }, { "$project" : { "j" : 0, "d" : 0, "x" : 0 } }, { "$addFields" : { "l" : 29, "c" : "$b", "k" : 34, "w" : "$w" } } ]

{_id: 1, e: 93, a: 32, h: 64, g: 26, c: 64, w: {a: 18, b: 25, c: 26}, f: 24, b: 64, i: 32, l: 29, k: 34},
{_id: 2, e: 93, w: {a: 94, b: 32, c: 58}, i: 85, c: 21, h: 64, b: 21, g: 2, a: 85, f: 24, l: 29, k: 34},
{_id: 3, a: 27, h: 64, g: 8, c: 47, w: {a: 11, b: 3, c: 9}, f: 24, b: 47, i: 27, e: 93, l: 29, k: 34},
{_id: 4, a: 29, h: 64, g: 16, c: 76, w: {a: 86, b: 75, c: 3}, f: 24, b: 76, i: 29, e: 93, l: 29, k: 34},
{_id: 5, b: 4, i: 89, g: 15, e: 93, c: 4, a: 89, w: {a: 44, b: 19, c: 96}, h: 64, f: 24, l: 29, k: 34},
{_id: 6, f: 24, e: 93, c: 71, b: 71, a: 85, w: {a: 10, b: 66, c: 62}, i: 85, h: 64, g: 16, l: 29, k: 34},
{_id: 7, w: {a: 48, b: 63, c: 47}, h: 64, f: 24, b: 40, i: 85, g: 66, e: 93, c: 40, a: 85, l: 29, k: 34},
{_id: 8, g: 62, c: 81, w: {a: 15, b: 23, c: 89}, f: 24, b: 81, i: 75, e: 93, a: 75, h: 64, l: 29, k: 34}

Query 28 (with useIndex=false): [ { "$addFields" : { "i" : 46, "y" : "$y" } }, { "$match" : { "f" : { "$lt" : 75 } } }, { "$project" : { "j" : 1, "b" : "$j", "e" : "$k", "l" : 1, "f" : 1, "d" : 1, "g" : "$j", "c" : 1, "i" : 1, "h" : 1, "w" : 1, "x" : 1 } }, { "$sort" : { "j" : -1, "_id" : 1 } }, { "$sort" : { "i" : -1, "_id" : 1 } }, { "$sort" : { "k" : 1, "c" : 1, "_id" : 1 } }, { "$match" : { "i" : { "$gt" : 3 } } }, { "$sort" : { "c" : -1, "b" : -1, "_id" : 1 } }, { "$addFields" : { "d" : 11, "y" : "$x" } }, { "$match" : { "l" : { "$lte" : 88 } } } ]


Query 29 (with useIndex=false): [ { "$sort" : { "g" : -1, "_id" : 1 } }, { "$project" : { "c" : 1, "j" : { "$literal" : 50 }, "g" : 1, "e" : 1, "h" : "$i", "f" : { "$literal" : 35 }, "i" : 1, "l" : 1, "x" : 1, "y" : 1 } }, { "$sort" : { "b" : -1, "_id" : 1 } }, { "$addFields" : { "b" : 98, "l" : 56, "a" : 48 } }, { "$match" : { "d" : { "$lte" : 79 } } }, { "$project" : { "g" : 1, "b" : 1, "k" : "$d", "h" : 1, "e" : 1, "f" : "$j", "l" : 1, "c" : 1, "j" : 1, "d" : 1, "i" : 1, "y" : 1, "x" : 1 } }, { "$project" : { "h" : 1, "k" : "$j", "e" : 1, "g" : 1, "l" : 1, "c" : "$g", "i" : 1, "b" : 1, "y" : 1, "w" : 1 } } ]


Query 30 (with useIndex=false): [ { "$addFields" : { "l" : 30 } }, { "$match" : { "c" : { "$gte" : 11 } } }, { "$addFields" : { "d" : 19 } }, { "$addFields" : { "f" : 27, "d" : 42, "k" : 7, "x" : "$w" } }, { "$setWindowFields" : { "partitionBy" : "$a", "sortBy" : { "c" : -1, "i" : -1, "_id" : 1 }, "output" : { "f" : { "$sum" : "$f", "window" : { "documents" : [ "unbounded", "current" ] } }, "d" : { "$sum" : "$d", "window" : { "documents" : [ -2, 0 ] } } } } }, { "$addFields" : { "a" : 43, "w" : "$x" } }, { "$project" : { "f" : 0, "a" : 0, "y" : 0 } }, { "$setWindowFields" : { "partitionBy" : "$f", "sortBy" : { "j" : -1, "_id" : 1 }, "output" : { "i" : { "$sum" : "$i", "window" : { "documents" : [ -2, 2 ] } } } } } ]

{_id: 1, e: 95, h: 71, d: 42, x: {a: 18, b: 25, c: 26}, g: 26, c: 60, w: {a: 18, b: 25, c: 26}, b: 64, i: 174, l: 30, k: 7},
{_id: 2, e: 13, w: {a: 94, b: 32, c: 58}, d: 84, i: 212, c: 32, h: 50, b: 21, g: 2, x: {a: 94, b: 32, c: 58}, l: 30, k: 7},
{_id: 3, h: 72, d: 42, x: {a: 11, b: 3, c: 9}, g: 8, c: 77, w: {a: 11, b: 3, c: 9}, b: 47, i: 305, e: 40, l: 30, k: 7},
{_id: 4, h: 83, d: 42, x: {a: 86, b: 75, c: 3}, g: 16, c: 87, w: {a: 86, b: 75, c: 3}, b: 76, i: 324, e: 82, l: 30, k: 7},
{_id: 5, d: 42, b: 4, x: {a: 44, b: 19, c: 96}, i: 326, g: 15, e: 87, c: 49, w: {a: 44, b: 19, c: 96}, h: 75, l: 30, k: 7},
{_id: 6, e: 55, d: 42, c: 94, b: 71, x: {a: 10, b: 66, c: 62}, w: {a: 10, b: 66, c: 62}, i: 302, h: 71, g: 16, l: 30, k: 7},
{_id: 7, w: {a: 48, b: 63, c: 47}, h: 86, d: 126, b: 40, x: {a: 48, b: 63, c: 47}, i: 264, g: 66, e: 78, c: 11, l: 30, k: 7},
{_id: 8, g: 62, c: 24, w: {a: 15, b: 23, c: 89}, b: 81, i: 171, e: 63, h: 74, d: 42, x: {a: 15, b: 23, c: 89}, l: 30, k: 7}

Query 31 (with useIndex=false): [ { "$group" : { "_id" : "$a", "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "f" : { "$sum" : "$f" }, "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "i" : { "$sum" : "$i" }, "d" : { "$sum" : "$d" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "c" : { "$sum" : "$c" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "g" : "$s", "k" : "$f", "b" : "$k", "y" : "$x" } }, { "$addFields" : { "c" : "$q", "f" : 50, "x" : "$x" } }, { "$project" : { "b" : 0, "i" : 0, "w" : 0 } }, { "$group" : { "_id" : "$i", "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "a" : { "$sum" : "$a" }, "k" : { "$sum" : "$k" }, "f" : { "$sum" : "$f" }, "h" : { "$sum" : "$h" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "e" : { "$sum" : "$e" }, "c" : { "$sum" : "$c" }, "b" : { "$sum" : "$b" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$addFields" : { "i" : "$r", "l" : 21 } }, { "$addFields" : { "l" : "$l", "g" : "$t", "f" : "$i", "w" : "$x" } }, { "$match" : { "c" : { "$lt" : 91 } } }, { "$addFields" : { "c" : "$c", "b" : "$d", "i" : 52 } }, { "$addFields" : { "i" : 96, "f" : 60, "c" : 1, "w" : "$y" } } ]

{_id: null, d: 449, a: 507, k: 414, h: 582, l: 21, e: 0, c: 1, b: 449, w: {a: 4, b: 40, c: 0}, y: {a: 4, b: 40, c: 0}, x: {a: 4, b: 40, c: 0}, i: 96, f: 60}

Query 32 (with useIndex=false): [ { "$group" : { "_id" : "$a", "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "j" : { "$sum" : "$j" }, "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "i" : { "$sum" : "$i" }, "k" : { "$sum" : "$k" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" } } }, { "$sort" : { "k" : 1, "_id" : 1 } }, { "$sort" : { "g" : 1, "_id" : 1 } }, { "$project" : { "b" : 0, "c" : 0 } }, { "$group" : { "_id" : "$k", "f" : { "$sum" : "$f" }, "e" : { "$sum" : "$e" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "h" : { "$sum" : "$h" }, "l" : { "$sum" : "$l" }, "i" : { "$sum" : "$i" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "k" : { "$sum" : "$k" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$match" : { "g" : { "$gt" : 0 } } }, { "$match" : { "d" : { "$lte" : 98 } } }, { "$match" : { "j" : { "$lte" : 94 } } } ]


Query 33 (with useIndex=false): [ { "$match" : { "l" : { "$lt" : 81 } } }, { "$addFields" : { "c" : "$a", "a" : 14 } }, { "$match" : { "i" : { "$lt" : 91 } } }, { "$project" : { "a" : 0, "g" : 0, "x" : 0 } }, { "$addFields" : { "g" : 9, "d" : "$i", "j" : 84 } }, { "$match" : { "k" : { "$lte" : 77 } } }, { "$sort" : { "j" : 1, "i" : 1, "_id" : 1 } }, { "$limit" : 7 }, { "$sort" : { "e" : -1, "h" : -1, "_id" : 1 } }, { "$limit" : 8 }, { "$group" : { "_id" : "$g", "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "k" : { "$sum" : "$k" }, "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "l" : { "$sum" : "$l" }, "i" : { "$sum" : "$i" }, "a" : { "$sum" : "$a" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$match" : { "a" : { "$gte" : 1 } } }, { "$sort" : { "i" : -1, "d" : 1, "_id" : 1 } }, { "$limit" : 7 }, { "$match" : { "j" : { "$lte" : 80 } } } ]


Query 34 (with useIndex=false): [ { "$match" : { "i" : { "$lt" : 94 } } }, { "$addFields" : { "k" : "$r", "b" : 34, "i" : 5 } }, { "$group" : { "_id" : "$e", "k" : { "$sum" : "$k" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "b" : { "$sum" : "$b" }, "c" : { "$sum" : "$c" }, "a" : { "$sum" : "$a" }, "e" : { "$sum" : "$e" }, "l" : { "$sum" : "$l" }, "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$match" : { "d" : { "$lte" : 79 } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$project" : { "b" : { "$literal" : 39 }, "h" : 1, "d" : 1, "k" : "$f", "e" : 1, "f" : 1, "j" : 1, "g" : 1, "a" : "$k", "l" : 1, "y" : 1 } }, { "$project" : { "b" : 0 } }, { "$sort" : { "c" : 1, "_id" : 1 } }, { "$limit" : 8 }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$project" : { "b" : 0, "j" : 0, "w" : 0 } } ]


Query 35 (with useIndex=false): [ { "$project" : { "a" : 0, "d" : 0 } }, { "$setWindowFields" : { "partitionBy" : "$a", "sortBy" : { "d" : 1, "c" : 1, "_id" : 1 }, "output" : { "l" : { "$sum" : "$l", "window" : { "documents" : [ "current", "unbounded" ] } }, "w" : { "$min" : "$w", "window" : { "documents" : [ -2, 0 ] } } } } }, { "$addFields" : { "j" : 96, "w" : "$w" } }, { "$project" : { "i" : 1, "l" : "$a", "b" : 1, "f" : "$k", "d" : 1, "e" : 1, "k" : 1, "j" : 1, "h" : 1, "a" : "$e", "c" : "$h", "w" : 1 } }, { "$project" : { "h" : 0, "w" : 0 } }, { "$project" : { "b" : "$k", "h" : "$k", "g" : { "$literal" : 23 }, "d" : 1, "i" : "$k", "c" : "$h", "j" : 1, "k" : 1, "e" : 1, "y" : 1 } }, { "$group" : { "_id" : "$g", "d" : { "$sum" : "$d" }, "c" : { "$sum" : "$c" }, "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "j" : { "$sum" : "$j" }, "h" : { "$sum" : "$h" }, "g" : { "$sum" : "$g" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "i" : 65, "w" : "$y" } }, { "$addFields" : { "f" : 62, "i" : 8, "e" : 95, "w" : "$w" } } ]

{_id: 23, d: 0, c: 0, b: 0, e: 95, k: 0, l: 0, j: 768, h: 0, g: 184, y: null, x: null, w: null, i: 8, f: 62}

Query 36 (with useIndex=false): [ { "$match" : { "b" : { "$gte" : 20 } } }, { "$addFields" : { "c" : "$f", "i" : 95, "h" : 25 } }, { "$group" : { "_id" : "$f", "e" : { "$sum" : "$e" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "i" : { "$sum" : "$i" }, "j" : { "$sum" : "$j" }, "g" : { "$sum" : "$g" }, "b" : { "$sum" : "$b" }, "f" : { "$sum" : "$f" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" } } }, { "$project" : { "g" : 1, "a" : "$i", "d" : 1, "f" : 1, "e" : 1, "b" : 1, "h" : "$c", "j" : 1, "k" : 1, "w" : 1 } }, { "$match" : { "e" : { "$lte" : 91 } } } ]

{_id: 18, e: 78, k: 0, d: 65, j: 0, g: 66, b: 40, f: 18, w: {a: 48, b: 63, c: 47}, a: 95},
{_id: 4, e: 63, k: 0, d: 92, j: 0, g: 62, b: 81, f: 4, w: {a: 15, b: 23, c: 89}, a: 95},
{_id: 41, e: 55, k: 0, d: 54, j: 0, g: 16, b: 71, f: 41, w: {a: 10, b: 66, c: 62}, a: 95},
{_id: 49, e: 40, k: 0, d: 93, j: 0, g: 8, b: 47, f: 49, w: {a: 11, b: 3, c: 9}, a: 95},
{_id: 50, e: 82, k: 0, d: 34, j: 0, g: 16, b: 76, f: 50, w: {a: 86, b: 75, c: 3}, a: 95},
{_id: 98, e: 13, k: 0, d: 94, j: 0, g: 2, b: 21, f: 98, w: {a: 94, b: 32, c: 58}, a: 95}

Query 37 (with useIndex=false): [ { "$setWindowFields" : { "partitionBy" : "$b", "sortBy" : { "f" : 1, "i" : 1, "_id" : 1 }, "output" : { "l" : { "$sum" : "$l", "window" : { "documents" : [ -2, 2 ] } }, "h" : { "$sum" : "$h", "window" : { "documents" : [ "current", "unbounded" ] } }, "x" : { "$min" : "$x", "window" : { "documents" : [ -2, 0 ] } } } } }, { "$addFields" : { "d" : 22, "i" : 22, "k" : 15 } }, { "$addFields" : { "a" : 90 } }, { "$setWindowFields" : { "partitionBy" : "$h", "sortBy" : { "j" : -1, "g" : 1, "_id" : 1 }, "output" : { "i" : { "$sum" : "$i", "window" : { "documents" : [ "current", "unbounded" ] } }, "w" : { "$min" : "$w", "window" : { "documents" : [ 0, 2 ] } } } } }, { "$addFields" : { "c" : 3, "g" : 63, "w" : "$y" } }, { "$project" : { "l" : 0, "e" : 0 } }, { "$match" : { "y.a" : { "$gt" : 22 } } }, { "$addFields" : { "k" : "$h", "e" : "$s", "b" : 20, "w.b" : 51, "w.a" : 9 } }, { "$match" : { "y.c" : { "$lt" : 97 } } }, { "$match" : { "k" : { "$gte" : 7 } } }, { "$project" : { "k" : 0 } } ]


Query 38 (with useIndex=false): [ { "$addFields" : { "i" : 28, "x" : "$x" } }, { "$project" : { "d" : 0 } }, { "$project" : { "g" : 0, "f" : 0 } }, { "$addFields" : { "h" : "$s", "i" : "$j", "y.b" : 15, "y.c" : 74 } }, { "$project" : { "j" : 0, "a" : 0, "x.a" : 0, "x.c" : 0 } }, { "$addFields" : { "d" : 39, "l" : 88, "y.a" : 48 } }, { "$addFields" : { "l" : "$d", "j" : "$m", "a" : 96 } }, { "$project" : { "k" : 0 } }, { "$addFields" : { "f" : "$s", "d" : "$g", "w" : "$w" } }, { "$match" : { "x.a" : { "$lte" : 82 } } } ]


Query 39 (with useIndex=false): [ { "$match" : { "g" : { "$gte" : 24 } } }, { "$project" : { "d" : 0, "b" : 0 } }, { "$project" : { "k" : 0 } }, { "$addFields" : { "l" : 7, "d" : 89, "a" : 78, "y" : "$w" } }, { "$project" : { "l" : 0, "w.c" : 0 } }, { "$project" : { "f" : 0, "y.a" : 0, "y.b" : 0 } }, { "$addFields" : { "b" : 24, "h" : "$h" } }, { "$project" : { "c" : 0, "w" : 0 } }, { "$project" : { "d" : 0, "a" : 0 } }, { "$addFields" : { "h" : 22, "j" : 83, "d" : "$r", "y" : "$w" } }, { "$addFields" : { "c" : "$n", "h" : 68, "w" : "$w" } }, { "$addFields" : { "a" : "$j", "f" : "$t", "w" : "$w" } } ]

{_id: 1, e: 95, h: 68, x: {a: 4, b: 40, c: 0}, g: 26, i: 65, b: 24, j: 83, a: 83},
{_id: 7, h: 68, x: {a: 47, b: 88, c: 40}, i: 44, g: 66, e: 78, b: 24, j: 83, a: 83},
{_id: 8, g: 62, i: 43, e: 63, h: 68, x: {a: 9, b: 4, c: 79}, b: 24, j: 83, a: 83}

Query 40 (with useIndex=false): [ { "$project" : { "g" : 0, "d" : 0, "w" : 0 } }, { "$project" : { "e" : 0 } }, { "$match" : { "d" : { "$gte" : 19 } } }, { "$addFields" : { "j" : "$b" } }, { "$project" : { "k" : 0, "y.a" : 0 } }, { "$project" : { "d" : 0 } }, { "$project" : { "g" : 1, "k" : 1, "j" : 1, "h" : 1, "a" : 1, "d" : 1, "b" : 1, "f" : 1, "c" : 1, "e" : 1, "y.c" : 1, "x.c" : 1 } }, { "$match" : { "h" : { "$lt" : 90 } } }, { "$project" : { "i" : 1, "c" : 1, "e" : 1, "b" : 1, "f" : 1, "a" : 1, "d" : "$e", "l" : 1, "j" : "$f", "y" : 1 } }, { "$addFields" : { "j" : 58, "f" : 94, "d" : "$t" } }, { "$addFields" : { "h" : 88, "l" : 10, "w" : "$x" } } ]


Query 41 (with useIndex=false): [ { "$project" : { "c" : 1, "j" : "$j", "h" : 1, "f" : 1, "a" : "$e", "k" : 1, "b" : 1, "g" : 1, "i" : { "$literal" : 48 }, "e" : 1, "y.b" : 1, "y.c" : 1, "w.a" : 1 } }, { "$project" : { "j" : 0, "d" : 0, "w.b" : 0 } }, { "$match" : { "e" : { "$gte" : 24 } } }, { "$project" : { "f" : 0, "k" : 0, "y.c" : 0 } }, { "$addFields" : { "j" : "$r", "w" : "$w" } }, { "$project" : { "k" : 0, "f" : 0, "x" : 0 } }, { "$addFields" : { "f" : 78, "k" : 82, "y.c" : 0, "y.a" : 30 } }, { "$addFields" : { "f" : 86, "j" : 0, "i" : 1 } }, { "$match" : { "f" : { "$gt" : 1 } } }, { "$addFields" : { "i" : 87, "c" : 90, "x" : "$w" } }, { "$project" : { "b" : 0 } }, { "$addFields" : { "f" : "$q", "w.c" : 22 } } ]

{_id: 1, e: 95, h: 71, g: 26, c: 90, w: {a: 18, c: 22}, a: 95, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 18}},
{_id: 3, h: 72, g: 8, c: 90, w: {a: 11, c: 22}, e: 40, a: 40, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 11}},
{_id: 4, h: 83, g: 16, c: 90, w: {a: 86, c: 22}, e: 82, a: 82, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 86}},
{_id: 5, g: 15, e: 87, c: 90, w: {a: 44, c: 22}, h: 75, a: 87, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 44}},
{_id: 6, e: 55, c: 90, w: {a: 10, c: 22}, h: 71, g: 16, a: 55, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 10}},
{_id: 7, w: {a: 48, c: 22}, h: 86, g: 66, e: 78, c: 90, a: 78, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 48}},
{_id: 8, g: 62, c: 90, w: {a: 15, c: 22}, e: 63, h: 74, a: 63, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 15}}

Query 42 (with useIndex=false): [ { "$addFields" : { "f" : "$o", "y" : "$x" } }, { "$addFields" : { "i" : 31, "h" : 8, "y" : "$w" } }, { "$match" : { "i" : { "$lte" : 77 } } }, { "$match" : { "k" : { "$gt" : 1 } } }, { "$addFields" : { "b" : "$n", "k" : 1, "x.c" : 9 } }, { "$match" : { "i" : { "$lte" : 98 } } }, { "$setWindowFields" : { "partitionBy" : "$j", "sortBy" : { "b" : -1, "_id" : 1 }, "output" : { "h" : { "$sum" : "$h", "window" : { "documents" : [ "unbounded", "unbounded" ] } } } } }, { "$match" : { "l" : { "$gte" : 3 } } }, { "$addFields" : { "c" : "$b", "y" : "$x" } }, { "$match" : { "i" : { "$gte" : 15 } } }, { "$project" : { "g" : 0, "w.b" : 0, "w.a" : 0 } }, { "$addFields" : { "i" : 91, "a" : "$f", "l" : 40 } } ]


Query 43 (with useIndex=false): [ { "$project" : { "d" : 0, "l" : 0, "w.a" : 0, "w.b" : 0 } }, { "$project" : { "g" : 0, "j" : 0 } }, { "$group" : { "_id" : "$i", "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "d" : { "$sum" : "$d" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "l" : { "$sum" : "$l" }, "c" : { "$sum" : "$c" }, "g" : { "$sum" : "$g" }, "e" : { "$sum" : "$e" }, "f" : { "$sum" : "$f" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "i" : "$p" } }, { "$addFields" : { "d" : "$h" } } ]

{_id: 38, h: 83, j: 0, k: 0, d: 83, a: 29, b: 76, l: 0, c: 87, g: 0, e: 82, f: 50, x: {a: 81, b: 68, c: 20}, y: null, w: {c: 3}},
{_id: 42, h: 50, j: 0, k: 0, d: 50, a: 85, b: 21, l: 0, c: 32, g: 0, e: 13, f: 98, x: {a: 8, b: 71, c: 40}, y: null, w: {c: 58}},
{_id: 43, h: 74, j: 0, k: 0, d: 74, a: 75, b: 81, l: 0, c: 24, g: 0, e: 63, f: 4, x: {a: 9, b: 4, c: 79}, y: null, w: {c: 89}},
{_id: 44, h: 86, j: 0, k: 0, d: 86, a: 85, b: 40, l: 0, c: 11, g: 0, e: 78, f: 18, x: {a: 47, b: 88, c: 40}, y: null, w: {c: 47}},
{_id: 65, h: 71, j: 0, k: 0, d: 71, a: 32, b: 64, l: 0, c: 60, g: 0, e: 95, f: 85, x: {a: 4, b: 40, c: 0}, y: null, w: {c: 26}},
{_id: 67, h: 72, j: 0, k: 0, d: 72, a: 27, b: 47, l: 0, c: 77, g: 0, e: 40, f: 49, x: {a: 19, b: 99, c: 77}, y: null, w: {c: 9}},
{_id: 84, h: 71, j: 0, k: 0, d: 71, a: 85, b: 71, l: 0, c: 94, g: 0, e: 55, f: 41, x: {a: 59, b: 36, c: 59}, y: null, w: {c: 62}},
{_id: 93, h: 75, j: 0, k: 0, d: 75, a: 89, b: 4, l: 0, c: 49, g: 0, e: 87, f: 69, x: {a: 75, b: 5, c: 70}, y: null, w: {c: 96}}

Query 44 (with useIndex=false): [ { "$addFields" : { "f" : 3, "b" : "$k", "x" : "$x" } }, { "$addFields" : { "e" : 64, "f" : "$j", "x.c" : 18 } }, { "$addFields" : { "k" : "$o", "j" : "$a", "w" : "$x" } }, { "$group" : { "_id" : "$f", "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "j" : { "$sum" : "$j" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "g" : { "$sum" : "$g" }, "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "f" : { "$sum" : "$f" }, "e" : { "$sum" : "$e" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$group" : { "_id" : "$f", "g" : { "$sum" : "$g" }, "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "b" : { "$sum" : "$b" }, "f" : { "$sum" : "$f" }, "e" : { "$sum" : "$e" }, "l" : { "$sum" : "$l" }, "d" : { "$sum" : "$d" }, "c" : { "$sum" : "$c" }, "a" : { "$sum" : "$a" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" } } }, { "$group" : { "_id" : "$c", "a" : { "$sum" : "$a" }, "i" : { "$sum" : "$i" }, "f" : { "$sum" : "$f" }, "k" : { "$sum" : "$k" }, "d" : { "$sum" : "$d" }, "j" : { "$sum" : "$j" }, "g" : { "$sum" : "$g" }, "e" : { "$sum" : "$e" }, "b" : { "$sum" : "$b" }, "c" : { "$sum" : "$c" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" } } }, { "$addFields" : { "a" : "$o", "k" : 83, "l" : "$m" } }, { "$group" : { "_id" : "$h", "a" : { "$sum" : "$a" }, "g" : { "$sum" : "$g" }, "i" : { "$sum" : "$i" }, "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "e" : { "$sum" : "$e" }, "b" : { "$sum" : "$b" }, "c" : { "$sum" : "$c" }, "d" : { "$sum" : "$d" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$project" : { "h" : 0, "e" : 0 } } ]

{_id: null, a: 0, g: 211, i: 0, j: 507, k: 83, l: 0, b: 0, c: 434, d: 449, w: {a: 4, b: 40, c: 18}, y: null, x: {a: 4, b: 40, c: 18}}

Query 45 (with useIndex=false): [ { "$addFields" : { "i" : 74, "f" : "$n", "c" : 50 } }, { "$project" : { "f" : 0, "g" : 0, "w.a" : 0 } }, { "$match" : { "g" : { "$gte" : 17 } } }, { "$match" : { "i" : { "$lte" : 96 } } }, { "$project" : { "d" : 0, "b" : 0 } }, { "$project" : { "l" : 0 } }, { "$group" : { "_id" : "$b", "d" : { "$sum" : "$d" }, "j" : { "$sum" : "$j" }, "h" : { "$sum" : "$h" }, "e" : { "$sum" : "$e" }, "b" : { "$sum" : "$b" }, "i" : { "$sum" : "$i" }, "a" : { "$sum" : "$a" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "g" : { "$sum" : "$g" }, "f" : { "$sum" : "$f" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" } } }, { "$group" : { "_id" : "$c", "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "c" : { "$sum" : "$c" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "e" : { "$sum" : "$e" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$project" : { "h" : 0, "x" : 0 } }, { "$group" : { "_id" : "$d", "j" : { "$sum" : "$j" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "l" : { "$sum" : "$l" }, "k" : { "$sum" : "$k" }, "h" : { "$sum" : "$h" }, "f" : { "$sum" : "$f" }, "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "e" : { "$sum" : "$e" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "a" : 92, "x.c" : 43, "x.b" : 20 } } ]


Query 46 (with useIndex=false): [ { "$group" : { "_id" : "$a", "g" : { "$sum" : "$g" }, "l" : { "$sum" : "$l" }, "f" : { "$sum" : "$f" }, "d" : { "$sum" : "$d" }, "c" : { "$sum" : "$c" }, "a" : { "$sum" : "$a" }, "i" : { "$sum" : "$i" }, "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$match" : { "a" : { "$gte" : 22 } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$group" : { "_id" : "$e", "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "d" : { "$sum" : "$d" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "g" : { "$sum" : "$g" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$project" : { "b" : 0, "k" : 0, "y" : 0 } }, { "$group" : { "_id" : "$h", "k" : { "$sum" : "$k" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "c" : { "$sum" : "$c" }, "g" : { "$sum" : "$g" }, "e" : { "$sum" : "$e" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" } ]


Query 47 (with useIndex=false): [ { "$project" : { "c" : 0, "h" : 0, "y" : 0 } }, { "$addFields" : { "l" : "$i", "a" : "$e", "i" : 22 } }, { "$setWindowFields" : { "partitionBy" : "$g", "sortBy" : { "k" : 1, "j" : 1, "_id" : 1 }, "output" : { "i" : { "$sum" : "$i", "window" : { "documents" : [ -2, 0 ] } }, "h" : { "$sum" : "$h", "window" : { "documents" : [ -2, 2 ] } } } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$addFields" : { "a" : 9, "i" : 61 } }, { "$addFields" : { "a" : "$r", "l" : "$n", "j" : 61 } } ]

{_id: 1, e: 95, d: 10, x: {a: 4, b: 40, c: 0}, g: 26, w: {_id: 1, b: 57, c: 58, a: 41}, f: 85, b: 64, i: 61, h: 0, j: 61},
{_id: 2, e: 13, w: {_id: 2, b: 12, c: 54, a: 92}, d: 94, i: 61, b: 21, g: 2, f: 98, x: {a: 8, b: 71, c: 40}, h: 0, j: 61},
{_id: 3, d: 93, x: {a: 19, b: 99, c: 77}, g: 8, w: {_id: 3, c: 99, a: 47, b: 57}, f: 49, b: 47, i: 61, e: 40, h: 0, j: 61},
{_id: 4, d: 34, x: {a: 81, b: 68, c: 20}, g: 16, w: {_id: 4, b: 16, c: 7, a: 60}, f: 50, b: 76, i: 61, e: 82, h: 0, j: 61},
{_id: 5, d: 7, b: 4, x: {a: 75, b: 5, c: 70}, i: 61, g: 15, e: 87, w: {_id: 5, a: 16, b: 71, c: 91}, f: 69, h: 0, j: 61},
{_id: 6, f: 41, e: 55, d: 54, b: 71, x: {a: 59, b: 36, c: 59}, w: {_id: 6, c: 78, a: 37, b: 67}, i: 61, g: 16, h: 0, j: 61},
{_id: 7, w: {_id: 7, a: 0, c: 4, b: 1}, f: 18, d: 65, b: 40, x: {a: 47, b: 88, c: 40}, i: 61, g: 66, e: 78, h: 0, j: 61},
{_id: 8, g: 62, w: {_id: 8, a: 14, b: 86, c: 90}, f: 4, b: 81, i: 61, e: 63, d: 92, x: {a: 9, b: 4, c: 79}, h: 0, j: 61}

Query 48 (with useIndex=false): [ { "$project" : { "i" : 1, "f" : "$g", "e" : 1, "d" : 1, "k" : 1, "g" : 1, "b" : "$j", "j" : "$k", "y.a" : 1 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$project" : { "h" : 0, "c" : 0 } }, { "$group" : { "_id" : "$d", "i" : { "$sum" : "$i" }, "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "c" : { "$sum" : "$c" }, "j" : { "$sum" : "$j" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "f" : { "$sum" : "$f" }, "k" : { "$sum" : "$k" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$addFields" : { "i" : 26, "c" : 67, "e" : "$q", "w.b" : 63, "w.a" : 26 } }, { "$addFields" : { "f" : 99, "j" : 31 } }, { "$project" : { "k" : 0, "i" : 0, "y.b" : 0, "y.c" : 0 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$addFields" : { "e" : 17, "f" : 50, "y" : "$w" } }, { "$group" : { "_id" : "$j", "k" : { "$sum" : "$k" }, "g" : { "$sum" : "$g" }, "l" : { "$sum" : "$l" }, "e" : { "$sum" : "$e" }, "c" : { "$sum" : "$c" }, "d" : { "$sum" : "$d" }, "b" : { "$sum" : "$b" }, "a" : { "$sum" : "$a" }, "h" : { "$sum" : "$h" }, "f" : { "$sum" : "$f" }, "j" : { "$sum" : "$j" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$project" : { "f" : 1, "i" : 1, "h" : 1, "e" : 1, "k" : 1, "j" : 1, "a" : 1, "c" : 1, "d" : "$d", "x" : 1 } } ]

{_id: 31, k: 0, e: 17, c: 67, a: 0, h: 0, f: 50, j: 31, x: null, d: 0}

Query 49 (with useIndex=false): [ { "$sort" : { "g" : -1, "_id" : 1 } }, { "$setWindowFields" : { "partitionBy" : "$j", "sortBy" : { "h" : -1, "_id" : 1 }, "output" : { "j" : { "$sum" : "$j", "window" : { "documents" : [ -2, 2 ] } }, "x" : { "$min" : "$x", "window" : { "documents" : [ -2, 2 ] } } } } }, { "$addFields" : { "b" : 42, "c" : 41 } }, { "$match" : { "y.b" : { "$lte" : 84 } } }, { "$project" : { "e" : 0 } }, { "$sort" : { "h" : -1, "_id" : 1 } }, { "$addFields" : { "l" : 99, "g" : "$s", "w.a" : 80, "w.b" : 92 } }, { "$match" : { "w.a" : { "$lt" : 87 } } }, { "$match" : { "w.c" : { "$gt" : 13 } } }, { "$addFields" : { "b" : 15, "e" : "$n", "y" : "$w" } } ]


Query 50 (with useIndex=false): [ { "$sort" : { "l" : -1, "_id" : 1 } }, { "$match" : { "y.b" : { "$lt" : 87 } } }, { "$match" : { "y.c" : { "$lt" : 95 } } }, { "$addFields" : { "i" : 98, "d" : "$d" } } ]


Query 51 (with useIndex=false): [ { "$project" : { "j" : 0, "g" : 0, "y.a" : 0, "y.c" : 0 } }, { "$match" : { "i" : { "$gte" : 11 } } }, { "$project" : { "d" : 0, "k" : 0 } }, { "$addFields" : { "b" : 38, "w" : "$w" } }, { "$match" : { "e" : { "$lte" : 80 } } }, { "$project" : { "e" : 0, "w.a" : 0 } } ]

{_id: 2, w: {b: 32, c: 58}, i: 42, c: 32, h: 50, b: 38, a: 85, f: 98, x: {a: 8, b: 71, c: 40}},
{_id: 3, a: 27, h: 72, x: {a: 19, b: 99, c: 77}, c: 77, w: {b: 3, c: 9}, f: 49, b: 38, i: 67},
{_id: 6, f: 41, c: 94, b: 38, a: 85, x: {a: 59, b: 36, c: 59}, w: {b: 66, c: 62}, i: 84, h: 71},
{_id: 7, w: {b: 63, c: 47}, h: 86, f: 18, b: 38, x: {a: 47, b: 88, c: 40}, i: 44, c: 11, a: 85},
{_id: 8, c: 24, w: {b: 23, c: 89}, f: 4, b: 38, i: 43, a: 75, h: 74, x: {a: 9, b: 4, c: 79}}

Query 52 (with useIndex=false): [ { "$addFields" : { "l" : 99 } }, { "$sort" : { "a" : 1, "_id" : 1 } }, { "$addFields" : { "j" : "$h", "x" : "$y" } }, { "$addFields" : { "h" : 53, "g" : 95, "c" : "$i", "y.a" : 20 } }, { "$addFields" : { "c" : 98, "w" : "$y" } }, { "$project" : { "b" : 1, "i" : 1, "l" : 1, "c" : 1, "e" : 1, "a" : 1, "f" : "$c", "g" : "$c", "j" : 1, "k" : 1, "h" : 1, "y.c" : 1 } }, { "$sort" : { "f" : -1, "_id" : 1 } }, { "$match" : { "x.c" : { "$lte" : 85 } } } ]


Query 53 (with useIndex=false): [ { "$match" : { "y.a" : { "$lt" : 83 } } }, { "$match" : { "c" : { "$gte" : 1 } } }, { "$match" : { "h" : { "$gt" : 15 } } }, { "$addFields" : { "d" : "$p" } }, { "$match" : { "w.c" : { "$gt" : 13 } } }, { "$match" : { "y.a" : { "$lt" : 80 } } }, { "$sort" : { "e" : 1, "_id" : 1 } }, { "$project" : { "a" : "$d", "j" : 1, "l" : 1, "d" : 1, "i" : "$j", "c" : "$h", "k" : 1, "e" : 1, "h" : 1, "b" : 1, "g" : 1, "w.c" : 1, "w.a" : 1 } } ]


Query 54 (with useIndex=false): [ { "$project" : { "d" : 0 } }, { "$sort" : { "f" : -1, "d" : 1, "_id" : 1 } }, { "$setWindowFields" : { "partitionBy" : "$c", "sortBy" : { "e" : -1, "j" : 1, "_id" : 1 }, "output" : { "l" : { "$sum" : "$l", "window" : { "documents" : [ "current", "unbounded" ] } }, "e" : { "$sum" : "$e", "window" : { "documents" : [ "current", "unbounded" ] } } } } }, { "$setWindowFields" : { "partitionBy" : "$e", "sortBy" : { "g" : -1, "_id" : 1 }, "output" : { "e" : { "$sum" : "$e", "window" : { "documents" : [ "unbounded", "current" ] } }, "g" : { "$sum" : "$g", "window" : { "documents" : [ 0, 2 ] } } } } }, { "$project" : { "c" : "$j", "g" : 1, "e" : 1, "f" : 1, "d" : 1, "k" : 1, "a" : 1, "j" : 1, "l" : 1, "i" : 1, "y.c" : 1, "y.a" : 1, "x.a" : 1 } }, { "$addFields" : { "h" : "$s", "x" : "$w" } }, { "$addFields" : { "l" : 52, "h" : 89, "w.a" : 74, "w.c" : 59 } }, { "$setWindowFields" : { "partitionBy" : "$l", "sortBy" : { "f" : 1, "_id" : 1 }, "output" : { "h" : { "$sum" : "$h", "window" : { "documents" : [ "unbounded", "unbounded" ] } }, "x" : { "$min" : "$x", "window" : { "documents" : [ -2, 2 ] } } } } }, { "$sort" : { "e" : 1, "d" : -1, "_id" : 1 } }, { "$project" : { "g" : "$c", "i" : 1, "j" : 1, "c" : 1, "b" : "$d", "f" : "$h", "e" : { "$literal" : 90 }, "h" : 1, "d" : 1, "x.c" : 1, "x.b" : 1, "w.c" : 1, "w.a" : 1 } } ]

{_id: 1, i: 65, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 2, i: 42, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 3, i: 67, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 4, i: 38, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 5, i: 93, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 6, i: 84, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 7, i: 44, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 8, i: 43, h: 712, w: {a: 74, c: 59}, f: 712, e: 90}

Query 55 (with useIndex=false): [ { "$addFields" : { "k" : 93 } }, { "$match" : { "b" : { "$lt" : 80 } } }, { "$addFields" : { "l" : 29, "g" : 86 } }, { "$project" : { "l" : 0, "x" : 0 } }, { "$match" : { "y.c" : { "$gt" : 12 } } }, { "$group" : { "_id" : "$i", "c" : { "$sum" : "$c" }, "i" : { "$sum" : "$i" }, "d" : { "$sum" : "$d" }, "b" : { "$sum" : "$b" }, "k" : { "$sum" : "$k" }, "a" : { "$sum" : "$a" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$match" : { "l" : { "$gt" : 9 } } } ]


Query 56 (with useIndex=false): [ { "$addFields" : { "h" : 78, "d" : "$s", "x.c" : 88, "x.a" : 32 } }, { "$match" : { "w.b" : { "$gt" : 11 } } }, { "$match" : { "g" : { "$gt" : 24 } } }, { "$addFields" : { "i" : "$r", "h" : 68 } }, { "$group" : { "_id" : "$g", "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "d" : { "$sum" : "$d" }, "g" : { "$sum" : "$g" }, "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "c" : { "$sum" : "$c" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } } ]

{_id: 26, b: 64, e: 95, d: 0, g: 26, h: 68, j: 0, i: 0, c: 60, w: {a: 18, b: 25, c: 26}, y: null, x: {a: 32, b: 40, c: 88}},
{_id: 62, b: 81, e: 63, d: 0, g: 62, h: 68, j: 0, i: 0, c: 24, w: {a: 15, b: 23, c: 89}, y: null, x: {a: 32, b: 4, c: 88}},
{_id: 66, b: 40, e: 78, d: 0, g: 66, h: 68, j: 0, i: 0, c: 11, w: {a: 48, b: 63, c: 47}, y: null, x: {a: 32, b: 88, c: 88}}

Query 57 (with useIndex=false): [ { "$project" : { "f" : 0 } }, { "$sort" : { "a" : -1, "_id" : 1 } }, { "$addFields" : { "j" : 91 } }, { "$group" : { "_id" : "$h", "j" : { "$sum" : "$j" }, "c" : { "$sum" : "$c" }, "l" : { "$sum" : "$l" }, "k" : { "$sum" : "$k" }, "a" : { "$sum" : "$a" }, "f" : { "$sum" : "$f" }, "i" : { "$sum" : "$i" }, "h" : { "$sum" : "$h" }, "g" : { "$sum" : "$g" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } }, { "$project" : { "b" : 0 } }, { "$match" : { "y.a" : { "$lt" : 93 } } }, { "$addFields" : { "c" : "$t", "b" : 75, "y.c" : 11 } }, { "$addFields" : { "e" : "$g" } }, { "$addFields" : { "k" : "$m", "b" : "$b" } }, { "$match" : { "f" : { "$lt" : 84 } } } ]


Query 58 (with useIndex=false): [ { "$project" : { "j" : 1, "c" : 1, "k" : 1, "d" : 1, "g" : 1, "f" : 1, "b" : "$b", "l" : "$a", "e" : 1, "w" : 1 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$project" : { "h" : 1, "f" : 1, "g" : "$i", "l" : 1, "e" : 1, "i" : 1, "c" : "$h", "j" : 1, "w.b" : 1, "w.a" : 1, "y" : 1 } }, { "$sort" : { "h" : 1, "_id" : 1 } }, { "$group" : { "_id" : "$i", "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "c" : { "$sum" : "$c" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "e" : { "$sum" : "$e" }, "i" : { "$sum" : "$i" }, "f" : { "$sum" : "$f" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } }, { "$sort" : { "h" : -1, "_id" : 1 } }, { "$group" : { "_id" : "$l", "d" : { "$sum" : "$d" }, "b" : { "$sum" : "$b" }, "h" : { "$sum" : "$h" }, "l" : { "$sum" : "$l" }, "f" : { "$sum" : "$f" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "e" : { "$sum" : "$e" }, "a" : { "$sum" : "$a" }, "k" : { "$sum" : "$k" }, "c" : { "$sum" : "$c" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } } ]

{_id: null, d: 0, b: 0, h: 0, l: 0, f: 414, g: 0, j: 0, e: 513, a: 0, k: 0, c: 0, w: {a: 10, b: 66}, y: {_id: 1, b: 57, c: 58, a: 41}, x: null}

Query 59 (with useIndex=false): [ { "$group" : { "_id" : "$f", "e" : { "$sum" : "$e" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "g" : { "$sum" : "$g" }, "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "f" : { "$sum" : "$f" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" } } }, { "$addFields" : { "c" : 77, "x.b" : 34, "x.a" : 32 } }, { "$project" : { "e" : 1, "b" : 1, "j" : 1, "f" : 1, "h" : "$j", "g" : 1, "l" : { "$literal" : 10 }, "k" : "$d", "a" : "$c", "y.b" : 1 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "x" } }, { "$unwind" : "$x" }, { "$project" : { "i" : 0 } }, { "$project" : { "l" : 0, "f" : 0, "x.a" : 0, "x.c" : 0 } } ]

{_id: 4, e: 63, g: 62, j: 0, h: 0, k: 92, a: 77, x: {_id: 4, b: 16}}

Query 60 (with useIndex=false): [ { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "x" } }, { "$unwind" : "$x" }, { "$project" : { "e" : 0, "j" : 0, "y" : 0 } }, { "$sort" : { "d" : 1, "_id" : 1 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" } ]

{_id: 1, a: 32, h: 71, d: 10, x: {_id: 1, b: 57, c: 58, a: 41}, g: 26, c: 60, w: {_id: 1, b: 57, c: 58, a: 41}, f: 85, b: 64, i: 65},
{_id: 2, w: {_id: 2, b: 12, c: 54, a: 92}, d: 94, i: 42, c: 32, h: 50, b: 21, g: 2, a: 85, f: 98, x: {_id: 2, b: 12, c: 54, a: 92}},
{_id: 3, a: 27, h: 72, d: 93, x: {_id: 3, c: 99, a: 47, b: 57}, g: 8, c: 77, w: {_id: 3, c: 99, a: 47, b: 57}, f: 49, b: 47, i: 67},
{_id: 4, a: 29, h: 83, d: 34, x: {_id: 4, b: 16, c: 7, a: 60}, g: 16, c: 87, w: {_id: 4, b: 16, c: 7, a: 60}, f: 50, b: 76, i: 38},
{_id: 5, d: 7, b: 4, x: {_id: 5, a: 16, b: 71, c: 91}, i: 93, g: 15, c: 49, a: 89, w: {_id: 5, a: 16, b: 71, c: 91}, h: 75, f: 69},
{_id: 6, f: 41, d: 54, c: 94, b: 71, a: 85, x: {_id: 6, c: 78, a: 37, b: 67}, w: {_id: 6, c: 78, a: 37, b: 67}, i: 84, h: 71, g: 16},
{_id: 7, w: {_id: 7, a: 0, c: 4, b: 1}, h: 86, f: 18, d: 65, b: 40, x: {_id: 7, a: 0, c: 4, b: 1}, i: 44, g: 66, c: 11, a: 85},
{_id: 8, g: 62, c: 24, w: {_id: 8, a: 14, b: 86, c: 90}, f: 4, b: 81, i: 43, a: 75, h: 74, d: 92, x: {_id: 8, a: 14, b: 86, c: 90}}

Query 61 (with useIndex=false): [ { "$addFields" : { "b" : "$q" } }, { "$addFields" : { "i" : 16, "b" : 57, "w" : "$y" } }, { "$addFields" : { "g" : "$l", "w.c" : 93, "w.a" : 97 } }, { "$match" : { "f" : { "$gt" : 1 } } }, { "$match" : { "b" : { "$gte" : 2 } } }, { "$addFields" : { "d" : 29, "h" : "$d" } }, { "$setWindowFields" : { "partitionBy" : "$b", "sortBy" : { "a" : -1, "_id" : 1 }, "output" : { "e" : { "$sum" : "$e", "window" : { "documents" : [ -2, 2 ] } } } } }, { "$addFields" : { "a" : 56, "b" : 74, "d" : "$f", "y" : "$x" } }, { "$match" : { "w.c" : { "$gte" : 1 } } }, { "$match" : { "e" : { "$gte" : 12 } } } ]

{_id: 1, e: 358, a: 56, h: 10, d: 85, x: {a: 4, b: 40, c: 0}, c: 60, f: 85, i: 16, b: 74, w: {c: 93, a: 97}, y: {a: 4, b: 40, c: 0}},
{_id: 2, e: 233, d: 98, i: 16, c: 32, h: 94, a: 56, f: 98, x: {a: 8, b: 71, c: 40}, b: 74, w: {c: 93, a: 97}, y: {a: 8, b: 71, c: 40}},
{_id: 3, a: 56, h: 93, d: 49, x: {a: 19, b: 99, c: 77}, c: 77, f: 49, i: 16, e: 217, b: 74, w: {c: 93, a: 97}, y: {a: 19, b: 99, c: 77}},
{_id: 4, a: 56, h: 34, d: 50, x: {a: 81, b: 68, c: 20}, c: 87, f: 50, i: 16, e: 280, b: 74, w: {c: 93, a: 97}, y: {a: 81, b: 68, c: 20}},
{_id: 5, d: 69, x: {a: 75, b: 5, c: 70}, i: 16, e: 155, c: 49, a: 56, h: 7, f: 69, b: 74, w: {c: 93, a: 97}, y: {a: 75, b: 5, c: 70}},
{_id: 6, f: 41, e: 296, d: 41, c: 94, a: 56, x: {a: 59, b: 36, c: 59}, i: 16, h: 54, b: 74, w: {c: 93, a: 97}, y: {a: 59, b: 36, c: 59}},
{_id: 7, h: 65, f: 18, d: 18, x: {a: 47, b: 88, c: 40}, i: 16, e: 304, c: 11, a: 56, b: 74, w: {c: 93, a: 97}, y: {a: 47, b: 88, c: 40}},
{_id: 8, c: 24, f: 4, i: 16, e: 373, a: 56, h: 92, d: 4, x: {a: 9, b: 4, c: 79}, b: 74, w: {c: 93, a: 97}, y: {a: 9, b: 4, c: 79}}

Query 62 (with useIndex=false): [ { "$addFields" : { "f" : "$r", "b" : 11 } }, { "$match" : { "y.b" : { "$lte" : 97 } } }, { "$addFields" : { "f" : 73, "c" : 64 } }, { "$addFields" : { "e" : 96, "g" : 10, "w" : "$x" } }, { "$sort" : { "i" : 1, "_id" : 1 } }, { "$limit" : 7 } ]


Query 63 (with useIndex=false): [ { "$match" : { "x.a" : { "$lt" : 98 } } }, { "$project" : { "k" : 0, "e" : 0 } }, { "$project" : { "h" : 0, "l" : 0, "w" : 0 } }, { "$match" : { "i" : { "$lt" : 85 } } }, { "$sort" : { "i" : -1, "_id" : 1 } }, { "$limit" : 5 } ]

{_id: 1, a: 32, d: 10, x: {a: 4, b: 40, c: 0}, g: 26, c: 60, f: 85, b: 64, i: 65},
{_id: 3, a: 27, d: 93, x: {a: 19, b: 99, c: 77}, g: 8, c: 77, f: 49, b: 47, i: 67},
{_id: 6, f: 41, d: 54, c: 94, b: 71, a: 85, x: {a: 59, b: 36, c: 59}, i: 84, g: 16},
{_id: 7, f: 18, d: 65, b: 40, x: {a: 47, b: 88, c: 40}, i: 44, g: 66, c: 11, a: 85},
{_id: 8, g: 62, c: 24, f: 4, b: 81, i: 43, a: 75, d: 92, x: {a: 9, b: 4, c: 79}}

Query 64 (with useIndex=false): [ { "$sort" : { "i" : 1, "g" : 1, "_id" : 1 } }, { "$limit" : 5 }, { "$addFields" : { "d" : "$d", "j" : 63, "a" : 47 } }, { "$project" : { "b" : "$b", "h" : 1, "l" : "$k", "k" : 1, "a" : 1, "i" : 1, "c" : { "$literal" : 2 }, "g" : 1, "j" : "$a", "e" : "$d", "f" : 1, "w.c" : 1, "y" : 1 } }, { "$addFields" : { "b" : 42, "g" : 91, "j" : 47 } }, { "$project" : { "a" : 0, "j" : 0 } }, { "$sort" : { "c" : 1, "k" : -1, "_id" : 1 } }, { "$match" : { "y.a" : { "$gt" : 24 } } }, { "$project" : { "l" : 0, "x.a" : 0, "x.c" : 0 } } ]


Query 65 (with useIndex=false): [ { "$sort" : { "i" : -1, "_id" : 1 } }, { "$limit" : 6 }, { "$match" : { "w.b" : { "$gte" : 9 } } }, { "$addFields" : { "b" : 79, "a" : 39, "d" : 28 } }, { "$sort" : { "l" : -1, "i" : 1, "_id" : 1 } }, { "$limit" : 5 }, { "$addFields" : { "g" : "$h", "k" : 34 } }, { "$addFields" : { "f" : "$s" } }, { "$addFields" : { "l" : "$a", "k" : 34, "x.b" : 12 } }, { "$addFields" : { "f" : "$d", "e" : "$l", "x" : "$x" } }, { "$match" : { "j" : { "$lte" : 84 } } }, { "$project" : { "g" : 0, "w" : 0 } } ]


Query 66 (with useIndex=false): [ { "$sort" : { "c" : -1, "f" : 1, "_id" : 1 } }, { "$project" : { "i" : "$g", "h" : 1, "d" : 1, "l" : 1, "e" : 1, "g" : 1, "k" : 1, "b" : 1, "c" : "$b", "a" : 1, "j" : 1, "w" : 1 } }, { "$project" : { "b" : 1, "j" : 1, "e" : 1, "l" : 1, "c" : 1, "i" : 1, "f" : 1, "h" : 1, "a" : "$f", "x.a" : 1, "y.c" : 1 } }, { "$addFields" : { "f" : 80, "g" : "$f", "e" : 71, "w.b" : 44, "w.c" : 77 } }, { "$addFields" : { "a" : "$f", "g" : 46, "k" : 70 } } ]

{_id: 1, e: 71, h: 71, b: 64, i: 26, c: 64, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 2, e: 71, h: 50, b: 21, i: 2, c: 21, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 3, h: 72, b: 47, e: 71, i: 8, c: 47, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 4, h: 83, b: 76, e: 71, i: 16, c: 76, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 5, b: 4, e: 71, h: 75, i: 15, c: 4, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 6, e: 71, b: 71, h: 71, i: 16, c: 71, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 7, h: 86, b: 40, e: 71, i: 66, c: 40, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 8, b: 81, e: 71, h: 74, i: 62, c: 81, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70}

Query 67 (with useIndex=false): [ { "$addFields" : { "b" : "$d", "w.a" : 44 } }, { "$addFields" : { "j" : 57, "y.c" : 60, "y.a" : 75 } }, { "$sort" : { "l" : -1, "_id" : 1 } }, { "$limit" : 7 }, { "$project" : { "b" : 0, "c" : 0, "y" : 0 } }, { "$match" : { "y.a" : { "$lte" : 96 } } }, { "$sort" : { "e" : 1, "_id" : 1 } }, { "$limit" : 8 }, { "$project" : { "i" : 0, "x" : 0 } } ]


Query 68 (with useIndex=false): [ { "$sort" : { "b" : -1, "_id" : 1 } }, { "$group" : { "_id" : "$f", "k" : { "$sum" : "$k" }, "e" : { "$sum" : "$e" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "g" : { "$sum" : "$g" }, "f" : { "$sum" : "$f" }, "d" : { "$sum" : "$d" }, "b" : { "$sum" : "$b" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$project" : { "j" : 0 } }, { "$match" : { "w.a" : { "$gte" : 19 } } }, { "$group" : { "_id" : "$i", "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "f" : { "$sum" : "$f" }, "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "i" : { "$sum" : "$i" }, "e" : { "$sum" : "$e" }, "j" : { "$sum" : "$j" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "a" : 18, "h" : "$b", "j" : 19, "w.c" : 80 } }, { "$group" : { "_id" : "$d", "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "f" : { "$sum" : "$f" }, "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "g" : { "$sum" : "$g" }, "h" : { "$sum" : "$h" }, "k" : { "$sum" : "$k" }, "d" : { "$sum" : "$d" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$addFields" : { "j" : 15, "a" : "$t" } }, { "$project" : { "d" : 0, "i" : 0, "y" : 0 } } ]

{_id: null, l: 0, f: 235, b: 141, e: 260, g: 99, h: 141, k: 0, w: {a: 44, b: 19, c: 80}, x: {a: 8, b: 71, c: 40}, j: 15}

Query 69 (with useIndex=false): [ { "$group" : { "_id" : "$b", "d" : { "$sum" : "$d" }, "h" : { "$sum" : "$h" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "f" : { "$sum" : "$f" }, "i" : { "$sum" : "$i" }, "g" : { "$sum" : "$g" }, "k" : { "$sum" : "$k" }, "e" : { "$sum" : "$e" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" } } }, { "$addFields" : { "i" : 96, "y" : "$x" } }, { "$sort" : { "i" : -1, "_id" : 1 } }, { "$limit" : 7 }, { "$addFields" : { "h" : 26, "x" : "$x" } }, { "$group" : { "_id" : "$h", "k" : { "$sum" : "$k" }, "h" : { "$sum" : "$h" }, "g" : { "$sum" : "$g" }, "f" : { "$sum" : "$f" }, "j" : { "$sum" : "$j" }, "a" : { "$sum" : "$a" }, "e" : { "$sum" : "$e" }, "i" : { "$sum" : "$i" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$group" : { "_id" : "$g", "k" : { "$sum" : "$k" }, "e" : { "$sum" : "$e" }, "g" : { "$sum" : "$g" }, "b" : { "$sum" : "$b" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "h" : { "$sum" : "$h" }, "f" : { "$sum" : "$f" }, "j" : { "$sum" : "$j" }, "d" : { "$sum" : "$d" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$group" : { "_id" : "$d", "j" : { "$sum" : "$j" }, "a" : { "$sum" : "$a" }, "i" : { "$sum" : "$i" }, "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "d" : { "$sum" : "$d" }, "g" : { "$sum" : "$g" }, "b" : { "$sum" : "$b" }, "k" : { "$sum" : "$k" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$match" : { "y.a" : { "$gte" : 3 } } }, { "$sort" : { "f" : 1, "_id" : 1 } }, { "$match" : { "g" : { "$gt" : 11 } } } ]

{_id: 0, j: 0, a: 432, i: 672, h: 182, c: 0, d: 0, g: 149, b: 0, k: 0, w: {a: 10, b: 66, c: 62}, y: {a: 4, b: 40, c: 0}, x: {a: 4, b: 40, c: 0}}

Query 70 (with useIndex=false): [ { "$addFields" : { "c" : "$m", "h" : 73 } }, { "$project" : { "k" : 1, "h" : 1, "b" : "$f", "j" : 1, "d" : "$k", "i" : 1, "e" : "$a", "g" : 1, "f" : 1, "c" : 1, "x.a" : 1, "x.c" : 1, "y.c" : 1 } }, { "$project" : { "c" : "$b", "i" : "$a", "e" : 1, "j" : 1, "b" : 1, "l" : 1, "f" : 1, "d" : 1, "x.a" : 1, "x.c" : 1 } }, { "$match" : { "x.a" : { "$gte" : 21 } } }, { "$project" : { "f" : 1, "c" : 1, "e" : 1, "i" : 1, "l" : 1, "d" : 1, "k" : 1, "h" : 1, "b" : 1, "j" : 1, "w.b" : 1, "w.a" : 1 } }, { "$project" : { "h" : 0, "f" : 0, "w.a" : 0 } }, { "$match" : { "y.a" : { "$gte" : 14 } } }, { "$match" : { "k" : { "$gte" : 17 } } }, { "$addFields" : { "d" : 80, "k" : "$h", "y" : "$w" } } ]


Query 71 (with useIndex=false): [ { "$addFields" : { "c" : 76, "i" : 4 } }, { "$match" : { "y.a" : { "$gte" : 23 } } }, { "$sort" : { "f" : -1, "h" : 1, "_id" : 1 } }, { "$match" : { "k" : { "$gt" : 4 } } }, { "$sort" : { "f" : -1, "i" : 1, "_id" : 1 } }, { "$limit" : 10 }, { "$project" : { "k" : 1, "a" : 1, "g" : 1, "f" : "$d", "i" : "$a", "d" : 1, "c" : { "$literal" : 6 }, "l" : { "$literal" : 52 }, "w" : 1, "x" : 1 } }, { "$match" : { "x.c" : { "$lt" : 77 } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$setWindowFields" : { "partitionBy" : "$c", "sortBy" : { "c" : -1, "_id" : 1 }, "output" : { "k" : { "$sum" : "$k", "window" : { "documents" : [ "unbounded", "unbounded" ] } }, "i" : { "$sum" : "$i", "window" : { "documents" : [ -2, 0 ] } }, "y" : { "$min" : "$y", "window" : { "documents" : [ "current", "unbounded" ] } } } } }, { "$match" : { "e" : { "$lte" : 87 } } } ]


Query 72 (with useIndex=false): [ { "$sort" : { "c" : -1, "_id" : 1 } }, { "$limit" : 7 }, { "$match" : { "b" : { "$lte" : 94 } } }, { "$project" : { "j" : 1, "g" : 1, "i" : 1, "k" : "$h", "b" : 1, "h" : 1, "c" : 1, "l" : 1, "d" : 1, "y.a" : 1, "y.b" : 1 } }, { "$project" : { "l" : 0, "k" : 0 } }, { "$match" : { "w.b" : { "$gte" : 8 } } }, { "$match" : { "g" : { "$gte" : 16 } } }, { "$addFields" : { "i" : 41, "l" : 24, "c" : 16 } }, { "$group" : { "_id" : "$e", "e" : { "$sum" : "$e" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "j" : { "$sum" : "$j" }, "b" : { "$sum" : "$b" }, "i" : { "$sum" : "$i" }, "c" : { "$sum" : "$c" }, "g" : { "$sum" : "$g" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } } ]


Query 1 (with useIndex=true): [ { "$setWindowFields" : { "partitionBy" : "$f", "sortBy" : { "k" : -1, "d" : -1, "_id" : 1 }, "output" : { "l" : { "$sum" : "$l", "window" : { "documents" : [ "unbounded", "unbounded" ] } }, "e" : { "$sum" : "$e", "window" : { "documents" : [ "current", "unbounded" ] } } } } }, { "$addFields" : { "i" : "$l", "k" : "$a" } }, { "$addFields" : { "f" : "$m", "w" : "$y" } }, { "$setWindowFields" : { "partitionBy" : "$j", "sortBy" : { "g" : 1, "h" : 1, "_id" : 1 }, "output" : { "h" : { "$sum" : "$h", "window" : { "documents" : [ "unbounded", "unbounded" ] } } } } }, { "$addFields" : { "e" : 8, "l" : 86, "j" : "$t", "w" : "$w" } }, { "$match" : { "b" : { "$lt" : 76 } } }, { "$setWindowFields" : { "sortBy" : { "a" : 1, "e" : 1, "_id" : 1 }, "output" : { "e" : { "$sum" : "$e", "window" : { "documents" : [ -2, 2 ] } }, "y" : { "$min" : "$y", "window" : { "documents" : [ "current", "unbounded" ] } } } } }, { "$addFields" : { "l" : "$q", "j" : 72, "y" : "$w" } }, { "$match" : { "a" : { "$gte" : 7 } } }, { "$project" : { "h" : 0, "c" : 0 } } ]

{_id: 1, e: 32, a: 32, d: 10, x: {a: 4, b: 40, c: 0}, g: 26, b: 64, i: 0, k: 32, j: 72},
{_id: 2, e: 40, d: 94, i: 0, b: 21, g: 2, a: 85, x: {a: 8, b: 71, c: 40}, k: 85, j: 72},
{_id: 3, a: 27, d: 93, x: {a: 19, b: 99, c: 77}, g: 8, b: 47, i: 0, e: 24, k: 27, j: 72},
{_id: 5, d: 7, b: 4, x: {a: 75, b: 5, c: 70}, i: 0, g: 15, e: 24, a: 89, k: 89, j: 72},
{_id: 6, e: 40, d: 54, b: 71, a: 85, x: {a: 59, b: 36, c: 59}, i: 0, g: 16, k: 85, j: 72},
{_id: 7, d: 65, b: 40, x: {a: 47, b: 88, c: 40}, i: 0, g: 66, e: 32, a: 85, k: 85, j: 72}

Query 2 (with useIndex=true): [ { "$addFields" : { "f" : 44, "h" : "$q" } }, { "$match" : { "g" : { "$gte" : 6 } } }, { "$addFields" : { "j" : 41, "f" : 60, "k" : 64 } }, { "$addFields" : { "e" : "$c", "c" : "$d" } }, { "$addFields" : { "j" : 23, "l" : "$h", "c" : "$j" } }, { "$project" : { "g" : 0, "h" : 0 } }, { "$addFields" : { "k" : "$e", "a" : 56, "y" : "$w" } } ]

{_id: 1, e: 60, a: 56, d: 10, x: {a: 4, b: 40, c: 0}, c: 41, w: {a: 18, b: 25, c: 26}, f: 60, b: 64, i: 65, j: 23, k: 60, y: {a: 18, b: 25, c: 26}},
{_id: 3, a: 56, d: 93, x: {a: 19, b: 99, c: 77}, c: 41, w: {a: 11, b: 3, c: 9}, f: 60, b: 47, i: 67, e: 77, j: 23, k: 77, y: {a: 11, b: 3, c: 9}},
{_id: 4, a: 56, d: 34, x: {a: 81, b: 68, c: 20}, c: 41, w: {a: 86, b: 75, c: 3}, f: 60, b: 76, i: 38, e: 87, j: 23, k: 87, y: {a: 86, b: 75, c: 3}},
{_id: 5, d: 7, b: 4, x: {a: 75, b: 5, c: 70}, i: 93, e: 49, c: 41, a: 56, w: {a: 44, b: 19, c: 96}, f: 60, j: 23, k: 49, y: {a: 44, b: 19, c: 96}},
{_id: 6, f: 60, e: 94, d: 54, c: 41, b: 71, a: 56, x: {a: 59, b: 36, c: 59}, w: {a: 10, b: 66, c: 62}, i: 84, j: 23, k: 94, y: {a: 10, b: 66, c: 62}},
{_id: 7, w: {a: 48, b: 63, c: 47}, f: 60, d: 65, b: 40, x: {a: 47, b: 88, c: 40}, i: 44, e: 11, c: 41, a: 56, j: 23, k: 11, y: {a: 48, b: 63, c: 47}},
{_id: 8, c: 41, w: {a: 15, b: 23, c: 89}, f: 60, b: 81, i: 43, e: 24, a: 56, d: 92, x: {a: 9, b: 4, c: 79}, j: 23, k: 24, y: {a: 15, b: 23, c: 89}}

Query 3 (with useIndex=true): [ { "$addFields" : { "h" : 31, "y" : "$y" } }, { "$project" : { "e" : 0 } }, { "$match" : { "a" : { "$gte" : 15 } } }, { "$match" : { "i" : { "$gte" : 1 } } }, { "$match" : { "k" : { "$gt" : 9 } } }, { "$match" : { "a" : { "$lt" : 87 } } }, { "$project" : { "i" : 0, "x" : 0 } }, { "$addFields" : { "d" : "$p", "e" : 68, "h" : 97 } } ]


Query 4 (with useIndex=true): [ { "$addFields" : { "b" : "$a", "j" : 34, "k" : "$o", "x" : "$w" } }, { "$project" : { "k" : 0, "x" : 0 } }, { "$project" : { "i" : 1, "l" : "$c", "d" : 1, "h" : 1, "f" : 1, "e" : { "$literal" : 89 }, "c" : 1, "g" : 1, "j" : 1, "w" : 1, "x" : 1 } }, { "$project" : { "f" : "$k", "i" : "$c", "j" : 1, "e" : 1, "g" : 1, "b" : "$b", "d" : 1, "h" : 1, "l" : 1, "c" : 1, "a" : 1, "y" : 1 } }, { "$project" : { "j" : 0, "i" : 0, "w" : 0 } } ]

{_id: 1, h: 71, d: 10, g: 26, c: 60, l: 60, e: 89},
{_id: 2, d: 94, c: 32, h: 50, g: 2, l: 32, e: 89},
{_id: 3, h: 72, d: 93, g: 8, c: 77, l: 77, e: 89},
{_id: 4, h: 83, d: 34, g: 16, c: 87, l: 87, e: 89},
{_id: 5, d: 7, g: 15, c: 49, h: 75, l: 49, e: 89},
{_id: 6, d: 54, c: 94, h: 71, g: 16, l: 94, e: 89},
{_id: 7, h: 86, d: 65, g: 66, c: 11, l: 11, e: 89},
{_id: 8, g: 62, c: 24, h: 74, d: 92, l: 24, e: 89}

Query 5 (with useIndex=true): [ { "$project" : { "i" : 0 } }, { "$addFields" : { "f" : 72, "l" : "$r", "c" : 99 } }, { "$match" : { "k" : { "$gte" : 15 } } }, { "$addFields" : { "b" : 3, "j" : "$l", "k" : "$i", "x" : "$w" } }, { "$project" : { "b" : 1, "f" : 1, "c" : 1, "i" : 1, "a" : 1, "j" : 1, "k" : { "$literal" : 85 }, "d" : 1, "y" : 1 } }, { "$match" : { "a" : { "$gt" : 18 } } }, { "$project" : { "k" : "$h", "h" : 1, "j" : "$l", "i" : "$f", "d" : "$b", "f" : "$f", "g" : 1, "b" : 1, "e" : 1, "w" : 1 } }, { "$project" : { "h" : 1, "k" : 1, "l" : 1, "a" : 1, "i" : 1, "b" : 1, "g" : 1, "e" : 1, "w" : 1 } }, { "$match" : { "b" : { "$gte" : 12 } } }, { "$addFields" : { "j" : 74, "y" : "$y" } } ]


Query 6 (with useIndex=true): [ { "$project" : { "i" : 1, "b" : "$b", "h" : "$l", "g" : 1, "a" : "$f", "k" : 1, "j" : "$k", "e" : 1, "d" : 1, "f" : 1, "y" : 1, "x" : 1 } }, { "$setWindowFields" : { "partitionBy" : "$j", "sortBy" : { "a" : -1, "j" : -1, "_id" : 1 }, "output" : { "j" : { "$sum" : "$j", "window" : { "documents" : [ "unbounded", "current" ] } }, "d" : { "$sum" : "$d", "window" : { "documents" : [ "unbounded", "unbounded" ] } }, "w" : { "$min" : "$w", "window" : { "documents" : [ "current", "unbounded" ] } } } } }, { "$addFields" : { "i" : 85, "j" : 39, "k" : 29 } }, { "$match" : { "i" : { "$lte" : 75 } } }, { "$project" : { "l" : 1, "e" : 1, "j" : 1, "b" : 1, "f" : 1, "k" : 1, "h" : 1, "d" : "$f", "x" : 1 } }, { "$match" : { "d" : { "$lte" : 89 } } }, { "$project" : { "b" : 0, "j" : 0, "x" : 0 } }, { "$setWindowFields" : { "partitionBy" : "$f", "sortBy" : { "b" : -1, "k" : -1, "_id" : 1 }, "output" : { "k" : { "$sum" : "$k", "window" : { "documents" : [ "current", "unbounded" ] } }, "x" : { "$min" : "$x", "window" : { "documents" : [ -2, 0 ] } } } } }, { "$match" : { "i" : { "$gte" : 23 } } }, { "$addFields" : { "h" : "$b", "b" : 9 } }, { "$addFields" : { "f" : 97 } }, { "$match" : { "j" : { "$lte" : 88 } } } ]


Query 7 (with useIndex=true): [ { "$group" : { "_id" : "$f", "l" : { "$sum" : "$l" }, "k" : { "$sum" : "$k" }, "g" : { "$sum" : "$g" }, "c" : { "$sum" : "$c" }, "d" : { "$sum" : "$d" }, "j" : { "$sum" : "$j" }, "e" : { "$sum" : "$e" }, "i" : { "$sum" : "$i" }, "f" : { "$sum" : "$f" }, "b" : { "$sum" : "$b" }, "h" : { "$sum" : "$h" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$project" : { "d" : 0 } }, { "$group" : { "_id" : "$f", "a" : { "$sum" : "$a" }, "f" : { "$sum" : "$f" }, "l" : { "$sum" : "$l" }, "e" : { "$sum" : "$e" }, "g" : { "$sum" : "$g" }, "b" : { "$sum" : "$b" }, "d" : { "$sum" : "$d" }, "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "k" : { "$sum" : "$k" }, "j" : { "$sum" : "$j" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } }, { "$group" : { "_id" : "$k", "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "c" : { "$sum" : "$c" }, "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "i" : { "$sum" : "$i" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "i" : "$o", "h" : "$o", "j" : "$k", "x" : "$w" } }, { "$match" : { "e" : { "$gt" : 16 } } }, { "$project" : { "h" : 0, "a" : 0, "y" : 0 } }, { "$group" : { "_id" : "$d", "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "h" : { "$sum" : "$h" }, "l" : { "$sum" : "$l" }, "k" : { "$sum" : "$k" }, "c" : { "$sum" : "$c" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$project" : { "c" : 0, "g" : 0, "w" : 0 } } ]


Query 8 (with useIndex=true): [ { "$project" : { "f" : 0, "l" : 0 } }, { "$addFields" : { "b" : "$n", "f" : "$d", "h" : 56, "w" : "$x" } }, { "$addFields" : { "d" : 87, "i" : 68, "h" : "$l", "y" : "$w" } }, { "$addFields" : { "d" : 24, "l" : "$f", "y" : "$x" } } ]

{_id: 1, e: 95, a: 32, d: 24, x: {a: 4, b: 40, c: 0}, g: 26, c: 60, w: {a: 4, b: 40, c: 0}, i: 68, f: 10, y: {a: 4, b: 40, c: 0}, l: 10},
{_id: 2, e: 13, w: {a: 8, b: 71, c: 40}, d: 24, i: 68, c: 32, g: 2, a: 85, x: {a: 8, b: 71, c: 40}, f: 94, y: {a: 8, b: 71, c: 40}, l: 94},
{_id: 3, a: 27, d: 24, x: {a: 19, b: 99, c: 77}, g: 8, c: 77, w: {a: 19, b: 99, c: 77}, i: 68, e: 40, f: 93, y: {a: 19, b: 99, c: 77}, l: 93},
{_id: 4, a: 29, d: 24, x: {a: 81, b: 68, c: 20}, g: 16, c: 87, w: {a: 81, b: 68, c: 20}, i: 68, e: 82, f: 34, y: {a: 81, b: 68, c: 20}, l: 34},
{_id: 5, d: 24, x: {a: 75, b: 5, c: 70}, i: 68, g: 15, e: 87, c: 49, a: 89, w: {a: 75, b: 5, c: 70}, f: 7, y: {a: 75, b: 5, c: 70}, l: 7},
{_id: 6, e: 55, d: 24, c: 94, a: 85, x: {a: 59, b: 36, c: 59}, w: {a: 59, b: 36, c: 59}, i: 68, g: 16, f: 54, y: {a: 59, b: 36, c: 59}, l: 54},
{_id: 7, w: {a: 47, b: 88, c: 40}, d: 24, x: {a: 47, b: 88, c: 40}, i: 68, g: 66, e: 78, c: 11, a: 85, f: 65, y: {a: 47, b: 88, c: 40}, l: 65},
{_id: 8, g: 62, c: 24, w: {a: 9, b: 4, c: 79}, i: 68, e: 63, a: 75, d: 24, x: {a: 9, b: 4, c: 79}, f: 92, y: {a: 9, b: 4, c: 79}, l: 92}

Query 9 (with useIndex=true): [ { "$group" : { "_id" : "$a", "l" : { "$sum" : "$l" }, "d" : { "$sum" : "$d" }, "i" : { "$sum" : "$i" }, "c" : { "$sum" : "$c" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "k" : { "$sum" : "$k" }, "a" : { "$sum" : "$a" }, "h" : { "$sum" : "$h" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$match" : { "f" : { "$lte" : 99 } } }, { "$addFields" : { "e" : 31, "i" : 17, "f" : 92 } }, { "$addFields" : { "g" : 34 } }, { "$addFields" : { "d" : 57, "k" : 43, "i" : 36, "y" : "$w" } }, { "$addFields" : { "b" : 20, "d" : 54, "x" : "$x" } } ]


Query 10 (with useIndex=true): [ { "$match" : { "d" : { "$gt" : 9 } } }, { "$addFields" : { "a" : 88, "w" : "$w" } }, { "$addFields" : { "k" : 49, "b" : 14, "y" : "$x" } }, { "$addFields" : { "l" : "$o", "w" : "$w" } }, { "$match" : { "e" : { "$lt" : 86 } } }, { "$project" : { "e" : 1, "k" : 1, "h" : 1, "j" : 1, "b" : 1, "c" : "$h", "a" : 1, "g" : 1, "x" : 1 } }, { "$group" : { "_id" : "$b", "g" : { "$sum" : "$g" }, "c" : { "$sum" : "$c" }, "d" : { "$sum" : "$d" }, "a" : { "$sum" : "$a" }, "k" : { "$sum" : "$k" }, "j" : { "$sum" : "$j" }, "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "e" : { "$sum" : "$e" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$match" : { "k" : { "$lt" : 81 } } }, { "$project" : { "a" : 0, "y" : 0 } }, { "$match" : { "j" : { "$gt" : 11 } } }, { "$group" : { "_id" : "$g", "a" : { "$sum" : "$a" }, "c" : { "$sum" : "$c" }, "e" : { "$sum" : "$e" }, "l" : { "$sum" : "$l" }, "i" : { "$sum" : "$i" }, "k" : { "$sum" : "$k" }, "h" : { "$sum" : "$h" }, "d" : { "$sum" : "$d" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$project" : { "d" : 1, "g" : 1, "b" : 1, "a" : 1, "c" : 1, "i" : 1, "f" : 1, "k" : 1, "l" : 1, "h" : "$g", "y" : 1 } } ]


Query 11 (with useIndex=true): [ { "$addFields" : { "b" : 51, "j" : 57, "c" : 68 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$group" : { "_id" : "$a", "g" : { "$sum" : "$g" }, "h" : { "$sum" : "$h" }, "e" : { "$sum" : "$e" }, "f" : { "$sum" : "$f" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "j" : { "$sum" : "$j" }, "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "k" : { "$sum" : "$k" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$project" : { "l" : 0, "a" : 0, "y" : 0 } }, { "$match" : { "l" : { "$gt" : 13 } } } ]


Query 12 (with useIndex=true): [ { "$group" : { "_id" : "$d", "b" : { "$sum" : "$b" }, "i" : { "$sum" : "$i" }, "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "l" : { "$sum" : "$l" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "e" : { "$sum" : "$e" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$addFields" : { "l" : 31, "e" : 39 } }, { "$addFields" : { "c" : 31, "b" : 17, "y" : "$x" } }, { "$group" : { "_id" : "$f", "j" : { "$sum" : "$j" }, "h" : { "$sum" : "$h" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "f" : { "$sum" : "$f" }, "e" : { "$sum" : "$e" }, "k" : { "$sum" : "$k" }, "c" : { "$sum" : "$c" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" } } } ]

{_id: 18, j: 0, h: 86, i: 44, l: 31, f: 18, e: 39, k: 0, c: 31, x: {a: 47, b: 88, c: 40}, w: {a: 48, b: 63, c: 47}, y: {a: 47, b: 88, c: 40}},
{_id: 4, j: 0, h: 74, i: 43, l: 31, f: 4, e: 39, k: 0, c: 31, x: {a: 9, b: 4, c: 79}, w: {a: 15, b: 23, c: 89}, y: {a: 9, b: 4, c: 79}},
{_id: 41, j: 0, h: 71, i: 84, l: 31, f: 41, e: 39, k: 0, c: 31, x: {a: 59, b: 36, c: 59}, w: {a: 10, b: 66, c: 62}, y: {a: 59, b: 36, c: 59}},
{_id: 49, j: 0, h: 72, i: 67, l: 31, f: 49, e: 39, k: 0, c: 31, x: {a: 19, b: 99, c: 77}, w: {a: 11, b: 3, c: 9}, y: {a: 19, b: 99, c: 77}},
{_id: 50, j: 0, h: 83, i: 38, l: 31, f: 50, e: 39, k: 0, c: 31, x: {a: 81, b: 68, c: 20}, w: {a: 86, b: 75, c: 3}, y: {a: 81, b: 68, c: 20}},
{_id: 69, j: 0, h: 75, i: 93, l: 31, f: 69, e: 39, k: 0, c: 31, x: {a: 75, b: 5, c: 70}, w: {a: 44, b: 19, c: 96}, y: {a: 75, b: 5, c: 70}},
{_id: 85, j: 0, h: 71, i: 65, l: 31, f: 85, e: 39, k: 0, c: 31, x: {a: 4, b: 40, c: 0}, w: {a: 18, b: 25, c: 26}, y: {a: 4, b: 40, c: 0}},
{_id: 98, j: 0, h: 50, i: 42, l: 31, f: 98, e: 39, k: 0, c: 31, x: {a: 8, b: 71, c: 40}, w: {a: 94, b: 32, c: 58}, y: {a: 8, b: 71, c: 40}}

Query 13 (with useIndex=true): [ { "$addFields" : { "e" : 3, "k" : 18 } }, { "$setWindowFields" : { "partitionBy" : "$j", "sortBy" : { "g" : -1, "_id" : 1 }, "output" : { "j" : { "$sum" : "$j", "window" : { "documents" : [ "unbounded", "current" ] } }, "d" : { "$sum" : "$d", "window" : { "documents" : [ 0, 2 ] } }, "y" : { "$min" : "$y", "window" : { "documents" : [ -2, 2 ] } } } } }, { "$project" : { "g" : 0, "b" : 0 } }, { "$project" : { "f" : 0, "a" : 0, "y" : 0 } } ]

{_id: 1, e: 3, h: 71, d: 98, x: {a: 4, b: 40, c: 0}, c: 60, w: {a: 18, b: 25, c: 26}, i: 65, k: 18, j: 0},
{_id: 2, e: 3, w: {a: 94, b: 32, c: 58}, d: 94, i: 42, c: 32, h: 50, x: {a: 8, b: 71, c: 40}, k: 18, j: 0},
{_id: 3, h: 72, d: 187, x: {a: 19, b: 99, c: 77}, c: 77, w: {a: 11, b: 3, c: 9}, i: 67, e: 3, k: 18, j: 0},
{_id: 4, h: 83, d: 95, x: {a: 81, b: 68, c: 20}, c: 87, w: {a: 86, b: 75, c: 3}, i: 38, e: 3, k: 18, j: 0},
{_id: 5, d: 194, x: {a: 75, b: 5, c: 70}, i: 93, e: 3, c: 49, w: {a: 44, b: 19, c: 96}, h: 75, k: 18, j: 0},
{_id: 6, e: 3, d: 154, c: 94, x: {a: 59, b: 36, c: 59}, w: {a: 10, b: 66, c: 62}, i: 84, h: 71, k: 18, j: 0},
{_id: 7, w: {a: 48, b: 63, c: 47}, h: 86, d: 167, x: {a: 47, b: 88, c: 40}, i: 44, e: 3, c: 11, k: 18, j: 0},
{_id: 8, c: 24, w: {a: 15, b: 23, c: 89}, i: 43, e: 3, h: 74, d: 136, x: {a: 9, b: 4, c: 79}, k: 18, j: 0}

Query 14 (with useIndex=true): [ { "$project" : { "d" : 0, "y" : 0 } }, { "$addFields" : { "d" : 27, "a" : 15, "j" : "$j", "w" : "$y" } }, { "$sort" : { "c" : 1, "f" : 1, "_id" : 1 } }, { "$sort" : { "g" : -1, "e" : -1, "_id" : 1 } } ]

{_id: 1, e: 95, a: 15, h: 71, x: {a: 4, b: 40, c: 0}, g: 26, c: 60, f: 85, b: 64, i: 65, d: 27},
{_id: 2, e: 13, i: 42, c: 32, h: 50, b: 21, g: 2, a: 15, f: 98, x: {a: 8, b: 71, c: 40}, d: 27},
{_id: 3, a: 15, h: 72, x: {a: 19, b: 99, c: 77}, g: 8, c: 77, f: 49, b: 47, i: 67, e: 40, d: 27},
{_id: 4, a: 15, h: 83, x: {a: 81, b: 68, c: 20}, g: 16, c: 87, f: 50, b: 76, i: 38, e: 82, d: 27},
{_id: 5, b: 4, x: {a: 75, b: 5, c: 70}, i: 93, g: 15, e: 87, c: 49, a: 15, h: 75, f: 69, d: 27},
{_id: 6, f: 41, e: 55, c: 94, b: 71, a: 15, x: {a: 59, b: 36, c: 59}, i: 84, h: 71, g: 16, d: 27},
{_id: 7, h: 86, f: 18, b: 40, x: {a: 47, b: 88, c: 40}, i: 44, g: 66, e: 78, c: 11, a: 15, d: 27},
{_id: 8, g: 62, c: 24, f: 4, b: 81, i: 43, e: 63, a: 15, h: 74, x: {a: 9, b: 4, c: 79}, d: 27}

Query 15 (with useIndex=true): [ { "$match" : { "g" : { "$lt" : 78 } } }, { "$match" : { "e" : { "$lt" : 85 } } }, { "$match" : { "f" : { "$gte" : 15 } } }, { "$addFields" : { "a" : 10, "k" : 92, "c" : 29, "w" : "$x" } }, { "$addFields" : { "k" : 89, "l" : 84, "g" : 21 } }, { "$sort" : { "e" : 1, "c" : -1, "_id" : 1 } }, { "$sort" : { "j" : -1, "a" : 1, "_id" : 1 } }, { "$match" : { "a" : { "$gte" : 12 } } }, { "$addFields" : { "l" : "$t", "w" : "$w" } }, { "$project" : { "j" : 0, "i" : 0, "w" : 0 } } ]


Query 16 (with useIndex=true): [ { "$project" : { "k" : 1, "l" : 1, "b" : 1, "j" : "$e", "d" : 1, "a" : 1, "c" : { "$literal" : 47 }, "i" : 1, "h" : { "$literal" : 76 }, "g" : 1, "x" : 1, "y" : 1 } }, { "$addFields" : { "l" : "$g", "x" : "$w" } }, { "$addFields" : { "c" : 11, "j" : "$q", "k" : 3, "y" : "$x" } }, { "$addFields" : { "g" : 64, "l" : 91, "w" : "$y" } }, { "$project" : { "a" : 1, "c" : 1, "d" : 1, "g" : 1, "b" : 1, "e" : 1, "j" : 1, "i" : 1, "y" : 1, "x" : 1 } }, { "$match" : { "b" : { "$lte" : 82 } } }, { "$sort" : { "h" : -1, "_id" : 1 } }, { "$match" : { "d" : { "$gt" : 14 } } }, { "$addFields" : { "k" : "$m", "b" : 18, "y" : "$y" } }, { "$project" : { "c" : 1, "e" : 1, "i" : "$i", "k" : 1, "f" : 1, "a" : 1, "d" : "$a", "b" : "$b", "j" : 1, "l" : { "$literal" : 70 }, "h" : 1, "w" : 1, "y" : 1 } } ]

{_id: 2, a: 85, c: 11, i: 42, d: 85, b: 18, l: 70},
{_id: 3, a: 27, c: 11, i: 67, d: 27, b: 18, l: 70},
{_id: 4, a: 29, c: 11, i: 38, d: 29, b: 18, l: 70},
{_id: 6, a: 85, c: 11, i: 84, d: 85, b: 18, l: 70},
{_id: 7, a: 85, c: 11, i: 44, d: 85, b: 18, l: 70},
{_id: 8, a: 75, c: 11, i: 43, d: 75, b: 18, l: 70}

Query 17 (with useIndex=true): [ { "$project" : { "d" : 0, "e" : 0, "x" : 0 } }, { "$match" : { "k" : { "$lt" : 81 } } }, { "$project" : { "k" : "$i", "l" : 1, "d" : "$d", "a" : 1, "g" : 1, "c" : { "$literal" : 26 }, "h" : { "$literal" : 5 }, "i" : 1, "f" : 1, "j" : "$h", "w" : 1 } }, { "$project" : { "g" : 0, "j" : 0, "x" : 0 } }, { "$addFields" : { "h" : 32, "b" : "$p" } }, { "$sort" : { "d" : -1, "i" : 1, "_id" : 1 } }, { "$project" : { "e" : 0, "y" : 0 } }, { "$match" : { "k" : { "$gte" : 23 } } } ]


Query 18 (with useIndex=true): [ { "$addFields" : { "d" : "$s", "j" : 46 } }, { "$project" : { "l" : 0, "c" : 0 } }, { "$project" : { "l" : 0 } }, { "$match" : { "l" : { "$lt" : 93 } } }, { "$project" : { "k" : 1, "j" : 1, "c" : 1, "l" : 1, "b" : 1, "e" : 1, "g" : "$k", "d" : 1, "w" : 1 } }, { "$project" : { "c" : 0 } }, { "$project" : { "g" : 0, "d" : 0 } } ]


Query 19 (with useIndex=true): [ { "$match" : { "i" : { "$lte" : 96 } } }, { "$project" : { "i" : 0, "d" : 0, "y" : 0 } }, { "$sort" : { "c" : 1, "_id" : 1 } }, { "$addFields" : { "l" : 45, "f" : 43, "y" : "$y" } }, { "$group" : { "_id" : "$g", "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "c" : { "$sum" : "$c" }, "e" : { "$sum" : "$e" }, "d" : { "$sum" : "$d" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$project" : { "d" : 0, "w" : 0 } }, { "$match" : { "f" : { "$gte" : 8 } } }, { "$addFields" : { "g" : 41 } }, { "$project" : { "l" : 0, "x" : 0 } }, { "$addFields" : { "b" : "$f", "i" : 33, "g" : 30 } } ]


Query 20 (with useIndex=true): [ { "$addFields" : { "h" : "$p", "j" : 35, "g" : 83 } }, { "$sort" : { "k" : -1, "_id" : 1 } }, { "$match" : { "j" : { "$lte" : 84 } } }, { "$match" : { "b" : { "$lte" : 91 } } }, { "$project" : { "i" : 0, "f" : 0 } }, { "$sort" : { "e" : 1, "l" : 1, "_id" : 1 } }, { "$group" : { "_id" : "$b", "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "e" : { "$sum" : "$e" }, "h" : { "$sum" : "$h" }, "b" : { "$sum" : "$b" }, "d" : { "$sum" : "$d" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" } } } ]

{_id: 21, j: 35, k: 0, i: 0, l: 0, e: 13, h: 0, b: 21, d: 94, x: {a: 8, b: 71, c: 40}, w: {a: 94, b: 32, c: 58}, y: null},
{_id: 4, j: 35, k: 0, i: 0, l: 0, e: 87, h: 0, b: 4, d: 7, x: {a: 75, b: 5, c: 70}, w: {a: 44, b: 19, c: 96}, y: null},
{_id: 40, j: 35, k: 0, i: 0, l: 0, e: 78, h: 0, b: 40, d: 65, x: {a: 47, b: 88, c: 40}, w: {a: 48, b: 63, c: 47}, y: null},
{_id: 47, j: 35, k: 0, i: 0, l: 0, e: 40, h: 0, b: 47, d: 93, x: {a: 19, b: 99, c: 77}, w: {a: 11, b: 3, c: 9}, y: null},
{_id: 64, j: 35, k: 0, i: 0, l: 0, e: 95, h: 0, b: 64, d: 10, x: {a: 4, b: 40, c: 0}, w: {a: 18, b: 25, c: 26}, y: null},
{_id: 71, j: 35, k: 0, i: 0, l: 0, e: 55, h: 0, b: 71, d: 54, x: {a: 59, b: 36, c: 59}, w: {a: 10, b: 66, c: 62}, y: null},
{_id: 76, j: 35, k: 0, i: 0, l: 0, e: 82, h: 0, b: 76, d: 34, x: {a: 81, b: 68, c: 20}, w: {a: 86, b: 75, c: 3}, y: null},
{_id: 81, j: 35, k: 0, i: 0, l: 0, e: 63, h: 0, b: 81, d: 92, x: {a: 9, b: 4, c: 79}, w: {a: 15, b: 23, c: 89}, y: null}

Query 21 (with useIndex=true): [ { "$group" : { "_id" : "$d", "e" : { "$sum" : "$e" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "f" : { "$sum" : "$f" }, "d" : { "$sum" : "$d" }, "c" : { "$sum" : "$c" }, "b" : { "$sum" : "$b" }, "k" : { "$sum" : "$k" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$sort" : { "a" : 1, "h" : 1, "_id" : 1 } }, { "$group" : { "_id" : "$i", "e" : { "$sum" : "$e" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "c" : { "$sum" : "$c" }, "f" : { "$sum" : "$f" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$group" : { "_id" : "$k", "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "g" : { "$sum" : "$g" }, "k" : { "$sum" : "$k" }, "e" : { "$sum" : "$e" }, "f" : { "$sum" : "$f" }, "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "b" : { "$sum" : "$b" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } } ]

{_id: null, l: 0, a: 507, g: 0, k: 0, e: 513, f: 414, h: 0, j: 0, b: 404, y: null, x: {a: 4, b: 40, c: 0}, w: {a: 10, b: 66, c: 62}}

Query 22 (with useIndex=true): [ { "$group" : { "_id" : "$b", "i" : { "$sum" : "$i" }, "h" : { "$sum" : "$h" }, "b" : { "$sum" : "$b" }, "d" : { "$sum" : "$d" }, "c" : { "$sum" : "$c" }, "e" : { "$sum" : "$e" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$addFields" : { "j" : "$n", "a" : "$g", "x" : "$w" } }, { "$project" : { "g" : 1, "c" : 1, "f" : 1, "b" : 1, "a" : 1, "d" : 1, "j" : "$a", "l" : "$a", "w" : 1, "y" : 1 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$addFields" : { "e" : 76, "d" : 53 } } ]

{_id: 4, b: 4, d: 53, c: 49, g: 15, y: {_id: 4, b: 16, c: 7, a: 60}, w: {a: 44, b: 19, c: 96}, a: 15, j: 15, l: 15, e: 76}

Query 23 (with useIndex=true): [ { "$addFields" : { "e" : "$f" } }, { "$match" : { "c" : { "$lte" : 79 } } }, { "$setWindowFields" : { "partitionBy" : "$e", "sortBy" : { "f" : 1, "_id" : 1 }, "output" : { "b" : { "$sum" : "$b", "window" : { "documents" : [ "current", "unbounded" ] } }, "w" : { "$min" : "$w", "window" : { "documents" : [ -2, 0 ] } } } } }, { "$sort" : { "j" : -1, "b" : -1, "_id" : 1 } }, { "$setWindowFields" : { "partitionBy" : "$h", "sortBy" : { "i" : -1, "k" : -1, "_id" : 1 }, "output" : { "d" : { "$sum" : "$d", "window" : { "documents" : [ "unbounded", "current" ] } } } } }, { "$sort" : { "j" : -1, "_id" : 1 } }, { "$project" : { "e" : "$f", "d" : "$h", "i" : "$l", "b" : 1, "g" : { "$literal" : 23 }, "c" : 1, "l" : 1, "j" : { "$literal" : 48 }, "x" : 1, "w" : 1 } }, { "$match" : { "b" : { "$lt" : 84 } } }, { "$project" : { "g" : 0 } }, { "$group" : { "_id" : "$a", "c" : { "$sum" : "$c" }, "g" : { "$sum" : "$g" }, "e" : { "$sum" : "$e" }, "h" : { "$sum" : "$h" }, "d" : { "$sum" : "$d" }, "k" : { "$sum" : "$k" }, "i" : { "$sum" : "$i" }, "f" : { "$sum" : "$f" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } } ]

{_id: null, c: 253, g: 0, e: 323, h: 0, d: 428, k: 0, i: 0, f: 0, l: 0, a: 0, b: 257, x: {a: 4, b: 40, c: 0}, y: null, w: {a: 11, b: 3, c: 9}}

Query 24 (with useIndex=true): [ { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$match" : { "d" : { "$lte" : 82 } } }, { "$addFields" : { "c" : "$k" } }, { "$addFields" : { "b" : "$q", "y" : "$y" } }, { "$project" : { "f" : 0, "x" : 0 } }, { "$addFields" : { "c" : 35, "f" : 44 } }, { "$group" : { "_id" : "$b", "a" : { "$sum" : "$a" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "c" : { "$sum" : "$c" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "f" : { "$sum" : "$f" }, "h" : { "$sum" : "$h" }, "e" : { "$sum" : "$e" }, "j" : { "$sum" : "$j" }, "d" : { "$sum" : "$d" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" } } } ]

{_id: null, a: 320, i: 324, l: 0, c: 175, b: 0, g: 139, f: 220, h: 386, e: 397, j: 0, d: 170, w: {_id: 1, b: 57, c: 58, a: 41}, x: null, y: null}

Query 25 (with useIndex=true): [ { "$addFields" : { "b" : "$j", "f" : 7 } }, { "$sort" : { "f" : -1, "_id" : 1 } }, { "$setWindowFields" : { "partitionBy" : "$d", "sortBy" : { "e" : -1, "i" : -1, "_id" : 1 }, "output" : { "e" : { "$sum" : "$e", "window" : { "documents" : [ "unbounded", "unbounded" ] } } } } }, { "$setWindowFields" : { "partitionBy" : "$c", "sortBy" : { "g" : 1, "_id" : 1 }, "output" : { "g" : { "$sum" : "$g", "window" : { "documents" : [ "unbounded", "current" ] } }, "x" : { "$min" : "$x", "window" : { "documents" : [ "unbounded", "unbounded" ] } } } } }, { "$sort" : { "d" : 1, "j" : -1, "_id" : 1 } }, { "$project" : { "e" : 0, "w" : 0 } }, { "$sort" : { "e" : 1, "_id" : 1 } }, { "$limit" : 7 }, { "$match" : { "k" : { "$gt" : 0 } } }, { "$addFields" : { "d" : 28, "k" : 82, "e" : 5 } }, { "$sort" : { "b" : -1, "_id" : 1 } }, { "$limit" : 9 } ]


Query 26 (with useIndex=true): [ { "$match" : { "i" : { "$lte" : 96 } } }, { "$addFields" : { "i" : "$f", "y" : "$y" } }, { "$project" : { "c" : 0, "d" : 0, "y" : 0 } }, { "$addFields" : { "e" : 34, "i" : "$h", "k" : 21 } }, { "$project" : { "f" : 0 } }, { "$addFields" : { "f" : 48 } }, { "$addFields" : { "l" : 72, "b" : "$c", "x" : "$y" } }, { "$project" : { "j" : 0, "x" : 0 } }, { "$addFields" : { "g" : 59, "x" : "$x" } } ]

{_id: 1, e: 34, a: 32, h: 71, g: 59, w: {a: 18, b: 25, c: 26}, i: 71, k: 21, f: 48, l: 72},
{_id: 2, e: 34, w: {a: 94, b: 32, c: 58}, i: 50, h: 50, g: 59, a: 85, k: 21, f: 48, l: 72},
{_id: 3, a: 27, h: 72, g: 59, w: {a: 11, b: 3, c: 9}, i: 72, e: 34, k: 21, f: 48, l: 72},
{_id: 4, a: 29, h: 83, g: 59, w: {a: 86, b: 75, c: 3}, i: 83, e: 34, k: 21, f: 48, l: 72},
{_id: 5, i: 75, g: 59, e: 34, a: 89, w: {a: 44, b: 19, c: 96}, h: 75, k: 21, f: 48, l: 72},
{_id: 6, e: 34, a: 85, w: {a: 10, b: 66, c: 62}, i: 71, h: 71, g: 59, k: 21, f: 48, l: 72},
{_id: 7, w: {a: 48, b: 63, c: 47}, h: 86, i: 86, g: 59, e: 34, a: 85, k: 21, f: 48, l: 72},
{_id: 8, g: 59, w: {a: 15, b: 23, c: 89}, i: 74, e: 34, a: 75, h: 74, k: 21, f: 48, l: 72}

Query 27 (with useIndex=true): [ { "$addFields" : { "j" : 79, "i" : "$a", "e" : 93 } }, { "$addFields" : { "h" : 64, "f" : 24, "l" : 31, "x" : "$y" } }, { "$project" : { "j" : 0, "d" : 0, "x" : 0 } }, { "$addFields" : { "l" : 29, "c" : "$b", "k" : 34, "w" : "$w" } } ]

{_id: 1, e: 93, a: 32, h: 64, g: 26, c: 64, w: {a: 18, b: 25, c: 26}, f: 24, b: 64, i: 32, l: 29, k: 34},
{_id: 2, e: 93, w: {a: 94, b: 32, c: 58}, i: 85, c: 21, h: 64, b: 21, g: 2, a: 85, f: 24, l: 29, k: 34},
{_id: 3, a: 27, h: 64, g: 8, c: 47, w: {a: 11, b: 3, c: 9}, f: 24, b: 47, i: 27, e: 93, l: 29, k: 34},
{_id: 4, a: 29, h: 64, g: 16, c: 76, w: {a: 86, b: 75, c: 3}, f: 24, b: 76, i: 29, e: 93, l: 29, k: 34},
{_id: 5, b: 4, i: 89, g: 15, e: 93, c: 4, a: 89, w: {a: 44, b: 19, c: 96}, h: 64, f: 24, l: 29, k: 34},
{_id: 6, f: 24, e: 93, c: 71, b: 71, a: 85, w: {a: 10, b: 66, c: 62}, i: 85, h: 64, g: 16, l: 29, k: 34},
{_id: 7, w: {a: 48, b: 63, c: 47}, h: 64, f: 24, b: 40, i: 85, g: 66, e: 93, c: 40, a: 85, l: 29, k: 34},
{_id: 8, g: 62, c: 81, w: {a: 15, b: 23, c: 89}, f: 24, b: 81, i: 75, e: 93, a: 75, h: 64, l: 29, k: 34}

Query 28 (with useIndex=true): [ { "$addFields" : { "i" : 46, "y" : "$y" } }, { "$match" : { "f" : { "$lt" : 75 } } }, { "$project" : { "j" : 1, "b" : "$j", "e" : "$k", "l" : 1, "f" : 1, "d" : 1, "g" : "$j", "c" : 1, "i" : 1, "h" : 1, "w" : 1, "x" : 1 } }, { "$sort" : { "j" : -1, "_id" : 1 } }, { "$sort" : { "i" : -1, "_id" : 1 } }, { "$sort" : { "k" : 1, "c" : 1, "_id" : 1 } }, { "$match" : { "i" : { "$gt" : 3 } } }, { "$sort" : { "c" : -1, "b" : -1, "_id" : 1 } }, { "$addFields" : { "d" : 11, "y" : "$x" } }, { "$match" : { "l" : { "$lte" : 88 } } } ]


Query 29 (with useIndex=true): [ { "$sort" : { "g" : -1, "_id" : 1 } }, { "$project" : { "c" : 1, "j" : { "$literal" : 50 }, "g" : 1, "e" : 1, "h" : "$i", "f" : { "$literal" : 35 }, "i" : 1, "l" : 1, "x" : 1, "y" : 1 } }, { "$sort" : { "b" : -1, "_id" : 1 } }, { "$addFields" : { "b" : 98, "l" : 56, "a" : 48 } }, { "$match" : { "d" : { "$lte" : 79 } } }, { "$project" : { "g" : 1, "b" : 1, "k" : "$d", "h" : 1, "e" : 1, "f" : "$j", "l" : 1, "c" : 1, "j" : 1, "d" : 1, "i" : 1, "y" : 1, "x" : 1 } }, { "$project" : { "h" : 1, "k" : "$j", "e" : 1, "g" : 1, "l" : 1, "c" : "$g", "i" : 1, "b" : 1, "y" : 1, "w" : 1 } } ]


Query 30 (with useIndex=true): [ { "$addFields" : { "l" : 30 } }, { "$match" : { "c" : { "$gte" : 11 } } }, { "$addFields" : { "d" : 19 } }, { "$addFields" : { "f" : 27, "d" : 42, "k" : 7, "x" : "$w" } }, { "$setWindowFields" : { "partitionBy" : "$a", "sortBy" : { "c" : -1, "i" : -1, "_id" : 1 }, "output" : { "f" : { "$sum" : "$f", "window" : { "documents" : [ "unbounded", "current" ] } }, "d" : { "$sum" : "$d", "window" : { "documents" : [ -2, 0 ] } } } } }, { "$addFields" : { "a" : 43, "w" : "$x" } }, { "$project" : { "f" : 0, "a" : 0, "y" : 0 } }, { "$setWindowFields" : { "partitionBy" : "$f", "sortBy" : { "j" : -1, "_id" : 1 }, "output" : { "i" : { "$sum" : "$i", "window" : { "documents" : [ -2, 2 ] } } } } } ]

{_id: 1, e: 95, h: 71, d: 42, x: {a: 18, b: 25, c: 26}, g: 26, c: 60, w: {a: 18, b: 25, c: 26}, b: 64, i: 174, l: 30, k: 7},
{_id: 2, e: 13, w: {a: 94, b: 32, c: 58}, d: 84, i: 212, c: 32, h: 50, b: 21, g: 2, x: {a: 94, b: 32, c: 58}, l: 30, k: 7},
{_id: 3, h: 72, d: 42, x: {a: 11, b: 3, c: 9}, g: 8, c: 77, w: {a: 11, b: 3, c: 9}, b: 47, i: 305, e: 40, l: 30, k: 7},
{_id: 4, h: 83, d: 42, x: {a: 86, b: 75, c: 3}, g: 16, c: 87, w: {a: 86, b: 75, c: 3}, b: 76, i: 324, e: 82, l: 30, k: 7},
{_id: 5, d: 42, b: 4, x: {a: 44, b: 19, c: 96}, i: 326, g: 15, e: 87, c: 49, w: {a: 44, b: 19, c: 96}, h: 75, l: 30, k: 7},
{_id: 6, e: 55, d: 42, c: 94, b: 71, x: {a: 10, b: 66, c: 62}, w: {a: 10, b: 66, c: 62}, i: 302, h: 71, g: 16, l: 30, k: 7},
{_id: 7, w: {a: 48, b: 63, c: 47}, h: 86, d: 126, b: 40, x: {a: 48, b: 63, c: 47}, i: 264, g: 66, e: 78, c: 11, l: 30, k: 7},
{_id: 8, g: 62, c: 24, w: {a: 15, b: 23, c: 89}, b: 81, i: 171, e: 63, h: 74, d: 42, x: {a: 15, b: 23, c: 89}, l: 30, k: 7}

Query 31 (with useIndex=true): [ { "$group" : { "_id" : "$a", "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "f" : { "$sum" : "$f" }, "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "i" : { "$sum" : "$i" }, "d" : { "$sum" : "$d" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "c" : { "$sum" : "$c" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "g" : "$s", "k" : "$f", "b" : "$k", "y" : "$x" } }, { "$addFields" : { "c" : "$q", "f" : 50, "x" : "$x" } }, { "$project" : { "b" : 0, "i" : 0, "w" : 0 } }, { "$group" : { "_id" : "$i", "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "a" : { "$sum" : "$a" }, "k" : { "$sum" : "$k" }, "f" : { "$sum" : "$f" }, "h" : { "$sum" : "$h" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "e" : { "$sum" : "$e" }, "c" : { "$sum" : "$c" }, "b" : { "$sum" : "$b" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$addFields" : { "i" : "$r", "l" : 21 } }, { "$addFields" : { "l" : "$l", "g" : "$t", "f" : "$i", "w" : "$x" } }, { "$match" : { "c" : { "$lt" : 91 } } }, { "$addFields" : { "c" : "$c", "b" : "$d", "i" : 52 } }, { "$addFields" : { "i" : 96, "f" : 60, "c" : 1, "w" : "$y" } } ]

{_id: null, d: 449, a: 507, k: 414, h: 582, l: 21, e: 0, c: 1, b: 449, w: {a: 4, b: 40, c: 0}, y: {a: 4, b: 40, c: 0}, x: {a: 4, b: 40, c: 0}, i: 96, f: 60}

Query 32 (with useIndex=true): [ { "$group" : { "_id" : "$a", "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "j" : { "$sum" : "$j" }, "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "i" : { "$sum" : "$i" }, "k" : { "$sum" : "$k" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" } } }, { "$sort" : { "k" : 1, "_id" : 1 } }, { "$sort" : { "g" : 1, "_id" : 1 } }, { "$project" : { "b" : 0, "c" : 0 } }, { "$group" : { "_id" : "$k", "f" : { "$sum" : "$f" }, "e" : { "$sum" : "$e" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "h" : { "$sum" : "$h" }, "l" : { "$sum" : "$l" }, "i" : { "$sum" : "$i" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "k" : { "$sum" : "$k" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$match" : { "g" : { "$gt" : 0 } } }, { "$match" : { "d" : { "$lte" : 98 } } }, { "$match" : { "j" : { "$lte" : 94 } } } ]


Query 33 (with useIndex=true): [ { "$match" : { "l" : { "$lt" : 81 } } }, { "$addFields" : { "c" : "$a", "a" : 14 } }, { "$match" : { "i" : { "$lt" : 91 } } }, { "$project" : { "a" : 0, "g" : 0, "x" : 0 } }, { "$addFields" : { "g" : 9, "d" : "$i", "j" : 84 } }, { "$match" : { "k" : { "$lte" : 77 } } }, { "$sort" : { "j" : 1, "i" : 1, "_id" : 1 } }, { "$limit" : 7 }, { "$sort" : { "e" : -1, "h" : -1, "_id" : 1 } }, { "$limit" : 8 }, { "$group" : { "_id" : "$g", "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "k" : { "$sum" : "$k" }, "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "l" : { "$sum" : "$l" }, "i" : { "$sum" : "$i" }, "a" : { "$sum" : "$a" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$match" : { "a" : { "$gte" : 1 } } }, { "$sort" : { "i" : -1, "d" : 1, "_id" : 1 } }, { "$limit" : 7 }, { "$match" : { "j" : { "$lte" : 80 } } } ]


Query 34 (with useIndex=true): [ { "$match" : { "i" : { "$lt" : 94 } } }, { "$addFields" : { "k" : "$r", "b" : 34, "i" : 5 } }, { "$group" : { "_id" : "$e", "k" : { "$sum" : "$k" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "b" : { "$sum" : "$b" }, "c" : { "$sum" : "$c" }, "a" : { "$sum" : "$a" }, "e" : { "$sum" : "$e" }, "l" : { "$sum" : "$l" }, "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$match" : { "d" : { "$lte" : 79 } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$project" : { "b" : { "$literal" : 39 }, "h" : 1, "d" : 1, "k" : "$f", "e" : 1, "f" : 1, "j" : 1, "g" : 1, "a" : "$k", "l" : 1, "y" : 1 } }, { "$project" : { "b" : 0 } }, { "$sort" : { "c" : 1, "_id" : 1 } }, { "$limit" : 8 }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$project" : { "b" : 0, "j" : 0, "w" : 0 } } ]


Query 35 (with useIndex=true): [ { "$project" : { "a" : 0, "d" : 0 } }, { "$setWindowFields" : { "partitionBy" : "$a", "sortBy" : { "d" : 1, "c" : 1, "_id" : 1 }, "output" : { "l" : { "$sum" : "$l", "window" : { "documents" : [ "current", "unbounded" ] } }, "w" : { "$min" : "$w", "window" : { "documents" : [ -2, 0 ] } } } } }, { "$addFields" : { "j" : 96, "w" : "$w" } }, { "$project" : { "i" : 1, "l" : "$a", "b" : 1, "f" : "$k", "d" : 1, "e" : 1, "k" : 1, "j" : 1, "h" : 1, "a" : "$e", "c" : "$h", "w" : 1 } }, { "$project" : { "h" : 0, "w" : 0 } }, { "$project" : { "b" : "$k", "h" : "$k", "g" : { "$literal" : 23 }, "d" : 1, "i" : "$k", "c" : "$h", "j" : 1, "k" : 1, "e" : 1, "y" : 1 } }, { "$group" : { "_id" : "$g", "d" : { "$sum" : "$d" }, "c" : { "$sum" : "$c" }, "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "j" : { "$sum" : "$j" }, "h" : { "$sum" : "$h" }, "g" : { "$sum" : "$g" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "i" : 65, "w" : "$y" } }, { "$addFields" : { "f" : 62, "i" : 8, "e" : 95, "w" : "$w" } } ]

{_id: 23, d: 0, c: 0, b: 0, e: 95, k: 0, l: 0, j: 768, h: 0, g: 184, y: null, x: null, w: null, i: 8, f: 62}

Query 36 (with useIndex=true): [ { "$match" : { "b" : { "$gte" : 20 } } }, { "$addFields" : { "c" : "$f", "i" : 95, "h" : 25 } }, { "$group" : { "_id" : "$f", "e" : { "$sum" : "$e" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "i" : { "$sum" : "$i" }, "j" : { "$sum" : "$j" }, "g" : { "$sum" : "$g" }, "b" : { "$sum" : "$b" }, "f" : { "$sum" : "$f" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" } } }, { "$project" : { "g" : 1, "a" : "$i", "d" : 1, "f" : 1, "e" : 1, "b" : 1, "h" : "$c", "j" : 1, "k" : 1, "w" : 1 } }, { "$match" : { "e" : { "$lte" : 91 } } } ]

{_id: 18, e: 78, k: 0, d: 65, j: 0, g: 66, b: 40, f: 18, w: {a: 48, b: 63, c: 47}, a: 95},
{_id: 4, e: 63, k: 0, d: 92, j: 0, g: 62, b: 81, f: 4, w: {a: 15, b: 23, c: 89}, a: 95},
{_id: 41, e: 55, k: 0, d: 54, j: 0, g: 16, b: 71, f: 41, w: {a: 10, b: 66, c: 62}, a: 95},
{_id: 49, e: 40, k: 0, d: 93, j: 0, g: 8, b: 47, f: 49, w: {a: 11, b: 3, c: 9}, a: 95},
{_id: 50, e: 82, k: 0, d: 34, j: 0, g: 16, b: 76, f: 50, w: {a: 86, b: 75, c: 3}, a: 95},
{_id: 98, e: 13, k: 0, d: 94, j: 0, g: 2, b: 21, f: 98, w: {a: 94, b: 32, c: 58}, a: 95}

Query 37 (with useIndex=true): [ { "$setWindowFields" : { "partitionBy" : "$b", "sortBy" : { "f" : 1, "i" : 1, "_id" : 1 }, "output" : { "l" : { "$sum" : "$l", "window" : { "documents" : [ -2, 2 ] } }, "h" : { "$sum" : "$h", "window" : { "documents" : [ "current", "unbounded" ] } }, "x" : { "$min" : "$x", "window" : { "documents" : [ -2, 0 ] } } } } }, { "$addFields" : { "d" : 22, "i" : 22, "k" : 15 } }, { "$addFields" : { "a" : 90 } }, { "$setWindowFields" : { "partitionBy" : "$h", "sortBy" : { "j" : -1, "g" : 1, "_id" : 1 }, "output" : { "i" : { "$sum" : "$i", "window" : { "documents" : [ "current", "unbounded" ] } }, "w" : { "$min" : "$w", "window" : { "documents" : [ 0, 2 ] } } } } }, { "$addFields" : { "c" : 3, "g" : 63, "w" : "$y" } }, { "$project" : { "l" : 0, "e" : 0 } }, { "$match" : { "y.a" : { "$gt" : 22 } } }, { "$addFields" : { "k" : "$h", "e" : "$s", "b" : 20, "w.b" : 51, "w.a" : 9 } }, { "$match" : { "y.c" : { "$lt" : 97 } } }, { "$match" : { "k" : { "$gte" : 7 } } }, { "$project" : { "k" : 0 } } ]


Query 38 (with useIndex=true): [ { "$addFields" : { "i" : 28, "x" : "$x" } }, { "$project" : { "d" : 0 } }, { "$project" : { "g" : 0, "f" : 0 } }, { "$addFields" : { "h" : "$s", "i" : "$j", "y.b" : 15, "y.c" : 74 } }, { "$project" : { "j" : 0, "a" : 0, "x.a" : 0, "x.c" : 0 } }, { "$addFields" : { "d" : 39, "l" : 88, "y.a" : 48 } }, { "$addFields" : { "l" : "$d", "j" : "$m", "a" : 96 } }, { "$project" : { "k" : 0 } }, { "$addFields" : { "f" : "$s", "d" : "$g", "w" : "$w" } }, { "$match" : { "x.a" : { "$lte" : 82 } } } ]


Query 39 (with useIndex=true): [ { "$match" : { "g" : { "$gte" : 24 } } }, { "$project" : { "d" : 0, "b" : 0 } }, { "$project" : { "k" : 0 } }, { "$addFields" : { "l" : 7, "d" : 89, "a" : 78, "y" : "$w" } }, { "$project" : { "l" : 0, "w.c" : 0 } }, { "$project" : { "f" : 0, "y.a" : 0, "y.b" : 0 } }, { "$addFields" : { "b" : 24, "h" : "$h" } }, { "$project" : { "c" : 0, "w" : 0 } }, { "$project" : { "d" : 0, "a" : 0 } }, { "$addFields" : { "h" : 22, "j" : 83, "d" : "$r", "y" : "$w" } }, { "$addFields" : { "c" : "$n", "h" : 68, "w" : "$w" } }, { "$addFields" : { "a" : "$j", "f" : "$t", "w" : "$w" } } ]

{_id: 1, e: 95, h: 68, x: {a: 4, b: 40, c: 0}, g: 26, i: 65, b: 24, j: 83, a: 83},
{_id: 7, h: 68, x: {a: 47, b: 88, c: 40}, i: 44, g: 66, e: 78, b: 24, j: 83, a: 83},
{_id: 8, g: 62, i: 43, e: 63, h: 68, x: {a: 9, b: 4, c: 79}, b: 24, j: 83, a: 83}

Query 40 (with useIndex=true): [ { "$project" : { "g" : 0, "d" : 0, "w" : 0 } }, { "$project" : { "e" : 0 } }, { "$match" : { "d" : { "$gte" : 19 } } }, { "$addFields" : { "j" : "$b" } }, { "$project" : { "k" : 0, "y.a" : 0 } }, { "$project" : { "d" : 0 } }, { "$project" : { "g" : 1, "k" : 1, "j" : 1, "h" : 1, "a" : 1, "d" : 1, "b" : 1, "f" : 1, "c" : 1, "e" : 1, "y.c" : 1, "x.c" : 1 } }, { "$match" : { "h" : { "$lt" : 90 } } }, { "$project" : { "i" : 1, "c" : 1, "e" : 1, "b" : 1, "f" : 1, "a" : 1, "d" : "$e", "l" : 1, "j" : "$f", "y" : 1 } }, { "$addFields" : { "j" : 58, "f" : 94, "d" : "$t" } }, { "$addFields" : { "h" : 88, "l" : 10, "w" : "$x" } } ]


Query 41 (with useIndex=true): [ { "$project" : { "c" : 1, "j" : "$j", "h" : 1, "f" : 1, "a" : "$e", "k" : 1, "b" : 1, "g" : 1, "i" : { "$literal" : 48 }, "e" : 1, "y.b" : 1, "y.c" : 1, "w.a" : 1 } }, { "$project" : { "j" : 0, "d" : 0, "w.b" : 0 } }, { "$match" : { "e" : { "$gte" : 24 } } }, { "$project" : { "f" : 0, "k" : 0, "y.c" : 0 } }, { "$addFields" : { "j" : "$r", "w" : "$w" } }, { "$project" : { "k" : 0, "f" : 0, "x" : 0 } }, { "$addFields" : { "f" : 78, "k" : 82, "y.c" : 0, "y.a" : 30 } }, { "$addFields" : { "f" : 86, "j" : 0, "i" : 1 } }, { "$match" : { "f" : { "$gt" : 1 } } }, { "$addFields" : { "i" : 87, "c" : 90, "x" : "$w" } }, { "$project" : { "b" : 0 } }, { "$addFields" : { "f" : "$q", "w.c" : 22 } } ]

{_id: 1, e: 95, h: 71, g: 26, c: 90, w: {a: 18, c: 22}, a: 95, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 18}},
{_id: 3, h: 72, g: 8, c: 90, w: {a: 11, c: 22}, e: 40, a: 40, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 11}},
{_id: 4, h: 83, g: 16, c: 90, w: {a: 86, c: 22}, e: 82, a: 82, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 86}},
{_id: 5, g: 15, e: 87, c: 90, w: {a: 44, c: 22}, h: 75, a: 87, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 44}},
{_id: 6, e: 55, c: 90, w: {a: 10, c: 22}, h: 71, g: 16, a: 55, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 10}},
{_id: 7, w: {a: 48, c: 22}, h: 86, g: 66, e: 78, c: 90, a: 78, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 48}},
{_id: 8, g: 62, c: 90, w: {a: 15, c: 22}, e: 63, h: 74, a: 63, i: 87, k: 82, y: {c: 0, a: 30}, j: 0, x: {a: 15}}

Query 42 (with useIndex=true): [ { "$addFields" : { "f" : "$o", "y" : "$x" } }, { "$addFields" : { "i" : 31, "h" : 8, "y" : "$w" } }, { "$match" : { "i" : { "$lte" : 77 } } }, { "$match" : { "k" : { "$gt" : 1 } } }, { "$addFields" : { "b" : "$n", "k" : 1, "x.c" : 9 } }, { "$match" : { "i" : { "$lte" : 98 } } }, { "$setWindowFields" : { "partitionBy" : "$j", "sortBy" : { "b" : -1, "_id" : 1 }, "output" : { "h" : { "$sum" : "$h", "window" : { "documents" : [ "unbounded", "unbounded" ] } } } } }, { "$match" : { "l" : { "$gte" : 3 } } }, { "$addFields" : { "c" : "$b", "y" : "$x" } }, { "$match" : { "i" : { "$gte" : 15 } } }, { "$project" : { "g" : 0, "w.b" : 0, "w.a" : 0 } }, { "$addFields" : { "i" : 91, "a" : "$f", "l" : 40 } } ]


Query 43 (with useIndex=true): [ { "$project" : { "d" : 0, "l" : 0, "w.a" : 0, "w.b" : 0 } }, { "$project" : { "g" : 0, "j" : 0 } }, { "$group" : { "_id" : "$i", "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "d" : { "$sum" : "$d" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "l" : { "$sum" : "$l" }, "c" : { "$sum" : "$c" }, "g" : { "$sum" : "$g" }, "e" : { "$sum" : "$e" }, "f" : { "$sum" : "$f" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "i" : "$p" } }, { "$addFields" : { "d" : "$h" } } ]

{_id: 38, h: 83, j: 0, k: 0, d: 83, a: 29, b: 76, l: 0, c: 87, g: 0, e: 82, f: 50, x: {a: 81, b: 68, c: 20}, y: null, w: {c: 3}},
{_id: 42, h: 50, j: 0, k: 0, d: 50, a: 85, b: 21, l: 0, c: 32, g: 0, e: 13, f: 98, x: {a: 8, b: 71, c: 40}, y: null, w: {c: 58}},
{_id: 43, h: 74, j: 0, k: 0, d: 74, a: 75, b: 81, l: 0, c: 24, g: 0, e: 63, f: 4, x: {a: 9, b: 4, c: 79}, y: null, w: {c: 89}},
{_id: 44, h: 86, j: 0, k: 0, d: 86, a: 85, b: 40, l: 0, c: 11, g: 0, e: 78, f: 18, x: {a: 47, b: 88, c: 40}, y: null, w: {c: 47}},
{_id: 65, h: 71, j: 0, k: 0, d: 71, a: 32, b: 64, l: 0, c: 60, g: 0, e: 95, f: 85, x: {a: 4, b: 40, c: 0}, y: null, w: {c: 26}},
{_id: 67, h: 72, j: 0, k: 0, d: 72, a: 27, b: 47, l: 0, c: 77, g: 0, e: 40, f: 49, x: {a: 19, b: 99, c: 77}, y: null, w: {c: 9}},
{_id: 84, h: 71, j: 0, k: 0, d: 71, a: 85, b: 71, l: 0, c: 94, g: 0, e: 55, f: 41, x: {a: 59, b: 36, c: 59}, y: null, w: {c: 62}},
{_id: 93, h: 75, j: 0, k: 0, d: 75, a: 89, b: 4, l: 0, c: 49, g: 0, e: 87, f: 69, x: {a: 75, b: 5, c: 70}, y: null, w: {c: 96}}

Query 44 (with useIndex=true): [ { "$addFields" : { "f" : 3, "b" : "$k", "x" : "$x" } }, { "$addFields" : { "e" : 64, "f" : "$j", "x.c" : 18 } }, { "$addFields" : { "k" : "$o", "j" : "$a", "w" : "$x" } }, { "$group" : { "_id" : "$f", "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "j" : { "$sum" : "$j" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "g" : { "$sum" : "$g" }, "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "f" : { "$sum" : "$f" }, "e" : { "$sum" : "$e" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$group" : { "_id" : "$f", "g" : { "$sum" : "$g" }, "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "b" : { "$sum" : "$b" }, "f" : { "$sum" : "$f" }, "e" : { "$sum" : "$e" }, "l" : { "$sum" : "$l" }, "d" : { "$sum" : "$d" }, "c" : { "$sum" : "$c" }, "a" : { "$sum" : "$a" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" } } }, { "$group" : { "_id" : "$c", "a" : { "$sum" : "$a" }, "i" : { "$sum" : "$i" }, "f" : { "$sum" : "$f" }, "k" : { "$sum" : "$k" }, "d" : { "$sum" : "$d" }, "j" : { "$sum" : "$j" }, "g" : { "$sum" : "$g" }, "e" : { "$sum" : "$e" }, "b" : { "$sum" : "$b" }, "c" : { "$sum" : "$c" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" } } }, { "$addFields" : { "a" : "$o", "k" : 83, "l" : "$m" } }, { "$group" : { "_id" : "$h", "a" : { "$sum" : "$a" }, "g" : { "$sum" : "$g" }, "i" : { "$sum" : "$i" }, "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "e" : { "$sum" : "$e" }, "b" : { "$sum" : "$b" }, "c" : { "$sum" : "$c" }, "d" : { "$sum" : "$d" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$project" : { "h" : 0, "e" : 0 } } ]

{_id: null, a: 0, g: 211, i: 0, j: 507, k: 83, l: 0, b: 0, c: 434, d: 449, w: {a: 4, b: 40, c: 18}, y: null, x: {a: 4, b: 40, c: 18}}

Query 45 (with useIndex=true): [ { "$addFields" : { "i" : 74, "f" : "$n", "c" : 50 } }, { "$project" : { "f" : 0, "g" : 0, "w.a" : 0 } }, { "$match" : { "g" : { "$gte" : 17 } } }, { "$match" : { "i" : { "$lte" : 96 } } }, { "$project" : { "d" : 0, "b" : 0 } }, { "$project" : { "l" : 0 } }, { "$group" : { "_id" : "$b", "d" : { "$sum" : "$d" }, "j" : { "$sum" : "$j" }, "h" : { "$sum" : "$h" }, "e" : { "$sum" : "$e" }, "b" : { "$sum" : "$b" }, "i" : { "$sum" : "$i" }, "a" : { "$sum" : "$a" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "g" : { "$sum" : "$g" }, "f" : { "$sum" : "$f" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" } } }, { "$group" : { "_id" : "$c", "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "c" : { "$sum" : "$c" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "e" : { "$sum" : "$e" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$project" : { "h" : 0, "x" : 0 } }, { "$group" : { "_id" : "$d", "j" : { "$sum" : "$j" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "l" : { "$sum" : "$l" }, "k" : { "$sum" : "$k" }, "h" : { "$sum" : "$h" }, "f" : { "$sum" : "$f" }, "g" : { "$sum" : "$g" }, "d" : { "$sum" : "$d" }, "e" : { "$sum" : "$e" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "a" : 92, "x.c" : 43, "x.b" : 20 } } ]


Query 46 (with useIndex=true): [ { "$group" : { "_id" : "$a", "g" : { "$sum" : "$g" }, "l" : { "$sum" : "$l" }, "f" : { "$sum" : "$f" }, "d" : { "$sum" : "$d" }, "c" : { "$sum" : "$c" }, "a" : { "$sum" : "$a" }, "i" : { "$sum" : "$i" }, "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$match" : { "a" : { "$gte" : 22 } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$group" : { "_id" : "$e", "j" : { "$sum" : "$j" }, "k" : { "$sum" : "$k" }, "l" : { "$sum" : "$l" }, "b" : { "$sum" : "$b" }, "d" : { "$sum" : "$d" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "g" : { "$sum" : "$g" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$project" : { "b" : 0, "k" : 0, "y" : 0 } }, { "$group" : { "_id" : "$h", "k" : { "$sum" : "$k" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "c" : { "$sum" : "$c" }, "g" : { "$sum" : "$g" }, "e" : { "$sum" : "$e" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" } ]


Query 47 (with useIndex=true): [ { "$project" : { "c" : 0, "h" : 0, "y" : 0 } }, { "$addFields" : { "l" : "$i", "a" : "$e", "i" : 22 } }, { "$setWindowFields" : { "partitionBy" : "$g", "sortBy" : { "k" : 1, "j" : 1, "_id" : 1 }, "output" : { "i" : { "$sum" : "$i", "window" : { "documents" : [ -2, 0 ] } }, "h" : { "$sum" : "$h", "window" : { "documents" : [ -2, 2 ] } } } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$addFields" : { "a" : 9, "i" : 61 } }, { "$addFields" : { "a" : "$r", "l" : "$n", "j" : 61 } } ]

{_id: 1, e: 95, d: 10, x: {a: 4, b: 40, c: 0}, g: 26, w: {_id: 1, b: 57, c: 58, a: 41}, f: 85, b: 64, i: 61, h: 0, j: 61},
{_id: 2, e: 13, w: {_id: 2, b: 12, c: 54, a: 92}, d: 94, i: 61, b: 21, g: 2, f: 98, x: {a: 8, b: 71, c: 40}, h: 0, j: 61},
{_id: 3, d: 93, x: {a: 19, b: 99, c: 77}, g: 8, w: {_id: 3, c: 99, a: 47, b: 57}, f: 49, b: 47, i: 61, e: 40, h: 0, j: 61},
{_id: 4, d: 34, x: {a: 81, b: 68, c: 20}, g: 16, w: {_id: 4, b: 16, c: 7, a: 60}, f: 50, b: 76, i: 61, e: 82, h: 0, j: 61},
{_id: 5, d: 7, b: 4, x: {a: 75, b: 5, c: 70}, i: 61, g: 15, e: 87, w: {_id: 5, a: 16, b: 71, c: 91}, f: 69, h: 0, j: 61},
{_id: 6, f: 41, e: 55, d: 54, b: 71, x: {a: 59, b: 36, c: 59}, w: {_id: 6, c: 78, a: 37, b: 67}, i: 61, g: 16, h: 0, j: 61},
{_id: 7, w: {_id: 7, a: 0, c: 4, b: 1}, f: 18, d: 65, b: 40, x: {a: 47, b: 88, c: 40}, i: 61, g: 66, e: 78, h: 0, j: 61},
{_id: 8, g: 62, w: {_id: 8, a: 14, b: 86, c: 90}, f: 4, b: 81, i: 61, e: 63, d: 92, x: {a: 9, b: 4, c: 79}, h: 0, j: 61}

Query 48 (with useIndex=true): [ { "$project" : { "i" : 1, "f" : "$g", "e" : 1, "d" : 1, "k" : 1, "g" : 1, "b" : "$j", "j" : "$k", "y.a" : 1 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$project" : { "h" : 0, "c" : 0 } }, { "$group" : { "_id" : "$d", "i" : { "$sum" : "$i" }, "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "c" : { "$sum" : "$c" }, "j" : { "$sum" : "$j" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "f" : { "$sum" : "$f" }, "k" : { "$sum" : "$k" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$addFields" : { "i" : 26, "c" : 67, "e" : "$q", "w.b" : 63, "w.a" : 26 } }, { "$addFields" : { "f" : 99, "j" : 31 } }, { "$project" : { "k" : 0, "i" : 0, "y.b" : 0, "y.c" : 0 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$addFields" : { "e" : 17, "f" : 50, "y" : "$w" } }, { "$group" : { "_id" : "$j", "k" : { "$sum" : "$k" }, "g" : { "$sum" : "$g" }, "l" : { "$sum" : "$l" }, "e" : { "$sum" : "$e" }, "c" : { "$sum" : "$c" }, "d" : { "$sum" : "$d" }, "b" : { "$sum" : "$b" }, "a" : { "$sum" : "$a" }, "h" : { "$sum" : "$h" }, "f" : { "$sum" : "$f" }, "j" : { "$sum" : "$j" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$project" : { "f" : 1, "i" : 1, "h" : 1, "e" : 1, "k" : 1, "j" : 1, "a" : 1, "c" : 1, "d" : "$d", "x" : 1 } } ]

{_id: 31, k: 0, e: 17, c: 67, a: 0, h: 0, f: 50, j: 31, x: null, d: 0}

Query 49 (with useIndex=true): [ { "$sort" : { "g" : -1, "_id" : 1 } }, { "$setWindowFields" : { "partitionBy" : "$j", "sortBy" : { "h" : -1, "_id" : 1 }, "output" : { "j" : { "$sum" : "$j", "window" : { "documents" : [ -2, 2 ] } }, "x" : { "$min" : "$x", "window" : { "documents" : [ -2, 2 ] } } } } }, { "$addFields" : { "b" : 42, "c" : 41 } }, { "$match" : { "y.b" : { "$lte" : 84 } } }, { "$project" : { "e" : 0 } }, { "$sort" : { "h" : -1, "_id" : 1 } }, { "$addFields" : { "l" : 99, "g" : "$s", "w.a" : 80, "w.b" : 92 } }, { "$match" : { "w.a" : { "$lt" : 87 } } }, { "$match" : { "w.c" : { "$gt" : 13 } } }, { "$addFields" : { "b" : 15, "e" : "$n", "y" : "$w" } } ]


Query 50 (with useIndex=true): [ { "$sort" : { "l" : -1, "_id" : 1 } }, { "$match" : { "y.b" : { "$lt" : 87 } } }, { "$match" : { "y.c" : { "$lt" : 95 } } }, { "$addFields" : { "i" : 98, "d" : "$d" } } ]


Query 51 (with useIndex=true): [ { "$project" : { "j" : 0, "g" : 0, "y.a" : 0, "y.c" : 0 } }, { "$match" : { "i" : { "$gte" : 11 } } }, { "$project" : { "d" : 0, "k" : 0 } }, { "$addFields" : { "b" : 38, "w" : "$w" } }, { "$match" : { "e" : { "$lte" : 80 } } }, { "$project" : { "e" : 0, "w.a" : 0 } } ]

{_id: 2, w: {b: 32, c: 58}, i: 42, c: 32, h: 50, b: 38, a: 85, f: 98, x: {a: 8, b: 71, c: 40}},
{_id: 3, a: 27, h: 72, x: {a: 19, b: 99, c: 77}, c: 77, w: {b: 3, c: 9}, f: 49, b: 38, i: 67},
{_id: 6, f: 41, c: 94, b: 38, a: 85, x: {a: 59, b: 36, c: 59}, w: {b: 66, c: 62}, i: 84, h: 71},
{_id: 7, w: {b: 63, c: 47}, h: 86, f: 18, b: 38, x: {a: 47, b: 88, c: 40}, i: 44, c: 11, a: 85},
{_id: 8, c: 24, w: {b: 23, c: 89}, f: 4, b: 38, i: 43, a: 75, h: 74, x: {a: 9, b: 4, c: 79}}

Query 52 (with useIndex=true): [ { "$addFields" : { "l" : 99 } }, { "$sort" : { "a" : 1, "_id" : 1 } }, { "$addFields" : { "j" : "$h", "x" : "$y" } }, { "$addFields" : { "h" : 53, "g" : 95, "c" : "$i", "y.a" : 20 } }, { "$addFields" : { "c" : 98, "w" : "$y" } }, { "$project" : { "b" : 1, "i" : 1, "l" : 1, "c" : 1, "e" : 1, "a" : 1, "f" : "$c", "g" : "$c", "j" : 1, "k" : 1, "h" : 1, "y.c" : 1 } }, { "$sort" : { "f" : -1, "_id" : 1 } }, { "$match" : { "x.c" : { "$lte" : 85 } } } ]


Query 53 (with useIndex=true): [ { "$match" : { "y.a" : { "$lt" : 83 } } }, { "$match" : { "c" : { "$gte" : 1 } } }, { "$match" : { "h" : { "$gt" : 15 } } }, { "$addFields" : { "d" : "$p" } }, { "$match" : { "w.c" : { "$gt" : 13 } } }, { "$match" : { "y.a" : { "$lt" : 80 } } }, { "$sort" : { "e" : 1, "_id" : 1 } }, { "$project" : { "a" : "$d", "j" : 1, "l" : 1, "d" : 1, "i" : "$j", "c" : "$h", "k" : 1, "e" : 1, "h" : 1, "b" : 1, "g" : 1, "w.c" : 1, "w.a" : 1 } } ]


Query 54 (with useIndex=true): [ { "$project" : { "d" : 0 } }, { "$sort" : { "f" : -1, "d" : 1, "_id" : 1 } }, { "$setWindowFields" : { "partitionBy" : "$c", "sortBy" : { "e" : -1, "j" : 1, "_id" : 1 }, "output" : { "l" : { "$sum" : "$l", "window" : { "documents" : [ "current", "unbounded" ] } }, "e" : { "$sum" : "$e", "window" : { "documents" : [ "current", "unbounded" ] } } } } }, { "$setWindowFields" : { "partitionBy" : "$e", "sortBy" : { "g" : -1, "_id" : 1 }, "output" : { "e" : { "$sum" : "$e", "window" : { "documents" : [ "unbounded", "current" ] } }, "g" : { "$sum" : "$g", "window" : { "documents" : [ 0, 2 ] } } } } }, { "$project" : { "c" : "$j", "g" : 1, "e" : 1, "f" : 1, "d" : 1, "k" : 1, "a" : 1, "j" : 1, "l" : 1, "i" : 1, "y.c" : 1, "y.a" : 1, "x.a" : 1 } }, { "$addFields" : { "h" : "$s", "x" : "$w" } }, { "$addFields" : { "l" : 52, "h" : 89, "w.a" : 74, "w.c" : 59 } }, { "$setWindowFields" : { "partitionBy" : "$l", "sortBy" : { "f" : 1, "_id" : 1 }, "output" : { "h" : { "$sum" : "$h", "window" : { "documents" : [ "unbounded", "unbounded" ] } }, "x" : { "$min" : "$x", "window" : { "documents" : [ -2, 2 ] } } } } }, { "$sort" : { "e" : 1, "d" : -1, "_id" : 1 } }, { "$project" : { "g" : "$c", "i" : 1, "j" : 1, "c" : 1, "b" : "$d", "f" : "$h", "e" : { "$literal" : 90 }, "h" : 1, "d" : 1, "x.c" : 1, "x.b" : 1, "w.c" : 1, "w.a" : 1 } } ]

{_id: 1, i: 65, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 2, i: 42, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 3, i: 67, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 4, i: 38, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 5, i: 93, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 6, i: 84, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 7, i: 44, h: 712, w: {a: 74, c: 59}, f: 712, e: 90},
{_id: 8, i: 43, h: 712, w: {a: 74, c: 59}, f: 712, e: 90}

Query 55 (with useIndex=true): [ { "$addFields" : { "k" : 93 } }, { "$match" : { "b" : { "$lt" : 80 } } }, { "$addFields" : { "l" : 29, "g" : 86 } }, { "$project" : { "l" : 0, "x" : 0 } }, { "$match" : { "y.c" : { "$gt" : 12 } } }, { "$group" : { "_id" : "$i", "c" : { "$sum" : "$c" }, "i" : { "$sum" : "$i" }, "d" : { "$sum" : "$d" }, "b" : { "$sum" : "$b" }, "k" : { "$sum" : "$k" }, "a" : { "$sum" : "$a" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$match" : { "l" : { "$gt" : 9 } } } ]


Query 56 (with useIndex=true): [ { "$addFields" : { "h" : 78, "d" : "$s", "x.c" : 88, "x.a" : 32 } }, { "$match" : { "w.b" : { "$gt" : 11 } } }, { "$match" : { "g" : { "$gt" : 24 } } }, { "$addFields" : { "i" : "$r", "h" : 68 } }, { "$group" : { "_id" : "$g", "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "d" : { "$sum" : "$d" }, "g" : { "$sum" : "$g" }, "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "c" : { "$sum" : "$c" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } } ]

{_id: 26, b: 64, e: 95, d: 0, g: 26, h: 68, j: 0, i: 0, c: 60, w: {a: 18, b: 25, c: 26}, y: null, x: {a: 32, b: 40, c: 88}},
{_id: 62, b: 81, e: 63, d: 0, g: 62, h: 68, j: 0, i: 0, c: 24, w: {a: 15, b: 23, c: 89}, y: null, x: {a: 32, b: 4, c: 88}},
{_id: 66, b: 40, e: 78, d: 0, g: 66, h: 68, j: 0, i: 0, c: 11, w: {a: 48, b: 63, c: 47}, y: null, x: {a: 32, b: 88, c: 88}}

Query 57 (with useIndex=true): [ { "$project" : { "f" : 0 } }, { "$sort" : { "a" : -1, "_id" : 1 } }, { "$addFields" : { "j" : 91 } }, { "$group" : { "_id" : "$h", "j" : { "$sum" : "$j" }, "c" : { "$sum" : "$c" }, "l" : { "$sum" : "$l" }, "k" : { "$sum" : "$k" }, "a" : { "$sum" : "$a" }, "f" : { "$sum" : "$f" }, "i" : { "$sum" : "$i" }, "h" : { "$sum" : "$h" }, "g" : { "$sum" : "$g" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } }, { "$project" : { "b" : 0 } }, { "$match" : { "y.a" : { "$lt" : 93 } } }, { "$addFields" : { "c" : "$t", "b" : 75, "y.c" : 11 } }, { "$addFields" : { "e" : "$g" } }, { "$addFields" : { "k" : "$m", "b" : "$b" } }, { "$match" : { "f" : { "$lt" : 84 } } } ]


Query 58 (with useIndex=true): [ { "$project" : { "j" : 1, "c" : 1, "k" : 1, "d" : 1, "g" : 1, "f" : 1, "b" : "$b", "l" : "$a", "e" : 1, "w" : 1 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "y" } }, { "$unwind" : "$y" }, { "$project" : { "h" : 1, "f" : 1, "g" : "$i", "l" : 1, "e" : 1, "i" : 1, "c" : "$h", "j" : 1, "w.b" : 1, "w.a" : 1, "y" : 1 } }, { "$sort" : { "h" : 1, "_id" : 1 } }, { "$group" : { "_id" : "$i", "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "c" : { "$sum" : "$c" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "e" : { "$sum" : "$e" }, "i" : { "$sum" : "$i" }, "f" : { "$sum" : "$f" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } }, { "$sort" : { "h" : -1, "_id" : 1 } }, { "$group" : { "_id" : "$l", "d" : { "$sum" : "$d" }, "b" : { "$sum" : "$b" }, "h" : { "$sum" : "$h" }, "l" : { "$sum" : "$l" }, "f" : { "$sum" : "$f" }, "g" : { "$sum" : "$g" }, "j" : { "$sum" : "$j" }, "e" : { "$sum" : "$e" }, "a" : { "$sum" : "$a" }, "k" : { "$sum" : "$k" }, "c" : { "$sum" : "$c" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } } ]

{_id: null, d: 0, b: 0, h: 0, l: 0, f: 414, g: 0, j: 0, e: 513, a: 0, k: 0, c: 0, w: {a: 10, b: 66}, y: {_id: 1, b: 57, c: 58, a: 41}, x: null}

Query 59 (with useIndex=true): [ { "$group" : { "_id" : "$f", "e" : { "$sum" : "$e" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "g" : { "$sum" : "$g" }, "l" : { "$sum" : "$l" }, "h" : { "$sum" : "$h" }, "j" : { "$sum" : "$j" }, "f" : { "$sum" : "$f" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" } } }, { "$addFields" : { "c" : 77, "x.b" : 34, "x.a" : 32 } }, { "$project" : { "e" : 1, "b" : 1, "j" : 1, "f" : 1, "h" : "$j", "g" : 1, "l" : { "$literal" : 10 }, "k" : "$d", "a" : "$c", "y.b" : 1 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "x" } }, { "$unwind" : "$x" }, { "$project" : { "i" : 0 } }, { "$project" : { "l" : 0, "f" : 0, "x.a" : 0, "x.c" : 0 } } ]

{_id: 4, e: 63, g: 62, j: 0, h: 0, k: 92, a: 77, x: {_id: 4, b: 16}}

Query 60 (with useIndex=true): [ { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "x" } }, { "$unwind" : "$x" }, { "$project" : { "e" : 0, "j" : 0, "y" : 0 } }, { "$sort" : { "d" : 1, "_id" : 1 } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" } ]

{_id: 1, a: 32, h: 71, d: 10, x: {_id: 1, b: 57, c: 58, a: 41}, g: 26, c: 60, w: {_id: 1, b: 57, c: 58, a: 41}, f: 85, b: 64, i: 65},
{_id: 2, w: {_id: 2, b: 12, c: 54, a: 92}, d: 94, i: 42, c: 32, h: 50, b: 21, g: 2, a: 85, f: 98, x: {_id: 2, b: 12, c: 54, a: 92}},
{_id: 3, a: 27, h: 72, d: 93, x: {_id: 3, c: 99, a: 47, b: 57}, g: 8, c: 77, w: {_id: 3, c: 99, a: 47, b: 57}, f: 49, b: 47, i: 67},
{_id: 4, a: 29, h: 83, d: 34, x: {_id: 4, b: 16, c: 7, a: 60}, g: 16, c: 87, w: {_id: 4, b: 16, c: 7, a: 60}, f: 50, b: 76, i: 38},
{_id: 5, d: 7, b: 4, x: {_id: 5, a: 16, b: 71, c: 91}, i: 93, g: 15, c: 49, a: 89, w: {_id: 5, a: 16, b: 71, c: 91}, h: 75, f: 69},
{_id: 6, f: 41, d: 54, c: 94, b: 71, a: 85, x: {_id: 6, c: 78, a: 37, b: 67}, w: {_id: 6, c: 78, a: 37, b: 67}, i: 84, h: 71, g: 16},
{_id: 7, w: {_id: 7, a: 0, c: 4, b: 1}, h: 86, f: 18, d: 65, b: 40, x: {_id: 7, a: 0, c: 4, b: 1}, i: 44, g: 66, c: 11, a: 85},
{_id: 8, g: 62, c: 24, w: {_id: 8, a: 14, b: 86, c: 90}, f: 4, b: 81, i: 43, a: 75, h: 74, d: 92, x: {_id: 8, a: 14, b: 86, c: 90}}

Query 61 (with useIndex=true): [ { "$addFields" : { "b" : "$q" } }, { "$addFields" : { "i" : 16, "b" : 57, "w" : "$y" } }, { "$addFields" : { "g" : "$l", "w.c" : 93, "w.a" : 97 } }, { "$match" : { "f" : { "$gt" : 1 } } }, { "$match" : { "b" : { "$gte" : 2 } } }, { "$addFields" : { "d" : 29, "h" : "$d" } }, { "$setWindowFields" : { "partitionBy" : "$b", "sortBy" : { "a" : -1, "_id" : 1 }, "output" : { "e" : { "$sum" : "$e", "window" : { "documents" : [ -2, 2 ] } } } } }, { "$addFields" : { "a" : 56, "b" : 74, "d" : "$f", "y" : "$x" } }, { "$match" : { "w.c" : { "$gte" : 1 } } }, { "$match" : { "e" : { "$gte" : 12 } } } ]

{_id: 1, e: 358, a: 56, h: 10, d: 85, x: {a: 4, b: 40, c: 0}, c: 60, f: 85, i: 16, b: 74, w: {c: 93, a: 97}, y: {a: 4, b: 40, c: 0}},
{_id: 2, e: 233, d: 98, i: 16, c: 32, h: 94, a: 56, f: 98, x: {a: 8, b: 71, c: 40}, b: 74, w: {c: 93, a: 97}, y: {a: 8, b: 71, c: 40}},
{_id: 3, a: 56, h: 93, d: 49, x: {a: 19, b: 99, c: 77}, c: 77, f: 49, i: 16, e: 217, b: 74, w: {c: 93, a: 97}, y: {a: 19, b: 99, c: 77}},
{_id: 4, a: 56, h: 34, d: 50, x: {a: 81, b: 68, c: 20}, c: 87, f: 50, i: 16, e: 280, b: 74, w: {c: 93, a: 97}, y: {a: 81, b: 68, c: 20}},
{_id: 5, d: 69, x: {a: 75, b: 5, c: 70}, i: 16, e: 155, c: 49, a: 56, h: 7, f: 69, b: 74, w: {c: 93, a: 97}, y: {a: 75, b: 5, c: 70}},
{_id: 6, f: 41, e: 296, d: 41, c: 94, a: 56, x: {a: 59, b: 36, c: 59}, i: 16, h: 54, b: 74, w: {c: 93, a: 97}, y: {a: 59, b: 36, c: 59}},
{_id: 7, h: 65, f: 18, d: 18, x: {a: 47, b: 88, c: 40}, i: 16, e: 304, c: 11, a: 56, b: 74, w: {c: 93, a: 97}, y: {a: 47, b: 88, c: 40}},
{_id: 8, c: 24, f: 4, i: 16, e: 373, a: 56, h: 92, d: 4, x: {a: 9, b: 4, c: 79}, b: 74, w: {c: 93, a: 97}, y: {a: 9, b: 4, c: 79}}

Query 62 (with useIndex=true): [ { "$addFields" : { "f" : "$r", "b" : 11 } }, { "$match" : { "y.b" : { "$lte" : 97 } } }, { "$addFields" : { "f" : 73, "c" : 64 } }, { "$addFields" : { "e" : 96, "g" : 10, "w" : "$x" } }, { "$sort" : { "i" : 1, "_id" : 1 } }, { "$limit" : 7 } ]


Query 63 (with useIndex=true): [ { "$match" : { "x.a" : { "$lt" : 98 } } }, { "$project" : { "k" : 0, "e" : 0 } }, { "$project" : { "h" : 0, "l" : 0, "w" : 0 } }, { "$match" : { "i" : { "$lt" : 85 } } }, { "$sort" : { "i" : -1, "_id" : 1 } }, { "$limit" : 5 } ]

{_id: 1, a: 32, d: 10, x: {a: 4, b: 40, c: 0}, g: 26, c: 60, f: 85, b: 64, i: 65},
{_id: 3, a: 27, d: 93, x: {a: 19, b: 99, c: 77}, g: 8, c: 77, f: 49, b: 47, i: 67},
{_id: 6, f: 41, d: 54, c: 94, b: 71, a: 85, x: {a: 59, b: 36, c: 59}, i: 84, g: 16},
{_id: 7, f: 18, d: 65, b: 40, x: {a: 47, b: 88, c: 40}, i: 44, g: 66, c: 11, a: 85},
{_id: 8, g: 62, c: 24, f: 4, b: 81, i: 43, a: 75, d: 92, x: {a: 9, b: 4, c: 79}}

Query 64 (with useIndex=true): [ { "$sort" : { "i" : 1, "g" : 1, "_id" : 1 } }, { "$limit" : 5 }, { "$addFields" : { "d" : "$d", "j" : 63, "a" : 47 } }, { "$project" : { "b" : "$b", "h" : 1, "l" : "$k", "k" : 1, "a" : 1, "i" : 1, "c" : { "$literal" : 2 }, "g" : 1, "j" : "$a", "e" : "$d", "f" : 1, "w.c" : 1, "y" : 1 } }, { "$addFields" : { "b" : 42, "g" : 91, "j" : 47 } }, { "$project" : { "a" : 0, "j" : 0 } }, { "$sort" : { "c" : 1, "k" : -1, "_id" : 1 } }, { "$match" : { "y.a" : { "$gt" : 24 } } }, { "$project" : { "l" : 0, "x.a" : 0, "x.c" : 0 } } ]


Query 65 (with useIndex=true): [ { "$sort" : { "i" : -1, "_id" : 1 } }, { "$limit" : 6 }, { "$match" : { "w.b" : { "$gte" : 9 } } }, { "$addFields" : { "b" : 79, "a" : 39, "d" : 28 } }, { "$sort" : { "l" : -1, "i" : 1, "_id" : 1 } }, { "$limit" : 5 }, { "$addFields" : { "g" : "$h", "k" : 34 } }, { "$addFields" : { "f" : "$s" } }, { "$addFields" : { "l" : "$a", "k" : 34, "x.b" : 12 } }, { "$addFields" : { "f" : "$d", "e" : "$l", "x" : "$x" } }, { "$match" : { "j" : { "$lte" : 84 } } }, { "$project" : { "g" : 0, "w" : 0 } } ]


Query 66 (with useIndex=true): [ { "$sort" : { "c" : -1, "f" : 1, "_id" : 1 } }, { "$project" : { "i" : "$g", "h" : 1, "d" : 1, "l" : 1, "e" : 1, "g" : 1, "k" : 1, "b" : 1, "c" : "$b", "a" : 1, "j" : 1, "w" : 1 } }, { "$project" : { "b" : 1, "j" : 1, "e" : 1, "l" : 1, "c" : 1, "i" : 1, "f" : 1, "h" : 1, "a" : "$f", "x.a" : 1, "y.c" : 1 } }, { "$addFields" : { "f" : 80, "g" : "$f", "e" : 71, "w.b" : 44, "w.c" : 77 } }, { "$addFields" : { "a" : "$f", "g" : 46, "k" : 70 } } ]

{_id: 1, l: null, j: null, h: 71, e: 71, b: 64, i: 26, c: 64, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 2, l: null, j: null, h: 50, e: 71, b: 21, i: 2, c: 21, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 3, l: null, j: null, h: 72, e: 71, b: 47, i: 8, c: 47, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 4, l: null, j: null, h: 83, e: 71, b: 76, i: 16, c: 76, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 5, l: null, j: null, h: 75, e: 71, b: 4, i: 15, c: 4, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 6, l: null, j: null, h: 71, e: 71, b: 71, i: 16, c: 71, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 7, l: null, j: null, h: 86, e: 71, b: 40, i: 66, c: 40, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70},
{_id: 8, l: null, j: null, h: 74, e: 71, b: 81, i: 62, c: 81, f: 80, w: {b: 44, c: 77}, a: 80, g: 46, k: 70}

Query 67 (with useIndex=true): [ { "$addFields" : { "b" : "$d", "w.a" : 44 } }, { "$addFields" : { "j" : 57, "y.c" : 60, "y.a" : 75 } }, { "$sort" : { "l" : -1, "_id" : 1 } }, { "$limit" : 7 }, { "$project" : { "b" : 0, "c" : 0, "y" : 0 } }, { "$match" : { "y.a" : { "$lte" : 96 } } }, { "$sort" : { "e" : 1, "_id" : 1 } }, { "$limit" : 8 }, { "$project" : { "i" : 0, "x" : 0 } } ]


Query 68 (with useIndex=true): [ { "$sort" : { "b" : -1, "_id" : 1 } }, { "$group" : { "_id" : "$f", "k" : { "$sum" : "$k" }, "e" : { "$sum" : "$e" }, "j" : { "$sum" : "$j" }, "i" : { "$sum" : "$i" }, "g" : { "$sum" : "$g" }, "f" : { "$sum" : "$f" }, "d" : { "$sum" : "$d" }, "b" : { "$sum" : "$b" }, "h" : { "$sum" : "$h" }, "a" : { "$sum" : "$a" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$project" : { "j" : 0 } }, { "$match" : { "w.a" : { "$gte" : 19 } } }, { "$group" : { "_id" : "$i", "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "g" : { "$sum" : "$g" }, "f" : { "$sum" : "$f" }, "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "i" : { "$sum" : "$i" }, "e" : { "$sum" : "$e" }, "j" : { "$sum" : "$j" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" }, "w" : { "$min" : "$w" } } }, { "$addFields" : { "a" : 18, "h" : "$b", "j" : 19, "w.c" : 80 } }, { "$group" : { "_id" : "$d", "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "f" : { "$sum" : "$f" }, "b" : { "$sum" : "$b" }, "e" : { "$sum" : "$e" }, "g" : { "$sum" : "$g" }, "h" : { "$sum" : "$h" }, "k" : { "$sum" : "$k" }, "d" : { "$sum" : "$d" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } }, { "$addFields" : { "j" : 15, "a" : "$t" } }, { "$project" : { "d" : 0, "i" : 0, "y" : 0 } } ]

{_id: null, l: 0, f: 235, b: 141, e: 260, g: 99, h: 141, k: 0, w: {a: 44, b: 19, c: 80}, x: {a: 8, b: 71, c: 40}, j: 15}

Query 69 (with useIndex=true): [ { "$group" : { "_id" : "$b", "d" : { "$sum" : "$d" }, "h" : { "$sum" : "$h" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "b" : { "$sum" : "$b" }, "f" : { "$sum" : "$f" }, "i" : { "$sum" : "$i" }, "g" : { "$sum" : "$g" }, "k" : { "$sum" : "$k" }, "e" : { "$sum" : "$e" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" } } }, { "$addFields" : { "i" : 96, "y" : "$x" } }, { "$sort" : { "i" : -1, "_id" : 1 } }, { "$limit" : 7 }, { "$addFields" : { "h" : 26, "x" : "$x" } }, { "$group" : { "_id" : "$h", "k" : { "$sum" : "$k" }, "h" : { "$sum" : "$h" }, "g" : { "$sum" : "$g" }, "f" : { "$sum" : "$f" }, "j" : { "$sum" : "$j" }, "a" : { "$sum" : "$a" }, "e" : { "$sum" : "$e" }, "i" : { "$sum" : "$i" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$group" : { "_id" : "$g", "k" : { "$sum" : "$k" }, "e" : { "$sum" : "$e" }, "g" : { "$sum" : "$g" }, "b" : { "$sum" : "$b" }, "i" : { "$sum" : "$i" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "h" : { "$sum" : "$h" }, "f" : { "$sum" : "$f" }, "j" : { "$sum" : "$j" }, "d" : { "$sum" : "$d" }, "x" : { "$min" : "$x" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" } } }, { "$group" : { "_id" : "$d", "j" : { "$sum" : "$j" }, "a" : { "$sum" : "$a" }, "i" : { "$sum" : "$i" }, "h" : { "$sum" : "$h" }, "c" : { "$sum" : "$c" }, "d" : { "$sum" : "$d" }, "g" : { "$sum" : "$g" }, "b" : { "$sum" : "$b" }, "k" : { "$sum" : "$k" }, "w" : { "$min" : "$w" }, "y" : { "$min" : "$y" }, "x" : { "$min" : "$x" } } }, { "$match" : { "y.a" : { "$gte" : 3 } } }, { "$sort" : { "f" : 1, "_id" : 1 } }, { "$match" : { "g" : { "$gt" : 11 } } } ]

{_id: 0, j: 0, a: 432, i: 672, h: 182, c: 0, d: 0, g: 149, b: 0, k: 0, w: {a: 10, b: 66, c: 62}, y: {a: 4, b: 40, c: 0}, x: {a: 4, b: 40, c: 0}}

Query 70 (with useIndex=true): [ { "$addFields" : { "c" : "$m", "h" : 73 } }, { "$project" : { "k" : 1, "h" : 1, "b" : "$f", "j" : 1, "d" : "$k", "i" : 1, "e" : "$a", "g" : 1, "f" : 1, "c" : 1, "x.a" : 1, "x.c" : 1, "y.c" : 1 } }, { "$project" : { "c" : "$b", "i" : "$a", "e" : 1, "j" : 1, "b" : 1, "l" : 1, "f" : 1, "d" : 1, "x.a" : 1, "x.c" : 1 } }, { "$match" : { "x.a" : { "$gte" : 21 } } }, { "$project" : { "f" : 1, "c" : 1, "e" : 1, "i" : 1, "l" : 1, "d" : 1, "k" : 1, "h" : 1, "b" : 1, "j" : 1, "w.b" : 1, "w.a" : 1 } }, { "$project" : { "h" : 0, "f" : 0, "w.a" : 0 } }, { "$match" : { "y.a" : { "$gte" : 14 } } }, { "$match" : { "k" : { "$gte" : 17 } } }, { "$addFields" : { "d" : 80, "k" : "$h", "y" : "$w" } } ]


Query 71 (with useIndex=true): [ { "$addFields" : { "c" : 76, "i" : 4 } }, { "$match" : { "y.a" : { "$gte" : 23 } } }, { "$sort" : { "f" : -1, "h" : 1, "_id" : 1 } }, { "$match" : { "k" : { "$gt" : 4 } } }, { "$sort" : { "f" : -1, "i" : 1, "_id" : 1 } }, { "$limit" : 10 }, { "$project" : { "k" : 1, "a" : 1, "g" : 1, "f" : "$d", "i" : "$a", "d" : 1, "c" : { "$literal" : 6 }, "l" : { "$literal" : 52 }, "w" : 1, "x" : 1 } }, { "$match" : { "x.c" : { "$lt" : 77 } } }, { "$lookup" : { "from" : "complex_pipelines_foreign", "localField" : "_id", "foreignField" : "_id", "as" : "w" } }, { "$unwind" : "$w" }, { "$setWindowFields" : { "partitionBy" : "$c", "sortBy" : { "c" : -1, "_id" : 1 }, "output" : { "k" : { "$sum" : "$k", "window" : { "documents" : [ "unbounded", "unbounded" ] } }, "i" : { "$sum" : "$i", "window" : { "documents" : [ -2, 0 ] } }, "y" : { "$min" : "$y", "window" : { "documents" : [ "current", "unbounded" ] } } } } }, { "$match" : { "e" : { "$lte" : 87 } } } ]


Query 72 (with useIndex=true): [ { "$sort" : { "c" : -1, "_id" : 1 } }, { "$limit" : 7 }, { "$match" : { "b" : { "$lte" : 94 } } }, { "$project" : { "j" : 1, "g" : 1, "i" : 1, "k" : "$h", "b" : 1, "h" : 1, "c" : 1, "l" : 1, "d" : 1, "y.a" : 1, "y.b" : 1 } }, { "$project" : { "l" : 0, "k" : 0 } }, { "$match" : { "w.b" : { "$gte" : 8 } } }, { "$match" : { "g" : { "$gte" : 16 } } }, { "$addFields" : { "i" : 41, "l" : 24, "c" : 16 } }, { "$group" : { "_id" : "$e", "e" : { "$sum" : "$e" }, "l" : { "$sum" : "$l" }, "a" : { "$sum" : "$a" }, "d" : { "$sum" : "$d" }, "f" : { "$sum" : "$f" }, "j" : { "$sum" : "$j" }, "b" : { "$sum" : "$b" }, "i" : { "$sum" : "$i" }, "c" : { "$sum" : "$c" }, "g" : { "$sum" : "$g" }, "y" : { "$min" : "$y" }, "w" : { "$min" : "$w" }, "x" : { "$min" : "$x" } } } ]


