// This test shows that --no-opt still allows $geo and $text queries to work.
optOff
test
optOff.coll as fuzzer_coll
optOff.coll as fuzzer_coll_lookup

:sortFull {aggregate: "fuzzer_coll", pipeline: [ { "$sort" : { "_id" : 1 } }, { "$limit" : 10 }, { "$unionWith" : { "coll" : "fuzzer_coll_lookup", "pipeline" : [ { "$sort" : { "_id" : 1 } }, { "$limit" : 10 }, { "$facet" : { "array" : [ { "$replaceRoot" : { "newRoot" : { "k" : "Kenyan Shilling bypassing", "v" : { "$ifNull" : [ "$obj.obj.num", null ] } } } } ] } } ] } } ], cursor: {   }, maxTimeMS: 30000}

:sortFull {aggregate: "fuzzer_coll", pipeline: [ { "$sort" : { "_id" : 1 } }, { "$limit" : 10 }, { "$lookup" : { "from" : "fuzzer_small_coll", "localField" : "obj", "foreignField" : "obj.obj.obj.obj", "as" : "array" } } ], cursor: {   }, maxTimeMS: 30000}

:sortFull {aggregate: "fuzzer_coll", pipeline: [ { "$match" : { "$and" : [ { "$text" : { "$search" : "Comoro Franc" } }, { "obj.obj.obj.obj.bool" : { "$gt" : false } }, { "str" : { "$regex" : "(?:Bolivar Fuer|Grani)te|p(?:roductize|ayment)|bandwidth", "$options" : "" } }, { "$or" : [ { "$or" : [ { "obj.obj.obj.obj.num" : { "$lt" : 95093 } }, { "$or" : [ { "obj.obj.obj.obj.str" : { "$regex" : /overriding/ } } ] }, { "$and" : [ { "$or" : [ { "obj.obj.obj.date" : { "$ne" : ISODate("2019-07-26T05:48:49.777Z") } }, { "$or" : [ { "obj.obj.date" : { "$gte" : ISODate("2019-04-04T00:53:54.773Z") } }, { "obj.array" : { "$elemMatch" : { "$lte" : true, "$gt" : [ { "str" : "Cross-group Salad" }, ISODate("2019-06-30T17:00:02.777Z"), ISODate("2019-01-20T09:08:31.699Z"), false, { "num" : NumberInt(70139) } ], "$eq" : [ "Future Concrete", { "num" : NumberDecimal("NaN") }, [ NumberInt(-314159295), NumberInt(-30) ], "Practical Plastic Chicken card heuristic" ] } } } ] } ] } ] } ] }, { "$and" : [ { "$or" : [ { "bool" : { "$gt" : false } } ] }, { "$or" : [ { "obj.obj.obj.obj.array" : { "$gte" : [ {  }, /Home Loan Account/, { "array" : [ ] }, [ ISODate("2019-09-21T07:33:35.008Z"), ISODate("2019-06-18T20:22:55.249Z") ] ] } } ] } ] }, { "$or" : [ { "obj.geoJson" : { "$nin" : [ ] } } ] } ] }, { "obj.date" : { "$not" : { "$gte" : ISODate("2019-10-01T00:17:26.915Z") } } } ] } }, { "$sort" : { "_id" : 1 } }, { "$limit" : 10 }, { "$facet" : { "array" : [ { "$sort" : { "_id" : 1 } }, { "$sortByCount" : { "$unsetField" : { "field" : "obj.obj.date", "input" : { "date" : ISODate("2019-03-28T09:44:57.458Z") } } } } ] } } ], cursor: {   }, maxTimeMS: 30000}

:sortFull {aggregate: "fuzzer_coll", pipeline: [ { "$geoNear" : { "distanceField" : "obj.obj.num", "near" : [ 164.48728842950652, -36.28977510035053 ], "distanceMultiplier" : 5, "maxDistance" : 2840, "query" : { "$or" : [ { "$and" : [ { "obj.obj.obj.array" : { "$elemMatch" : { "$lt" : [ 314159265, true, 2147483647, [ { "date" : ISODate("2019-10-26T05:48:08.059Z") }, false, NumberDecimal("579.2032279014841"), NumberInt(9078) ], [ ] ], "$eq" : false, "$ne" : false } } } ] }, { "obj.obj.obj.obj.num" : { "$not" : { "$gte" : NumberLong(93735) } } }, { "$and" : [ { "$or" : [ { "obj.obj.geoJson" : { "$not" : { "$nin" : [ NumberInt(43473), "Syrian Pound collaborative", false ] } } } ] }, { "obj.obj.obj.obj.bool" : { "$lt" : true } }, { "obj.obj.obj.num" : { "$bitsAllClear" : [ NumberLong(2), 8, NumberLong(11), NumberLong(12) ] } }, { "obj.obj.num" : { "$not" : { "$bitsAllSet" : 10100100 } } } ] }, { "$expr" : { "$arrayToObject" : [ [ { "k" : "parsing feed Generic", "v" : { "$ifNull" : [ "Massachusetts El Salvador Colon US Dollar", null ] } }, { "k" : "redefine", "v" : { "$ifNull" : [ "$obj.obj.obj.obj.obj.num", null ] } } ] ] } } ] } } }, { "$match" : { "$or" : [ { "$or" : [ { "obj.obj.obj.obj.obj.num" : { "$ne" : NumberDecimal("200.1147041100685") } }, { "obj.obj.obj.obj.obj.obj" : { "$not" : { "$type" : "dbPointer" } } }, { "$and" : [ { "array" : { "$gt" : [ ISODate("2019-04-19T12:27:18.291Z"), ISODate("2019-03-21T17:41:40.367Z"), true, ISODate("2019-11-18T21:50:14.441Z") ] } } ] } ] }, { "$or" : [ { "$nor" : [ { "obj.obj.obj.obj.obj.obj.any" : { "$not" : { "$exists" : true } } }, { "obj.obj.obj.obj.obj.obj.num" : { "$bitsAllSet" : NumberInt(11110111) } } ] } ] }, { "obj.obj.date" : { "$lte" : ISODate("2019-11-17T15:20:11.013Z") } }, { "$and" : [ { "obj.obj.obj.obj.obj.array" : { "$not" : { "$size" : 8 } } }, { "obj.str" : { "$regex" : /^Future\-proofed|e\-services|Harbor|Tools|copy/, "$options" : "" } } ] }, { "$or" : [ { "obj.obj.obj.array" : { "$ne" : [ /^solution\-oriented|o(?:bject\-oriented|verriding)|Senior/, 0, "Credit Card Account", { "num" : NumberDecimal("9.999999999999999999999999999999999E+6144"), "obj" : { "num" : NumberLong("314159265358979303") }, "str" : "Macedonia proactive" } ] } } ] } ] } }, { "$replaceWith" : "$$ROOT" } ], cursor: {   }, maxTimeMS: 30000, collation: {  "locale" : "ko" }}

:sortFull {aggregate: 1, pipeline: [ { "$documents" : [ { "$ifNull" : [ "$obj.obj.obj.obj", {  } ] } ] }, { "$addFields" : { "sortVal" : "$$ROOT" } }, { "$sort" : { "sortVal" : 1 } }, { "$project" : { "sortVal" : 0 } }, { "$setWindowFields" : { "partitionBy" : { "$arrayToObject" : [ [ { "k" : "Functionality backing up relationships", "v" : { "$ifNull" : [ "$obj.obj.obj.str", null ] } } ] ] }, "sortBy" : { "date" : 1 }, "output" : { "obj.obj.obj.date" : { "$max" : { "$max" : [ ISODate("0001-01-01T00:00:00Z"), { "$dateFromParts" : { "isoWeekYear" : NumberLong(13), "isoWeek" : 8, "hour" : 16, "minute" : NumberLong(12), "timezone" : "America/St_Kitts" } } ] } }, "num" : { "$rank" : {  } } } } }, { "$sort" : { "_id" : 1 } }, { "$limit" : 50 } ], cursor: {   }, maxTimeMS: 30000}
