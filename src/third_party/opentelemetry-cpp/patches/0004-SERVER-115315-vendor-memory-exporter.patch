diff --git a/src/third_party/opentelemetry-cpp/dist/exporters/memory/BUILD b/src/third_party/opentelemetry-cpp/dist/exporters/memory/BUILD
index 033c85d3698..377d6025f77 100644
--- a/src/third_party/opentelemetry-cpp/dist/exporters/memory/BUILD
+++ b/src/third_party/opentelemetry-cpp/dist/exporters/memory/BUILD
@@ -1,10 +1,14 @@
 # Copyright The OpenTelemetry Authors
 # SPDX-License-Identifier: Apache-2.0
 
+load("//bazel:mongo_src_rules.bzl", "mongo_cc_library")
+load("//src/third_party/opentelemetry-cpp:otel_rules.bzl", "OTEL_COPTS", "OTEL_TARGET_COMPATIBLE_WITH")
+
 package(default_visibility = ["//visibility:public"])
 
-cc_library(
+mongo_cc_library(
     name = "in_memory_metric_data",
+    testonly = True,
     srcs = [
         "src/in_memory_metric_data.cc",
     ],
@@ -16,27 +20,17 @@ cc_library(
         "memory",
         "test",
     ],
+    target_compatible_with = OTEL_TARGET_COMPATIBLE_WITH,
+    copts = OTEL_COPTS,
     deps = [
         ":in_memory_data",
-        "//sdk/src/metrics",
-    ],
-)
-
-cc_test(
-    name = "in_memory_metric_data_test",
-    srcs = ["test/in_memory_metric_data_test.cc"],
-    tags = [
-        "memory",
-        "test",
-    ],
-    deps = [
-        ":in_memory_metric_data",
-        "@com_google_googletest//:gtest_main",
+        "//src/third_party/opentelemetry-cpp/sdk/src/metrics",
     ],
 )
 
-cc_library(
+mongo_cc_library(
     name = "in_memory_metric_exporter_factory",
+    testonly = True,
     srcs = [
         "src/in_memory_metric_exporter_factory.cc",
     ],
@@ -48,67 +42,50 @@ cc_library(
         "memory",
         "test",
     ],
+    target_compatible_with = OTEL_TARGET_COMPATIBLE_WITH,
+    copts = OTEL_COPTS,
     deps = [
         ":in_memory_metric_data",
-        "//sdk/src/metrics",
-    ],
-)
-
-cc_test(
-    name = "in_memory_metric_exporter_test",
-    srcs = ["test/in_memory_metric_exporter_test.cc"],
-    tags = [
-        "memory",
-        "test",
-    ],
-    deps = [
-        ":in_memory_metric_exporter_factory",
-        "@com_google_googletest//:gtest_main",
+        "//src/third_party/opentelemetry-cpp/sdk/src/metrics",
     ],
 )
 
-cc_library(
+mongo_cc_library(
     name = "in_memory_data",
+    testonly = True,
     hdrs = [
         "include/opentelemetry/exporters/memory/in_memory_data.h",
     ],
     strip_include_prefix = "include",
     tags = ["memory"],
+    target_compatible_with = OTEL_TARGET_COMPATIBLE_WITH,
+    copts = OTEL_COPTS,
     deps = [
-        "//sdk:headers",
+        "//src/third_party/opentelemetry-cpp/sdk/src/metrics",
     ],
 )
 
-cc_library(
+mongo_cc_library(
     name = "in_memory_span_data",
+    testonly = True,
     hdrs = [
         "include/opentelemetry/exporters/memory/in_memory_span_data.h",
     ],
     strip_include_prefix = "include",
     tags = ["memory"],
+    target_compatible_with = OTEL_TARGET_COMPATIBLE_WITH,
+    copts = OTEL_COPTS,
     deps = [
         ":in_memory_data",
-        "//api",
-        "//sdk/src/resource",
-        "//sdk/src/trace",
+        "//src/third_party/opentelemetry-cpp/api",
+        "//src/third_party/opentelemetry-cpp/sdk/src/resource",
+        "//src/third_party/opentelemetry-cpp/sdk/src/trace",
     ],
 )
 
-cc_test(
-    name = "in_memory_span_data_test",
-    srcs = ["test/in_memory_span_data_test.cc"],
-    tags = [
-        "memory",
-        "test",
-    ],
-    deps = [
-        ":in_memory_span_data",
-        "@com_google_googletest//:gtest_main",
-    ],
-)
-
-cc_library(
+mongo_cc_library(
     name = "in_memory_span_exporter",
+    testonly = True,
     srcs = [
         "src/in_memory_span_exporter_factory.cc",
     ],
@@ -121,21 +98,10 @@ cc_library(
         "memory",
         "test",
     ],
+    target_compatible_with = OTEL_TARGET_COMPATIBLE_WITH,
+    copts = OTEL_COPTS,
     deps = [
         ":in_memory_span_data",
-        "//sdk/src/trace",
-    ],
-)
-
-cc_test(
-    name = "in_memory_span_exporter_test",
-    srcs = ["test/in_memory_span_exporter_test.cc"],
-    tags = [
-        "memory",
-        "test",
-    ],
-    deps = [
-        ":in_memory_span_exporter",
-        "@com_google_googletest//:gtest_main",
+        "//src/third_party/opentelemetry-cpp/sdk/src/trace",
     ],
 )
