load("//bazel:mongo_src_rules.bzl", "mongo_cc_library")

package(default_visibility = ["//visibility:public"])

mongo_cc_library(
    name = "yaml",
    srcs = [
        "yaml-cpp/src/binary.cpp",
        "yaml-cpp/src/collectionstack.h",
        "yaml-cpp/src/convert.cpp",
        "yaml-cpp/src/directives.cpp",
        "yaml-cpp/src/directives.h",
        "yaml-cpp/src/emit.cpp",
        "yaml-cpp/src/emitfromevents.cpp",
        "yaml-cpp/src/emitter.cpp",
        "yaml-cpp/src/emitterstate.cpp",
        "yaml-cpp/src/emitterstate.h",
        "yaml-cpp/src/emitterutils.cpp",
        "yaml-cpp/src/emitterutils.h",
        "yaml-cpp/src/exceptions.cpp",
        "yaml-cpp/src/exp.cpp",
        "yaml-cpp/src/exp.h",
        "yaml-cpp/src/indentation.h",
        "yaml-cpp/src/memory.cpp",
        "yaml-cpp/src/node.cpp",
        "yaml-cpp/src/node_data.cpp",
        "yaml-cpp/src/nodebuilder.cpp",
        "yaml-cpp/src/nodebuilder.h",
        "yaml-cpp/src/nodeevents.cpp",
        "yaml-cpp/src/nodeevents.h",
        "yaml-cpp/src/null.cpp",
        "yaml-cpp/src/ostream_wrapper.cpp",
        "yaml-cpp/src/parse.cpp",
        "yaml-cpp/src/parser.cpp",
        "yaml-cpp/src/ptr_vector.h",
        "yaml-cpp/src/regex_yaml.cpp",
        "yaml-cpp/src/regex_yaml.h",
        "yaml-cpp/src/regeximpl.h",
        "yaml-cpp/src/scanner.cpp",
        "yaml-cpp/src/scanner.h",
        "yaml-cpp/src/scanscalar.cpp",
        "yaml-cpp/src/scanscalar.h",
        "yaml-cpp/src/scantag.cpp",
        "yaml-cpp/src/scantag.h",
        "yaml-cpp/src/scantoken.cpp",
        "yaml-cpp/src/setting.h",
        "yaml-cpp/src/simplekey.cpp",
        "yaml-cpp/src/singledocparser.cpp",
        "yaml-cpp/src/singledocparser.h",
        "yaml-cpp/src/stream.cpp",
        "yaml-cpp/src/stream.h",
        "yaml-cpp/src/streamcharsource.h",
        "yaml-cpp/src/stringsource.h",
        "yaml-cpp/src/tag.cpp",
        "yaml-cpp/src/tag.h",
        "yaml-cpp/src/token.h",
    ],
    hdrs = glob([
        "yaml-cpp/include/yaml-cpp/*.h",
        "yaml-cpp/include/yaml-cpp/contrib/*.h",
        "yaml-cpp/include/yaml-cpp/node/*.h",
        "yaml-cpp/include/yaml-cpp/node/detail/*.h",
    ]),
    copts = [
        "-Isrc/third_party/yaml-cpp/yaml-cpp/include/yaml-cpp/contrib",
        "-Isrc/third_party/yaml-cpp/yaml-cpp/include/yaml-cpp/node",
        "-Isrc/third_party/yaml-cpp/yaml-cpp/include/yaml-cpp/node/detail",
    ] + select({
        "//bazel/config:linux_gcc_or_clang": [
            "-w",
        ],
        "//conditions:default": [],
    }),
    defines = select({
        "//bazel/config:compiler_type_msvc": [
            "_SILENCE_CXX17_ITERATOR_BASE_CLASS_DEPRECATION_WARNING",
        ],
        "//conditions:default": [],
    }),
    includes = [
        "yaml-cpp/include",
    ],
)
