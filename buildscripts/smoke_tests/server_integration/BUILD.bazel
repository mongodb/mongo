load("//bazel/resmoke:resmoke.bzl", "resmoke_suite_test")

resmoke_suite_test(
    name = "auth",
    srcs = [
        "//jstests/auth:dbcheck.js",
    ],
    config = "//buildscripts/resmokeconfig:suites/auth.yml",
    data = ["//buildscripts/resmokeconfig:common_jstest_data"],
    resmoke_args = ["--runAllFeatureFlagTests"],
    tags = [
        "ci-development-critical-single-variant",
        "server-integration-smoke",
    ],
    deps = [
        "//src/mongo/db:mongod",
        "//src/mongo/shell:mongo",
    ],
)

resmoke_suite_test(
    name = "disk_wiredtiger",
    srcs = [
        "//jstests/disk:dbNoCreate.js",
        "//jstests/disk:dbcheck_full_bson_validate.js",
        "//jstests/disk:killall.js",
        "//jstests/disk:repair_clustered_collection.js",
        "//jstests/disk:repair_corrupt_document.js",
        "//jstests/disk:repair_does_not_invalidate_config_on_standalone.js",
        "//jstests/disk:repair_failure_is_recoverable.js",
        "//jstests/disk:repair_index_format_version.js",
        "//jstests/disk:repair_removes_invalid_index_options.js",
        "//jstests/disk:wt_corrupt_file_errors.js",
        "//jstests/disk:wt_missing_file_errors.js",
        "//jstests/disk:wt_repair_corrupt_metadata.js",
        "//jstests/disk:wt_repair_orphaned_idents.js",
        "//jstests/disk:wt_size_storer_cleanup_replica_set.js",
        "//jstests/disk:wt_startup_with_missing_user_collection.js",
        "//jstests/disk:wt_validate_corrupt_files.js",
        "//jstests/disk:wt_validate_table_logging.js",
        "//jstests/disk:wt_verify_config_override.js",
        "//jstests/disk/libs:wt_file_helper.js",
    ],
    config = "//buildscripts/resmokeconfig:suites/disk_wiredtiger.yml",
    data = [
        "//buildscripts/resmokeconfig:common_jstest_data",
        "//jstests/noPassthrough/libs/index_builds:index_build.js",
        "//jstests/replsets:rslib.js",
        "//jstests/replsets/libs:all_javascript_files",
    ],
    resmoke_args = ["--runAllFeatureFlagTests"],
    tags = [
        "ci-development-critical-single-variant",
        "server-integration-smoke",
    ],
    deps = [
        "//src/mongo/db:mongod",
        "//src/mongo/shell:mongo",
        "//src/third_party/wiredtiger:wt",
    ],
)

resmoke_suite_test(
    name = "no_passthrough",
    srcs = [
        "//jstests/noPassthrough/backup_restore:queryable_backup_mode_incompatible_options.js",
        "//jstests/noPassthrough/compact:compact_concurrency_control.js",
        "//jstests/noPassthrough/compact:compact_stops_on_ebusy.js",
        "//jstests/noPassthrough/data_consistency:dbcheck_detects_data_corruption.js",
        "//jstests/noPassthrough/data_consistency:dbcheck_ignores_prepare_conficts_secondaries.js",
        "//jstests/noPassthrough/data_consistency:dbhash_before_ddl_op.js",
        "//jstests/noPassthrough/data_consistency:dbhash_capped_collection.js",
        "//jstests/noPassthrough/directoryperdb:directoryperdb.js",
        "//jstests/noPassthrough/directoryperdb:directoryperdb_and_split.js",
        "//jstests/noPassthrough/validate:background_validation.js",
        "//jstests/noPassthrough/validate:background_validation_checkpoint_existence.js",
        "//jstests/noPassthrough/validate:background_validation_checkpoint_timestamp.js",
        "//jstests/noPassthrough/validate:background_validation_consistent_collection.js",
        "//jstests/noPassthrough/validate:current_op_reports_validation_io.js",
        "//jstests/noPassthrough/validate:index_key_exception_fails_validation.js",
        "//jstests/noPassthrough/validate:modal_validate_specify.js",
        "//jstests/noPassthrough/validate:validate_adjust_multikey.js",
        "//jstests/noPassthrough/validate:validate_checkBSONConformance.js",
        "//jstests/noPassthrough/validate:validate_continues_on_error.js",
        "//jstests/noPassthrough/validate:validate_detects_invalid_index_options.js",
        "//jstests/noPassthrough/validate:validate_doc_schema.js",
        "//jstests/noPassthrough/validate:validate_empty_collection.js",
        "//jstests/noPassthrough/validate:validate_hashed_index.js",
        "//jstests/noPassthrough/validate:validate_index_traversal_failure.js",
        "//jstests/noPassthrough/validate:validate_log_oplog_entry_on_standalone.js",
        "//jstests/noPassthrough/validate:validate_memory_limit.js",
        "//jstests/noPassthrough/validate:validate_multikey_compound.js",
        "//jstests/noPassthrough/validate:validate_multikey_compound_batch.js",
        "//jstests/noPassthrough/validate:validate_multikey_failures.js",
        "//jstests/noPassthrough/validate:validate_multikey_restart.js",
        "//jstests/noPassthrough/validate:validate_out_of_order.js",
        "//jstests/noPassthrough/validate:validate_repair_multikey_config_options.js",
        "//jstests/noPassthrough/validate:validate_with_long_index_name.js",
        "//src/mongo/db/modules/enterprise/jstests/live_import:import_invalid_index_spec.js",
        "//src/mongo/db/modules/enterprise/jstests/live_import:vote_commit_import_collection_command_sanity.js",
        "//src/mongo/db/modules/enterprise/jstests/live_import/libs:export_import_helpers.js",
        "//src/mongo/db/modules/enterprise/jstests/live_restore:live_restore_block_fcv_change.js",
        "//src/mongo/db/modules/enterprise/jstests/live_restore:live_restore_no_server.js",
        "//src/mongo/db/modules/enterprise/jstests/live_restore:live_restore_server.js",
        "//src/mongo/db/modules/enterprise/jstests/live_restore/libs:live_restore_helpers.js",
    ],
    config = "//buildscripts/resmokeconfig:suites/no_passthrough.yml",
    data = [
        "//buildscripts/resmokeconfig:common_jstest_data",
        "//jstests/core/txns/libs:prepare_helpers.js",
        "//jstests/disk/libs:wt_file_helper.js",
        "//jstests/libs:key1",
        "//jstests/multiVersion/libs:verify_versions.js",
        "//jstests/replsets/libs:dbcheck_utils.js",
    ],
    resmoke_args = ["--runAllFeatureFlagTests"],
    tags = [
        "ci-development-critical-single-variant",
        "server-integration-smoke",
    ],
    deps = [
        "//src/mongo/db:mongod",
        "//src/mongo/shell:mongo",
        "//src/third_party/wiredtiger:wt",
    ],
)

resmoke_suite_test(
    name = "no_passthrough_with_mongod",
    srcs = [
        "//jstests/noPassthroughWithMongod/validate:index_boundary_values_validate.js",
        "//jstests/noPassthroughWithMongod/validate:validate_bson_types.js",
        "//jstests/noPassthroughWithMongod/validate:validate_command.js",
        "//jstests/noPassthroughWithMongod/validate:validate_interrupt.js",
        "//jstests/noPassthroughWithMongod/validate:validate_repair_mode.js",
        "//jstests/noPassthroughWithMongod/validate:validate_timeseries.js",
    ],
    config = "//buildscripts/resmokeconfig:suites/no_passthrough_with_mongod.yml",
    data = [
        "//buildscripts/resmokeconfig:common_jstest_data",
        "//jstests/libs:key1",
    ],
    resmoke_args = ["--runAllFeatureFlagTests"],
    tags = [
        "ci-development-critical-single-variant",
        "server-integration-smoke",
    ],
    deps = [
        "//src/mongo/db:mongod",
        "//src/mongo/shell:mongo",
    ],
)

resmoke_suite_test(
    name = "read_only",
    srcs = [
        "//jstests/readonly:aggregate.js",
        "//jstests/readonly:catalog_ops.js",
        "//jstests/readonly:count.js",
        "//jstests/readonly:distinct.js",
        "//jstests/readonly:find.js",
        "//jstests/readonly:geo.js",
        "//jstests/readonly:get_more.js",
        "//jstests/readonly:server_status.js",
        "//jstests/readonly:temp_collection.js",
        "//jstests/readonly:validate.js",
        "//jstests/readonly:write_ops.js",
        "//jstests/readonly/lib:read_only_test.js",
    ],
    config = "//buildscripts/resmokeconfig:suites/read_only.yml",
    data = ["//buildscripts/resmokeconfig:common_jstest_data"],
    resmoke_args = ["--runAllFeatureFlagTests"],
    tags = [
        "ci-development-critical-single-variant",
        "server-integration-smoke",
    ],
    deps = [
        "//src/mongo/db:mongod",
        "//src/mongo/shell:mongo",
    ],
)

resmoke_suite_test(
    name = "replica_sets",
    srcs = [
        "//jstests/replsets/dbcheck:dbcheck_collection_uuid.js",
        "//jstests/replsets/dbcheck:dbcheck_consistent_batch_health_log.js",
        "//jstests/replsets/dbcheck:dbcheck_detects_missing_id_index.js",
        "//jstests/replsets/dbcheck:dbcheck_extra_index_keys_id_index.js",
        "//jstests/replsets/dbcheck:dbcheck_old_format_extra_keys_primary.js",
        "//jstests/replsets/dbcheck:dbcheck_old_format_extra_keys_record_does_not_match.js",
        "//jstests/replsets/dbcheck:dbcheck_old_format_extra_keys_record_not_found.js",
        "//jstests/replsets/dbcheck:dbcheck_old_format_extra_keys_secondary.js",
        "//jstests/replsets/dbcheck:dbcheck_old_format_missing_keys.js",
        "//jstests/replsets/dbcheck:dbcheck_old_format_missing_keys_primary.js",
        "//jstests/replsets/dbcheck:dbcheck_old_format_missing_keys_secondaries.js",
        "//jstests/replsets/dbcheck:dbcheck_parameters_in_health_log.js",
        "//jstests/replsets/dbcheck:dbcheck_validate_bson.js",
        "//jstests/replsets/dbcheck:dbcheck_validation_mode_parameters.js",
        "//jstests/replsets/dbcheck:dbcheck_write_concern.js",
        "//jstests/replsets/dbcheck:ignore_dbcheck_in_initial_sync.js",
        "//jstests/replsets/libs:dbcheck_old_format_keys_test.js",
        "//jstests/replsets/libs:dbcheck_utils.js",
    ],
    config = "//buildscripts/resmokeconfig:suites/replica_sets.yml",
    data = ["//buildscripts/resmokeconfig:common_jstest_data"],
    resmoke_args = ["--runAllFeatureFlagTests"],
    tags = [
        "ci-development-critical-single-variant",
        "server-integration-smoke",
    ],
    deps = [
        "//src/mongo/db:mongod",
        "//src/mongo/shell:mongo",
    ],
)
